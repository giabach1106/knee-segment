2025-07-22 19:42:28 - root - INFO - Logging to file: logs/knee_segmentation_20250722_194228.log
2025-07-22 19:42:28 - root - INFO - 
============================================================
2025-07-22 19:42:28 - root - INFO - Running experiment: baseline
2025-07-22 19:42:28 - root - INFO - ============================================================

2025-07-22 19:42:28 - src.training.experiment - INFO - Starting experiment: baseline
2025-07-22 19:42:28 - src.training.experiment - INFO - Device: cuda
2025-07-22 19:42:28 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 19:42:28 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 19:42:28 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 19:42:28 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 19:42:28 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 19:42:28 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:42:28 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:42:33 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 19:42:33 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 19:42:36 - src.training.trainer - INFO - Epoch 0/59 (2.9s) - Train Loss: 0.7215, Train Dice: 0.0109, Val Loss: 0.8107, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:42:38 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_0.pth
2025-07-22 19:42:40 - src.training.trainer - INFO - Epoch 1/59 (2.5s) - Train Loss: 0.6728, Train Dice: 0.2075, Val Loss: 0.8111, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:42:43 - src.training.trainer - INFO - Epoch 2/59 (2.5s) - Train Loss: 0.6382, Train Dice: 0.2859, Val Loss: 0.8104, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:42:45 - src.training.trainer - INFO - Epoch 3/59 (2.5s) - Train Loss: 0.6003, Train Dice: 0.3778, Val Loss: 1.2344, Val Dice: 0.0522, Val IoU: 0.0272
2025-07-22 19:42:47 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:42:47 - src.training.trainer - INFO - New best model! Dice: 0.0522
2025-07-22 19:42:50 - src.training.trainer - INFO - Epoch 4/59 (2.5s) - Train Loss: 0.5745, Train Dice: 0.4645, Val Loss: 3.7099, Val Dice: 0.0500, Val IoU: 0.0260
2025-07-22 19:42:52 - src.training.trainer - INFO - Epoch 5/59 (2.5s) - Train Loss: 0.5718, Train Dice: 0.3877, Val Loss: 2.5605, Val Dice: 0.0527, Val IoU: 0.0274
2025-07-22 19:42:54 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:42:54 - src.training.trainer - INFO - New best model! Dice: 0.0527
2025-07-22 19:42:56 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_5.pth
2025-07-22 19:42:58 - src.training.trainer - INFO - Epoch 6/59 (2.5s) - Train Loss: 0.5453, Train Dice: 0.5091, Val Loss: 2.9294, Val Dice: 0.0535, Val IoU: 0.0279
2025-07-22 19:43:00 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:00 - src.training.trainer - INFO - New best model! Dice: 0.0535
2025-07-22 19:43:03 - src.training.trainer - INFO - Epoch 7/59 (2.5s) - Train Loss: 0.5282, Train Dice: 0.5419, Val Loss: 0.6631, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:43:05 - src.training.trainer - INFO - Epoch 8/59 (2.5s) - Train Loss: 0.5245, Train Dice: 0.5190, Val Loss: 3.9978, Val Dice: 0.0640, Val IoU: 0.0337
2025-07-22 19:43:07 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:07 - src.training.trainer - INFO - New best model! Dice: 0.0640
2025-07-22 19:43:10 - src.training.trainer - INFO - Epoch 9/59 (2.5s) - Train Loss: 0.5188, Train Dice: 0.5112, Val Loss: 5.5333, Val Dice: 0.0535, Val IoU: 0.0279
2025-07-22 19:43:12 - src.training.trainer - INFO - Epoch 10/59 (2.5s) - Train Loss: 0.5098, Train Dice: 0.4976, Val Loss: 4.1085, Val Dice: 0.0629, Val IoU: 0.0330
2025-07-22 19:43:14 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_10.pth
2025-07-22 19:43:17 - src.training.trainer - INFO - Epoch 11/59 (2.5s) - Train Loss: 0.5005, Train Dice: 0.5450, Val Loss: 4.1847, Val Dice: 0.0703, Val IoU: 0.0370
2025-07-22 19:43:19 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:19 - src.training.trainer - INFO - New best model! Dice: 0.0703
2025-07-22 19:43:21 - src.training.trainer - INFO - Epoch 12/59 (2.5s) - Train Loss: 0.4864, Train Dice: 0.5727, Val Loss: 5.1972, Val Dice: 0.0538, Val IoU: 0.0280
2025-07-22 19:43:24 - src.training.trainer - INFO - Epoch 13/59 (2.5s) - Train Loss: 0.4814, Train Dice: 0.5351, Val Loss: 4.4975, Val Dice: 0.0541, Val IoU: 0.0282
2025-07-22 19:43:26 - src.training.trainer - INFO - Epoch 14/59 (2.6s) - Train Loss: 0.4701, Train Dice: 0.5937, Val Loss: 3.3984, Val Dice: 0.0597, Val IoU: 0.0312
2025-07-22 19:43:29 - src.training.trainer - INFO - Epoch 15/59 (2.5s) - Train Loss: 0.4639, Train Dice: 0.6002, Val Loss: 2.7014, Val Dice: 0.0631, Val IoU: 0.0331
2025-07-22 19:43:30 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_15.pth
2025-07-22 19:43:33 - src.training.trainer - INFO - Epoch 16/59 (2.5s) - Train Loss: 0.4583, Train Dice: 0.5837, Val Loss: 2.4627, Val Dice: 0.0671, Val IoU: 0.0352
2025-07-22 19:43:35 - src.training.trainer - INFO - Epoch 17/59 (2.5s) - Train Loss: 0.4464, Train Dice: 0.5722, Val Loss: 2.3705, Val Dice: 0.0623, Val IoU: 0.0327
2025-07-22 19:43:38 - src.training.trainer - INFO - Epoch 18/59 (2.5s) - Train Loss: 0.4382, Train Dice: 0.6388, Val Loss: 1.9704, Val Dice: 0.0711, Val IoU: 0.0374
2025-07-22 19:43:40 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:40 - src.training.trainer - INFO - New best model! Dice: 0.0711
2025-07-22 19:43:42 - src.training.trainer - INFO - Epoch 19/59 (2.5s) - Train Loss: 0.4384, Train Dice: 0.6296, Val Loss: 1.6708, Val Dice: 0.0814, Val IoU: 0.0432
2025-07-22 19:43:44 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:44 - src.training.trainer - INFO - New best model! Dice: 0.0814
2025-07-22 19:43:47 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.4288, Train Dice: 0.6130, Val Loss: 1.3568, Val Dice: 0.0972, Val IoU: 0.0522
2025-07-22 19:43:48 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:48 - src.training.trainer - INFO - New best model! Dice: 0.0972
2025-07-22 19:43:50 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_20.pth
2025-07-22 19:43:53 - src.training.trainer - INFO - Epoch 21/59 (2.5s) - Train Loss: 0.4275, Train Dice: 0.6199, Val Loss: 1.0810, Val Dice: 0.1129, Val IoU: 0.0611
2025-07-22 19:43:55 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:43:55 - src.training.trainer - INFO - New best model! Dice: 0.1129
2025-07-22 19:43:57 - src.training.trainer - INFO - Epoch 22/59 (2.5s) - Train Loss: 0.4295, Train Dice: 0.6172, Val Loss: 1.1490, Val Dice: 0.0938, Val IoU: 0.0502
2025-07-22 19:44:00 - src.training.trainer - INFO - Epoch 23/59 (2.5s) - Train Loss: 0.4180, Train Dice: 0.6466, Val Loss: 0.8002, Val Dice: 0.1640, Val IoU: 0.0923
2025-07-22 19:44:01 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:01 - src.training.trainer - INFO - New best model! Dice: 0.1640
2025-07-22 19:44:04 - src.training.trainer - INFO - Epoch 24/59 (2.5s) - Train Loss: 0.4142, Train Dice: 0.6776, Val Loss: 0.7923, Val Dice: 0.1717, Val IoU: 0.0971
2025-07-22 19:44:06 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:06 - src.training.trainer - INFO - New best model! Dice: 0.1717
2025-07-22 19:44:08 - src.training.trainer - INFO - Epoch 25/59 (2.5s) - Train Loss: 0.4066, Train Dice: 0.6408, Val Loss: 0.7625, Val Dice: 0.1807, Val IoU: 0.1029
2025-07-22 19:44:10 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:10 - src.training.trainer - INFO - New best model! Dice: 0.1807
2025-07-22 19:44:12 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_25.pth
2025-07-22 19:44:14 - src.training.trainer - INFO - Epoch 26/59 (2.5s) - Train Loss: 0.4042, Train Dice: 0.6541, Val Loss: 0.5891, Val Dice: 0.2844, Val IoU: 0.1743
2025-07-22 19:44:16 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:16 - src.training.trainer - INFO - New best model! Dice: 0.2844
2025-07-22 19:44:19 - src.training.trainer - INFO - Epoch 27/59 (2.5s) - Train Loss: 0.4005, Train Dice: 0.6844, Val Loss: 0.5029, Val Dice: 0.3750, Val IoU: 0.2455
2025-07-22 19:44:21 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:21 - src.training.trainer - INFO - New best model! Dice: 0.3750
2025-07-22 19:44:23 - src.training.trainer - INFO - Epoch 28/59 (2.5s) - Train Loss: 0.3923, Train Dice: 0.7063, Val Loss: 0.5024, Val Dice: 0.2791, Val IoU: 0.1943
2025-07-22 19:44:26 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.3864, Train Dice: 0.7096, Val Loss: 0.4726, Val Dice: 0.3575, Val IoU: 0.2521
2025-07-22 19:44:28 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.3856, Train Dice: 0.7372, Val Loss: 0.4296, Val Dice: 0.5552, Val IoU: 0.4102
2025-07-22 19:44:30 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:30 - src.training.trainer - INFO - New best model! Dice: 0.5552
2025-07-22 19:44:32 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_30.pth
2025-07-22 19:44:35 - src.training.trainer - INFO - Epoch 31/59 (2.4s) - Train Loss: 0.3911, Train Dice: 0.6260, Val Loss: 0.4023, Val Dice: 0.6681, Val IoU: 0.5225
2025-07-22 19:44:36 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/best_model.pth
2025-07-22 19:44:36 - src.training.trainer - INFO - New best model! Dice: 0.6681
2025-07-22 19:44:39 - src.training.trainer - INFO - Epoch 32/59 (2.5s) - Train Loss: 0.3754, Train Dice: 0.7350, Val Loss: 0.4510, Val Dice: 0.4501, Val IoU: 0.3494
2025-07-22 19:44:52 - src.training.trainer - INFO - Epoch 33/59 (12.9s) - Train Loss: 0.3736, Train Dice: 0.7400, Val Loss: 0.4347, Val Dice: 0.5150, Val IoU: 0.3874
2025-07-22 19:44:54 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.3616, Train Dice: 0.7497, Val Loss: 0.4262, Val Dice: 0.5550, Val IoU: 0.4333
2025-07-22 19:44:57 - src.training.trainer - INFO - Epoch 35/59 (2.5s) - Train Loss: 0.3708, Train Dice: 0.7162, Val Loss: 0.4404, Val Dice: 0.4041, Val IoU: 0.3226
2025-07-22 19:44:59 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_35.pth
2025-07-22 19:45:01 - src.training.trainer - INFO - Epoch 36/59 (2.5s) - Train Loss: 0.3620, Train Dice: 0.6980, Val Loss: 0.4031, Val Dice: 0.5825, Val IoU: 0.4445
2025-07-22 19:45:04 - src.training.trainer - INFO - Epoch 37/59 (2.5s) - Train Loss: 0.3539, Train Dice: 0.7399, Val Loss: 0.3860, Val Dice: 0.6281, Val IoU: 0.4707
2025-07-22 19:45:06 - src.training.trainer - INFO - Epoch 38/59 (2.5s) - Train Loss: 0.3518, Train Dice: 0.7537, Val Loss: 0.3843, Val Dice: 0.6222, Val IoU: 0.4633
2025-07-22 19:45:09 - src.training.trainer - INFO - Epoch 39/59 (2.5s) - Train Loss: 0.3391, Train Dice: 0.7717, Val Loss: 0.3847, Val Dice: 0.6186, Val IoU: 0.4657
2025-07-22 19:45:11 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.3445, Train Dice: 0.7325, Val Loss: 0.3983, Val Dice: 0.5510, Val IoU: 0.4164
2025-07-22 19:45:13 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_40.pth
2025-07-22 19:45:15 - src.training.trainer - INFO - Epoch 41/59 (2.5s) - Train Loss: 0.3371, Train Dice: 0.7696, Val Loss: 0.4115, Val Dice: 0.5064, Val IoU: 0.3929
2025-07-22 19:45:18 - src.training.trainer - INFO - Epoch 42/59 (2.5s) - Train Loss: 0.3343, Train Dice: 0.7871, Val Loss: 0.4065, Val Dice: 0.5154, Val IoU: 0.3948
2025-07-22 19:45:20 - src.training.trainer - INFO - Epoch 43/59 (2.5s) - Train Loss: 0.3266, Train Dice: 0.8115, Val Loss: 0.3979, Val Dice: 0.5439, Val IoU: 0.4097
2025-07-22 19:45:23 - src.training.trainer - INFO - Epoch 44/59 (2.5s) - Train Loss: 0.3274, Train Dice: 0.7778, Val Loss: 0.3945, Val Dice: 0.5454, Val IoU: 0.4129
2025-07-22 19:45:25 - src.training.trainer - INFO - Epoch 45/59 (2.5s) - Train Loss: 0.3242, Train Dice: 0.7957, Val Loss: 0.3986, Val Dice: 0.5338, Val IoU: 0.4118
2025-07-22 19:45:27 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_45.pth
2025-07-22 19:45:30 - src.training.trainer - INFO - Epoch 46/59 (2.5s) - Train Loss: 0.3202, Train Dice: 0.8179, Val Loss: 0.4050, Val Dice: 0.5152, Val IoU: 0.3980
2025-07-22 19:45:32 - src.training.trainer - INFO - Epoch 47/59 (2.5s) - Train Loss: 0.3174, Train Dice: 0.8296, Val Loss: 0.4085, Val Dice: 0.4876, Val IoU: 0.3751
2025-07-22 19:45:35 - src.training.trainer - INFO - Epoch 48/59 (2.5s) - Train Loss: 0.3152, Train Dice: 0.8257, Val Loss: 0.4078, Val Dice: 0.4966, Val IoU: 0.3765
2025-07-22 19:45:38 - src.training.trainer - INFO - Epoch 49/59 (2.9s) - Train Loss: 0.3153, Train Dice: 0.8251, Val Loss: 0.4021, Val Dice: 0.5164, Val IoU: 0.3930
2025-07-22 19:45:40 - src.training.trainer - INFO - Epoch 50/59 (2.5s) - Train Loss: 0.3137, Train Dice: 0.8265, Val Loss: 0.3976, Val Dice: 0.5311, Val IoU: 0.4046
2025-07-22 19:45:42 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_50.pth
2025-07-22 19:45:44 - src.training.trainer - INFO - Epoch 51/59 (2.5s) - Train Loss: 0.3134, Train Dice: 0.8309, Val Loss: 0.3971, Val Dice: 0.5247, Val IoU: 0.3998
2025-07-22 19:45:47 - src.training.trainer - INFO - Epoch 52/59 (2.5s) - Train Loss: 0.3109, Train Dice: 0.8336, Val Loss: 0.3965, Val Dice: 0.5224, Val IoU: 0.3971
2025-07-22 19:45:49 - src.training.trainer - INFO - Epoch 53/59 (2.5s) - Train Loss: 0.3121, Train Dice: 0.8403, Val Loss: 0.3959, Val Dice: 0.5243, Val IoU: 0.3975
2025-07-22 19:45:52 - src.training.trainer - INFO - Epoch 54/59 (2.5s) - Train Loss: 0.3093, Train Dice: 0.8420, Val Loss: 0.3954, Val Dice: 0.5261, Val IoU: 0.3982
2025-07-22 19:45:54 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.3074, Train Dice: 0.8459, Val Loss: 0.3952, Val Dice: 0.5247, Val IoU: 0.3983
2025-07-22 19:45:56 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/checkpoint_epoch_55.pth
2025-07-22 19:45:59 - src.training.trainer - INFO - Epoch 56/59 (2.5s) - Train Loss: 0.3073, Train Dice: 0.8476, Val Loss: 0.3944, Val Dice: 0.5269, Val IoU: 0.4001
2025-07-22 19:46:01 - src.training.trainer - INFO - Epoch 57/59 (2.5s) - Train Loss: 0.3097, Train Dice: 0.8463, Val Loss: 0.3936, Val Dice: 0.5302, Val IoU: 0.4027
2025-07-22 19:46:04 - src.training.trainer - INFO - Epoch 58/59 (2.5s) - Train Loss: 0.3110, Train Dice: 0.8326, Val Loss: 0.3925, Val Dice: 0.5331, Val IoU: 0.4046
2025-07-22 19:46:06 - src.training.trainer - INFO - Epoch 59/59 (2.5s) - Train Loss: 0.3053, Train Dice: 0.8515, Val Loss: 0.3921, Val Dice: 0.5318, Val IoU: 0.4041
2025-07-22 19:46:08 - src.training.trainer - INFO - Saved checkpoint to experiments/baseline/final_model.pth
2025-07-22 19:46:11 - src.visualization.visualize - INFO - Saved training history to experiments/baseline/training_history.png
2025-07-22 19:46:11 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 19:46:14 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 19:46:14 - src.evaluation.metrics - INFO -   Dice: 52.78%
2025-07-22 19:46:14 - src.evaluation.metrics - INFO -   IoU: 40.28%
2025-07-22 19:46:14 - src.evaluation.metrics - INFO -   Pixel Accuracy: 97.22%
2025-07-22 19:46:14 - src.visualization.visualize - INFO - Saved visualization to experiments/baseline/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 19:46:15 - src.visualization.visualize - INFO - Saved visualization to experiments/baseline/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 19:46:15 - src.visualization.visualize - INFO - Saved visualization to experiments/baseline/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 19:46:15 - src.visualization.visualize - INFO - Saved visualization to experiments/baseline/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 19:46:16 - src.visualization.visualize - INFO - Saved visualization to experiments/baseline/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 19:46:16 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 19:46:16 - src.training.experiment - INFO - Test Dice: 52.78%
2025-07-22 19:46:16 - src.training.experiment - INFO - Test IoU: 40.28%
2025-07-22 19:46:16 - src.training.experiment - INFO - Test Pixel Accuracy: 97.22%
2025-07-22 19:46:16 - root - INFO - 
============================================================
2025-07-22 19:46:16 - root - INFO - Running experiment: clahe
2025-07-22 19:46:16 - root - INFO - ============================================================

2025-07-22 19:46:16 - src.training.experiment - INFO - Starting experiment: clahe
2025-07-22 19:46:16 - src.training.experiment - INFO - Device: cuda
2025-07-22 19:46:16 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 19:46:16 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 19:46:16 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 19:46:16 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 19:46:16 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 19:46:16 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:46:16 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:46:20 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 19:46:20 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 19:46:23 - src.training.trainer - INFO - Epoch 0/59 (2.6s) - Train Loss: 0.7788, Train Dice: 0.0785, Val Loss: 0.7969, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:24 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_0.pth
2025-07-22 19:46:27 - src.training.trainer - INFO - Epoch 1/59 (2.5s) - Train Loss: 0.7111, Train Dice: 0.1439, Val Loss: 0.8605, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:29 - src.training.trainer - INFO - Epoch 2/59 (2.5s) - Train Loss: 0.6529, Train Dice: 0.2506, Val Loss: 0.8735, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:32 - src.training.trainer - INFO - Epoch 3/59 (2.5s) - Train Loss: 0.6221, Train Dice: 0.3497, Val Loss: 0.8178, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:35 - src.training.trainer - INFO - Epoch 4/59 (2.5s) - Train Loss: 0.6032, Train Dice: 0.4004, Val Loss: 1.3071, Val Dice: 0.0514, Val IoU: 0.0267
2025-07-22 19:46:36 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:46:36 - src.training.trainer - INFO - New best model! Dice: 0.0514
2025-07-22 19:46:39 - src.training.trainer - INFO - Epoch 5/59 (2.5s) - Train Loss: 0.5888, Train Dice: 0.4370, Val Loss: 0.9228, Val Dice: 0.0374, Val IoU: 0.0194
2025-07-22 19:46:41 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_5.pth
2025-07-22 19:46:43 - src.training.trainer - INFO - Epoch 6/59 (2.5s) - Train Loss: 0.5853, Train Dice: 0.3906, Val Loss: 1.2979, Val Dice: 0.0004, Val IoU: 0.0002
2025-07-22 19:46:46 - src.training.trainer - INFO - Epoch 7/59 (2.5s) - Train Loss: 0.5707, Train Dice: 0.4405, Val Loss: 0.8634, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:48 - src.training.trainer - INFO - Epoch 8/59 (2.5s) - Train Loss: 0.5605, Train Dice: 0.4623, Val Loss: 0.8009, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:51 - src.training.trainer - INFO - Epoch 9/59 (2.5s) - Train Loss: 0.5443, Train Dice: 0.4983, Val Loss: 0.8375, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:46:53 - src.training.trainer - INFO - Epoch 10/59 (2.5s) - Train Loss: 0.5384, Train Dice: 0.5032, Val Loss: 1.7658, Val Dice: 0.0578, Val IoU: 0.0301
2025-07-22 19:46:55 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:46:55 - src.training.trainer - INFO - New best model! Dice: 0.0578
2025-07-22 19:46:57 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_10.pth
2025-07-22 19:47:00 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.5295, Train Dice: 0.5475, Val Loss: 2.0653, Val Dice: 0.0452, Val IoU: 0.0234
2025-07-22 19:47:02 - src.training.trainer - INFO - Epoch 12/59 (2.5s) - Train Loss: 0.5211, Train Dice: 0.5446, Val Loss: 1.9892, Val Dice: 0.0332, Val IoU: 0.0172
2025-07-22 19:47:05 - src.training.trainer - INFO - Epoch 13/59 (2.5s) - Train Loss: 0.5143, Train Dice: 0.5273, Val Loss: 1.7053, Val Dice: 0.0391, Val IoU: 0.0203
2025-07-22 19:47:07 - src.training.trainer - INFO - Epoch 14/59 (2.5s) - Train Loss: 0.5006, Train Dice: 0.5861, Val Loss: 1.6440, Val Dice: 0.0616, Val IoU: 0.0322
2025-07-22 19:47:09 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:09 - src.training.trainer - INFO - New best model! Dice: 0.0616
2025-07-22 19:47:12 - src.training.trainer - INFO - Epoch 15/59 (2.6s) - Train Loss: 0.4913, Train Dice: 0.6160, Val Loss: 1.1901, Val Dice: 0.0696, Val IoU: 0.0369
2025-07-22 19:47:13 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:13 - src.training.trainer - INFO - New best model! Dice: 0.0696
2025-07-22 19:47:15 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_15.pth
2025-07-22 19:47:18 - src.training.trainer - INFO - Epoch 16/59 (2.5s) - Train Loss: 0.4851, Train Dice: 0.6378, Val Loss: 1.2224, Val Dice: 0.0831, Val IoU: 0.0443
2025-07-22 19:47:20 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:20 - src.training.trainer - INFO - New best model! Dice: 0.0831
2025-07-22 19:47:22 - src.training.trainer - INFO - Epoch 17/59 (2.5s) - Train Loss: 0.4844, Train Dice: 0.5603, Val Loss: 0.6291, Val Dice: 0.0985, Val IoU: 0.0553
2025-07-22 19:47:24 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:24 - src.training.trainer - INFO - New best model! Dice: 0.0985
2025-07-22 19:47:27 - src.training.trainer - INFO - Epoch 18/59 (2.5s) - Train Loss: 0.4816, Train Dice: 0.5879, Val Loss: 0.8177, Val Dice: 0.0108, Val IoU: 0.0056
2025-07-22 19:47:29 - src.training.trainer - INFO - Epoch 19/59 (2.5s) - Train Loss: 0.4753, Train Dice: 0.5756, Val Loss: 1.0386, Val Dice: 0.0161, Val IoU: 0.0085
2025-07-22 19:47:32 - src.training.trainer - INFO - Epoch 20/59 (2.6s) - Train Loss: 0.4663, Train Dice: 0.6172, Val Loss: 1.0188, Val Dice: 0.0689, Val IoU: 0.0380
2025-07-22 19:47:33 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_20.pth
2025-07-22 19:47:36 - src.training.trainer - INFO - Epoch 21/59 (2.5s) - Train Loss: 0.4563, Train Dice: 0.6355, Val Loss: 1.2244, Val Dice: 0.1195, Val IoU: 0.0650
2025-07-22 19:47:38 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:38 - src.training.trainer - INFO - New best model! Dice: 0.1195
2025-07-22 19:47:40 - src.training.trainer - INFO - Epoch 22/59 (2.5s) - Train Loss: 0.4544, Train Dice: 0.6073, Val Loss: 1.2883, Val Dice: 0.1170, Val IoU: 0.0638
2025-07-22 19:47:43 - src.training.trainer - INFO - Epoch 23/59 (2.5s) - Train Loss: 0.4427, Train Dice: 0.6412, Val Loss: 1.0893, Val Dice: 0.1379, Val IoU: 0.0766
2025-07-22 19:47:45 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:45 - src.training.trainer - INFO - New best model! Dice: 0.1379
2025-07-22 19:47:47 - src.training.trainer - INFO - Epoch 24/59 (2.5s) - Train Loss: 0.4384, Train Dice: 0.6450, Val Loss: 0.8905, Val Dice: 0.1513, Val IoU: 0.0838
2025-07-22 19:47:49 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:47:49 - src.training.trainer - INFO - New best model! Dice: 0.1513
2025-07-22 19:47:52 - src.training.trainer - INFO - Epoch 25/59 (2.5s) - Train Loss: 0.4267, Train Dice: 0.6740, Val Loss: 0.7065, Val Dice: 0.1496, Val IoU: 0.0854
2025-07-22 19:47:53 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_25.pth
2025-07-22 19:47:56 - src.training.trainer - INFO - Epoch 26/59 (2.5s) - Train Loss: 0.4260, Train Dice: 0.6568, Val Loss: 0.6928, Val Dice: 0.0834, Val IoU: 0.0487
2025-07-22 19:47:58 - src.training.trainer - INFO - Epoch 27/59 (2.5s) - Train Loss: 0.4136, Train Dice: 0.7069, Val Loss: 0.5172, Val Dice: 0.2206, Val IoU: 0.1710
2025-07-22 19:48:00 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:48:00 - src.training.trainer - INFO - New best model! Dice: 0.2206
2025-07-22 19:48:03 - src.training.trainer - INFO - Epoch 28/59 (2.5s) - Train Loss: 0.4057, Train Dice: 0.6892, Val Loss: 0.4964, Val Dice: 0.3692, Val IoU: 0.2776
2025-07-22 19:48:05 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:48:05 - src.training.trainer - INFO - New best model! Dice: 0.3692
2025-07-22 19:48:07 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.4014, Train Dice: 0.7158, Val Loss: 0.5151, Val Dice: 0.1843, Val IoU: 0.1294
2025-07-22 19:48:10 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.4249, Train Dice: 0.6181, Val Loss: 0.4612, Val Dice: 0.5025, Val IoU: 0.3615
2025-07-22 19:48:12 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:48:12 - src.training.trainer - INFO - New best model! Dice: 0.5025
2025-07-22 19:48:13 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_30.pth
2025-07-22 19:48:16 - src.training.trainer - INFO - Epoch 31/59 (2.5s) - Train Loss: 0.4207, Train Dice: 0.5592, Val Loss: 0.4786, Val Dice: 0.3898, Val IoU: 0.2813
2025-07-22 19:48:19 - src.training.trainer - INFO - Epoch 32/59 (2.5s) - Train Loss: 0.4083, Train Dice: 0.5882, Val Loss: 0.5605, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:48:33 - src.training.trainer - INFO - Epoch 33/59 (14.9s) - Train Loss: 0.3973, Train Dice: 0.6369, Val Loss: 0.5566, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:48:36 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.3990, Train Dice: 0.6109, Val Loss: 0.5349, Val Dice: 0.0576, Val IoU: 0.0404
2025-07-22 19:48:39 - src.training.trainer - INFO - Epoch 35/59 (2.5s) - Train Loss: 0.4003, Train Dice: 0.6095, Val Loss: 0.4783, Val Dice: 0.4309, Val IoU: 0.3208
2025-07-22 19:48:40 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_35.pth
2025-07-22 19:48:43 - src.training.trainer - INFO - Epoch 36/59 (2.5s) - Train Loss: 0.3830, Train Dice: 0.6047, Val Loss: 0.5224, Val Dice: 0.4210, Val IoU: 0.2919
2025-07-22 19:48:45 - src.training.trainer - INFO - Epoch 37/59 (2.5s) - Train Loss: 0.3732, Train Dice: 0.6553, Val Loss: 0.4750, Val Dice: 0.4560, Val IoU: 0.3140
2025-07-22 19:48:48 - src.training.trainer - INFO - Epoch 38/59 (2.5s) - Train Loss: 0.3650, Train Dice: 0.6755, Val Loss: 0.4566, Val Dice: 0.4737, Val IoU: 0.3319
2025-07-22 19:48:50 - src.training.trainer - INFO - Epoch 39/59 (2.5s) - Train Loss: 0.3622, Train Dice: 0.6873, Val Loss: 0.4502, Val Dice: 0.4655, Val IoU: 0.3332
2025-07-22 19:48:53 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.3514, Train Dice: 0.7066, Val Loss: 0.4416, Val Dice: 0.4948, Val IoU: 0.3774
2025-07-22 19:48:55 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_40.pth
2025-07-22 19:48:57 - src.training.trainer - INFO - Epoch 41/59 (2.5s) - Train Loss: 0.3480, Train Dice: 0.6972, Val Loss: 0.4496, Val Dice: 0.4307, Val IoU: 0.3295
2025-07-22 19:49:00 - src.training.trainer - INFO - Epoch 42/59 (2.6s) - Train Loss: 0.3407, Train Dice: 0.7163, Val Loss: 0.4659, Val Dice: 0.3487, Val IoU: 0.2645
2025-07-22 19:49:02 - src.training.trainer - INFO - Epoch 43/59 (2.5s) - Train Loss: 0.3318, Train Dice: 0.7480, Val Loss: 0.4624, Val Dice: 0.3700, Val IoU: 0.2825
2025-07-22 19:49:05 - src.training.trainer - INFO - Epoch 44/59 (2.5s) - Train Loss: 0.3306, Train Dice: 0.7577, Val Loss: 0.4484, Val Dice: 0.4322, Val IoU: 0.3381
2025-07-22 19:49:07 - src.training.trainer - INFO - Epoch 45/59 (2.5s) - Train Loss: 0.3345, Train Dice: 0.7373, Val Loss: 0.4314, Val Dice: 0.4790, Val IoU: 0.3637
2025-07-22 19:49:09 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_45.pth
2025-07-22 19:49:12 - src.training.trainer - INFO - Epoch 46/59 (2.5s) - Train Loss: 0.3248, Train Dice: 0.7679, Val Loss: 0.4209, Val Dice: 0.4857, Val IoU: 0.3689
2025-07-22 19:49:14 - src.training.trainer - INFO - Epoch 47/59 (2.5s) - Train Loss: 0.3226, Train Dice: 0.7699, Val Loss: 0.4146, Val Dice: 0.5113, Val IoU: 0.3745
2025-07-22 19:49:16 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/best_model.pth
2025-07-22 19:49:16 - src.training.trainer - INFO - New best model! Dice: 0.5113
2025-07-22 19:49:19 - src.training.trainer - INFO - Epoch 48/59 (2.5s) - Train Loss: 0.3235, Train Dice: 0.7591, Val Loss: 0.4204, Val Dice: 0.5018, Val IoU: 0.3660
2025-07-22 19:49:22 - src.training.trainer - INFO - Epoch 49/59 (2.9s) - Train Loss: 0.3153, Train Dice: 0.7871, Val Loss: 0.4250, Val Dice: 0.4713, Val IoU: 0.3403
2025-07-22 19:49:24 - src.training.trainer - INFO - Epoch 50/59 (2.5s) - Train Loss: 0.3135, Train Dice: 0.8042, Val Loss: 0.4235, Val Dice: 0.4690, Val IoU: 0.3407
2025-07-22 19:49:26 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_50.pth
2025-07-22 19:49:28 - src.training.trainer - INFO - Epoch 51/59 (2.5s) - Train Loss: 0.3161, Train Dice: 0.7980, Val Loss: 0.4223, Val Dice: 0.4811, Val IoU: 0.3634
2025-07-22 19:49:31 - src.training.trainer - INFO - Epoch 52/59 (2.5s) - Train Loss: 0.3078, Train Dice: 0.8008, Val Loss: 0.4252, Val Dice: 0.4590, Val IoU: 0.3557
2025-07-22 19:49:33 - src.training.trainer - INFO - Epoch 53/59 (2.5s) - Train Loss: 0.3047, Train Dice: 0.8052, Val Loss: 0.4280, Val Dice: 0.4363, Val IoU: 0.3356
2025-07-22 19:49:36 - src.training.trainer - INFO - Epoch 54/59 (2.5s) - Train Loss: 0.3009, Train Dice: 0.8227, Val Loss: 0.4260, Val Dice: 0.4444, Val IoU: 0.3417
2025-07-22 19:49:39 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.3006, Train Dice: 0.8225, Val Loss: 0.4225, Val Dice: 0.4644, Val IoU: 0.3571
2025-07-22 19:49:40 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/checkpoint_epoch_55.pth
2025-07-22 19:49:43 - src.training.trainer - INFO - Epoch 56/59 (2.5s) - Train Loss: 0.2998, Train Dice: 0.8178, Val Loss: 0.4241, Val Dice: 0.4644, Val IoU: 0.3553
2025-07-22 19:49:45 - src.training.trainer - INFO - Epoch 57/59 (2.5s) - Train Loss: 0.2961, Train Dice: 0.8283, Val Loss: 0.4269, Val Dice: 0.4544, Val IoU: 0.3461
2025-07-22 19:49:48 - src.training.trainer - INFO - Epoch 58/59 (2.5s) - Train Loss: 0.2948, Train Dice: 0.8389, Val Loss: 0.4281, Val Dice: 0.4458, Val IoU: 0.3407
2025-07-22 19:49:50 - src.training.trainer - INFO - Epoch 59/59 (2.5s) - Train Loss: 0.2936, Train Dice: 0.8364, Val Loss: 0.4297, Val Dice: 0.4388, Val IoU: 0.3375
2025-07-22 19:49:52 - src.training.trainer - INFO - Saved checkpoint to experiments/clahe/final_model.pth
2025-07-22 19:49:55 - src.visualization.visualize - INFO - Saved training history to experiments/clahe/training_history.png
2025-07-22 19:49:55 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 19:49:58 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 19:49:58 - src.evaluation.metrics - INFO -   Dice: 49.74%
2025-07-22 19:49:58 - src.evaluation.metrics - INFO -   IoU: 36.89%
2025-07-22 19:49:58 - src.evaluation.metrics - INFO -   Pixel Accuracy: 97.27%
2025-07-22 19:49:58 - src.visualization.visualize - INFO - Saved visualization to experiments/clahe/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 19:49:58 - src.visualization.visualize - INFO - Saved visualization to experiments/clahe/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 19:49:59 - src.visualization.visualize - INFO - Saved visualization to experiments/clahe/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 19:49:59 - src.visualization.visualize - INFO - Saved visualization to experiments/clahe/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 19:50:00 - src.visualization.visualize - INFO - Saved visualization to experiments/clahe/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 19:50:00 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 19:50:00 - src.training.experiment - INFO - Test Dice: 49.74%
2025-07-22 19:50:00 - src.training.experiment - INFO - Test IoU: 36.89%
2025-07-22 19:50:00 - src.training.experiment - INFO - Test Pixel Accuracy: 97.27%
2025-07-22 19:50:00 - root - INFO - 
============================================================
2025-07-22 19:50:00 - root - INFO - Running experiment: crop_fixed
2025-07-22 19:50:00 - root - INFO - ============================================================

2025-07-22 19:50:00 - src.training.experiment - INFO - Starting experiment: crop_fixed
2025-07-22 19:50:00 - src.training.experiment - INFO - Device: cuda
2025-07-22 19:50:00 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 19:50:00 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 19:50:00 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 19:50:00 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 19:50:00 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 19:50:00 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:50:00 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:50:04 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 19:50:04 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 19:50:05 - src.training.trainer - INFO - Epoch 0/59 (0.9s) - Train Loss: 0.7148, Train Dice: 0.1495, Val Loss: 0.7904, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:06 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_0.pth
2025-07-22 19:50:07 - src.training.trainer - INFO - Epoch 1/59 (1.0s) - Train Loss: 0.6673, Train Dice: 0.2967, Val Loss: 0.7770, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:08 - src.training.trainer - INFO - Epoch 2/59 (0.9s) - Train Loss: 0.6154, Train Dice: 0.3838, Val Loss: 0.7510, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:09 - src.training.trainer - INFO - Epoch 3/59 (0.9s) - Train Loss: 0.5869, Train Dice: 0.3847, Val Loss: 0.7439, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:10 - src.training.trainer - INFO - Epoch 4/59 (0.9s) - Train Loss: 0.5646, Train Dice: 0.4085, Val Loss: 0.7401, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:11 - src.training.trainer - INFO - Epoch 5/59 (0.9s) - Train Loss: 0.5440, Train Dice: 0.4223, Val Loss: 0.7489, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:13 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_5.pth
2025-07-22 19:50:14 - src.training.trainer - INFO - Epoch 6/59 (1.0s) - Train Loss: 0.5541, Train Dice: 0.3409, Val Loss: 0.6607, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:15 - src.training.trainer - INFO - Epoch 7/59 (0.9s) - Train Loss: 0.5200, Train Dice: 0.4682, Val Loss: 0.6322, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:16 - src.training.trainer - INFO - Epoch 8/59 (0.9s) - Train Loss: 0.5010, Train Dice: 0.5049, Val Loss: 0.6057, Val Dice: 0.2031, Val IoU: 0.1374
2025-07-22 19:50:18 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:18 - src.training.trainer - INFO - New best model! Dice: 0.2031
2025-07-22 19:50:18 - src.training.trainer - INFO - Epoch 9/59 (1.0s) - Train Loss: 0.4862, Train Dice: 0.5436, Val Loss: 0.5922, Val Dice: 0.1319, Val IoU: 0.0893
2025-07-22 19:50:19 - src.training.trainer - INFO - Epoch 10/59 (0.9s) - Train Loss: 0.4688, Train Dice: 0.5337, Val Loss: 0.6076, Val Dice: 0.0288, Val IoU: 0.0169
2025-07-22 19:50:21 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_10.pth
2025-07-22 19:50:22 - src.training.trainer - INFO - Epoch 11/59 (0.9s) - Train Loss: 0.4543, Train Dice: 0.5640, Val Loss: 0.5951, Val Dice: 0.0413, Val IoU: 0.0261
2025-07-22 19:50:23 - src.training.trainer - INFO - Epoch 12/59 (0.9s) - Train Loss: 0.4448, Train Dice: 0.5903, Val Loss: 0.5795, Val Dice: 0.0682, Val IoU: 0.0469
2025-07-22 19:50:24 - src.training.trainer - INFO - Epoch 13/59 (0.9s) - Train Loss: 0.4294, Train Dice: 0.6104, Val Loss: 0.6083, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:25 - src.training.trainer - INFO - Epoch 14/59 (0.9s) - Train Loss: 0.4251, Train Dice: 0.6471, Val Loss: 0.6115, Val Dice: 0.1638, Val IoU: 0.1116
2025-07-22 19:50:26 - src.training.trainer - INFO - Epoch 15/59 (0.9s) - Train Loss: 0.4441, Train Dice: 0.6057, Val Loss: 0.5893, Val Dice: 0.0280, Val IoU: 0.0163
2025-07-22 19:50:28 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_15.pth
2025-07-22 19:50:29 - src.training.trainer - INFO - Epoch 16/59 (1.0s) - Train Loss: 0.4081, Train Dice: 0.6567, Val Loss: 0.5994, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:30 - src.training.trainer - INFO - Epoch 17/59 (1.0s) - Train Loss: 0.4145, Train Dice: 0.6241, Val Loss: 0.5806, Val Dice: 0.0198, Val IoU: 0.0110
2025-07-22 19:50:31 - src.training.trainer - INFO - Epoch 18/59 (0.9s) - Train Loss: 0.3953, Train Dice: 0.6773, Val Loss: 0.5313, Val Dice: 0.2020, Val IoU: 0.1357
2025-07-22 19:50:31 - src.training.trainer - INFO - Epoch 19/59 (0.9s) - Train Loss: 0.3948, Train Dice: 0.6710, Val Loss: 0.5613, Val Dice: 0.0482, Val IoU: 0.0277
2025-07-22 19:50:32 - src.training.trainer - INFO - Epoch 20/59 (1.0s) - Train Loss: 0.3812, Train Dice: 0.7253, Val Loss: 0.5876, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:50:34 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_20.pth
2025-07-22 19:50:35 - src.training.trainer - INFO - Epoch 21/59 (1.0s) - Train Loss: 0.3841, Train Dice: 0.7397, Val Loss: 0.5649, Val Dice: 0.1020, Val IoU: 0.0625
2025-07-22 19:50:36 - src.training.trainer - INFO - Epoch 22/59 (0.9s) - Train Loss: 0.3803, Train Dice: 0.7353, Val Loss: 0.5281, Val Dice: 0.2416, Val IoU: 0.1618
2025-07-22 19:50:38 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:38 - src.training.trainer - INFO - New best model! Dice: 0.2416
2025-07-22 19:50:39 - src.training.trainer - INFO - Epoch 23/59 (0.9s) - Train Loss: 0.3738, Train Dice: 0.7394, Val Loss: 0.5009, Val Dice: 0.3742, Val IoU: 0.2603
2025-07-22 19:50:41 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:41 - src.training.trainer - INFO - New best model! Dice: 0.3742
2025-07-22 19:50:42 - src.training.trainer - INFO - Epoch 24/59 (0.9s) - Train Loss: 0.3649, Train Dice: 0.7966, Val Loss: 0.5003, Val Dice: 0.4115, Val IoU: 0.2897
2025-07-22 19:50:44 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:44 - src.training.trainer - INFO - New best model! Dice: 0.4115
2025-07-22 19:50:45 - src.training.trainer - INFO - Epoch 25/59 (1.0s) - Train Loss: 0.3796, Train Dice: 0.6974, Val Loss: 0.5067, Val Dice: 0.4071, Val IoU: 0.2877
2025-07-22 19:50:46 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_25.pth
2025-07-22 19:50:47 - src.training.trainer - INFO - Epoch 26/59 (1.0s) - Train Loss: 0.3727, Train Dice: 0.7375, Val Loss: 0.5041, Val Dice: 0.4093, Val IoU: 0.2839
2025-07-22 19:50:48 - src.training.trainer - INFO - Epoch 27/59 (0.9s) - Train Loss: 0.3757, Train Dice: 0.7319, Val Loss: 0.5147, Val Dice: 0.4124, Val IoU: 0.2860
2025-07-22 19:50:50 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:50 - src.training.trainer - INFO - New best model! Dice: 0.4124
2025-07-22 19:50:51 - src.training.trainer - INFO - Epoch 28/59 (0.9s) - Train Loss: 0.3625, Train Dice: 0.8108, Val Loss: 0.5285, Val Dice: 0.3671, Val IoU: 0.2577
2025-07-22 19:50:52 - src.training.trainer - INFO - Epoch 29/59 (1.0s) - Train Loss: 0.3576, Train Dice: 0.8363, Val Loss: 0.5182, Val Dice: 0.3486, Val IoU: 0.2389
2025-07-22 19:50:53 - src.training.trainer - INFO - Epoch 30/59 (0.9s) - Train Loss: 0.3575, Train Dice: 0.7785, Val Loss: 0.5067, Val Dice: 0.3616, Val IoU: 0.2401
2025-07-22 19:50:55 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_30.pth
2025-07-22 19:50:56 - src.training.trainer - INFO - Epoch 31/59 (1.0s) - Train Loss: 0.3574, Train Dice: 0.7885, Val Loss: 0.4888, Val Dice: 0.4353, Val IoU: 0.3024
2025-07-22 19:50:58 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:50:58 - src.training.trainer - INFO - New best model! Dice: 0.4353
2025-07-22 19:50:59 - src.training.trainer - INFO - Epoch 32/59 (1.0s) - Train Loss: 0.3478, Train Dice: 0.7904, Val Loss: 0.4845, Val Dice: 0.4481, Val IoU: 0.3156
2025-07-22 19:51:00 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/best_model.pth
2025-07-22 19:51:00 - src.training.trainer - INFO - New best model! Dice: 0.4481
2025-07-22 19:51:16 - src.training.trainer - INFO - Epoch 33/59 (15.6s) - Train Loss: 0.3460, Train Dice: 0.7809, Val Loss: 0.4876, Val Dice: 0.4257, Val IoU: 0.2993
2025-07-22 19:51:17 - src.training.trainer - INFO - Epoch 34/59 (0.9s) - Train Loss: 0.3469, Train Dice: 0.7836, Val Loss: 0.4918, Val Dice: 0.3832, Val IoU: 0.2683
2025-07-22 19:51:18 - src.training.trainer - INFO - Epoch 35/59 (0.9s) - Train Loss: 0.3449, Train Dice: 0.7985, Val Loss: 0.4903, Val Dice: 0.3920, Val IoU: 0.2752
2025-07-22 19:51:20 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_35.pth
2025-07-22 19:51:21 - src.training.trainer - INFO - Epoch 36/59 (1.0s) - Train Loss: 0.3440, Train Dice: 0.8010, Val Loss: 0.4879, Val Dice: 0.3909, Val IoU: 0.2752
2025-07-22 19:51:22 - src.training.trainer - INFO - Epoch 37/59 (0.9s) - Train Loss: 0.3366, Train Dice: 0.8175, Val Loss: 0.4889, Val Dice: 0.3951, Val IoU: 0.2769
2025-07-22 19:51:23 - src.training.trainer - INFO - Epoch 38/59 (0.9s) - Train Loss: 0.3351, Train Dice: 0.8381, Val Loss: 0.4907, Val Dice: 0.4018, Val IoU: 0.2842
2025-07-22 19:51:23 - src.training.trainer - INFO - Epoch 39/59 (0.9s) - Train Loss: 0.3368, Train Dice: 0.8278, Val Loss: 0.4905, Val Dice: 0.4078, Val IoU: 0.2892
2025-07-22 19:51:24 - src.training.trainer - INFO - Epoch 40/59 (1.0s) - Train Loss: 0.3324, Train Dice: 0.8303, Val Loss: 0.4885, Val Dice: 0.4163, Val IoU: 0.2959
2025-07-22 19:51:26 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_40.pth
2025-07-22 19:51:27 - src.training.trainer - INFO - Epoch 41/59 (1.0s) - Train Loss: 0.3288, Train Dice: 0.8375, Val Loss: 0.4857, Val Dice: 0.4207, Val IoU: 0.2998
2025-07-22 19:51:28 - src.training.trainer - INFO - Epoch 42/59 (0.9s) - Train Loss: 0.3328, Train Dice: 0.8145, Val Loss: 0.4837, Val Dice: 0.4195, Val IoU: 0.2985
2025-07-22 19:51:29 - src.training.trainer - INFO - Epoch 43/59 (0.9s) - Train Loss: 0.3271, Train Dice: 0.8310, Val Loss: 0.4800, Val Dice: 0.4222, Val IoU: 0.3008
2025-07-22 19:51:30 - src.training.trainer - INFO - Epoch 44/59 (0.9s) - Train Loss: 0.3286, Train Dice: 0.8284, Val Loss: 0.4799, Val Dice: 0.4314, Val IoU: 0.3102
2025-07-22 19:51:31 - src.training.trainer - INFO - Epoch 45/59 (0.9s) - Train Loss: 0.3296, Train Dice: 0.8127, Val Loss: 0.4812, Val Dice: 0.4266, Val IoU: 0.3066
2025-07-22 19:51:33 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_45.pth
2025-07-22 19:51:34 - src.training.trainer - INFO - Epoch 46/59 (1.0s) - Train Loss: 0.3289, Train Dice: 0.8324, Val Loss: 0.4811, Val Dice: 0.4287, Val IoU: 0.3089
2025-07-22 19:51:35 - src.training.trainer - INFO - Epoch 47/59 (0.9s) - Train Loss: 0.3330, Train Dice: 0.8115, Val Loss: 0.4804, Val Dice: 0.4316, Val IoU: 0.3121
2025-07-22 19:51:36 - src.training.trainer - INFO - Epoch 48/59 (1.0s) - Train Loss: 0.3268, Train Dice: 0.8303, Val Loss: 0.4811, Val Dice: 0.4323, Val IoU: 0.3133
2025-07-22 19:51:37 - src.training.trainer - INFO - Epoch 49/59 (1.4s) - Train Loss: 0.3225, Train Dice: 0.8708, Val Loss: 0.4826, Val Dice: 0.4321, Val IoU: 0.3129
2025-07-22 19:51:38 - src.training.trainer - INFO - Epoch 50/59 (1.0s) - Train Loss: 0.3269, Train Dice: 0.8305, Val Loss: 0.4839, Val Dice: 0.4284, Val IoU: 0.3111
2025-07-22 19:51:40 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_50.pth
2025-07-22 19:51:41 - src.training.trainer - INFO - Epoch 51/59 (1.0s) - Train Loss: 0.3289, Train Dice: 0.8657, Val Loss: 0.4840, Val Dice: 0.4302, Val IoU: 0.3125
2025-07-22 19:51:42 - src.training.trainer - INFO - Epoch 52/59 (1.0s) - Train Loss: 0.3246, Train Dice: 0.8304, Val Loss: 0.4847, Val Dice: 0.4312, Val IoU: 0.3135
2025-07-22 19:51:43 - src.training.trainer - INFO - Epoch 53/59 (1.0s) - Train Loss: 0.3247, Train Dice: 0.8683, Val Loss: 0.4856, Val Dice: 0.4281, Val IoU: 0.3103
2025-07-22 19:51:44 - src.training.trainer - INFO - Epoch 54/59 (0.9s) - Train Loss: 0.3242, Train Dice: 0.8344, Val Loss: 0.4856, Val Dice: 0.4297, Val IoU: 0.3117
2025-07-22 19:51:45 - src.training.trainer - INFO - Epoch 55/59 (0.9s) - Train Loss: 0.3335, Train Dice: 0.7944, Val Loss: 0.4869, Val Dice: 0.4298, Val IoU: 0.3115
2025-07-22 19:51:46 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/checkpoint_epoch_55.pth
2025-07-22 19:51:47 - src.training.trainer - INFO - Epoch 56/59 (1.0s) - Train Loss: 0.3256, Train Dice: 0.8353, Val Loss: 0.4859, Val Dice: 0.4336, Val IoU: 0.3148
2025-07-22 19:51:48 - src.training.trainer - INFO - Epoch 57/59 (1.0s) - Train Loss: 0.3234, Train Dice: 0.8402, Val Loss: 0.4849, Val Dice: 0.4363, Val IoU: 0.3174
2025-07-22 19:51:49 - src.training.trainer - INFO - Epoch 58/59 (1.0s) - Train Loss: 0.3229, Train Dice: 0.8299, Val Loss: 0.4841, Val Dice: 0.4375, Val IoU: 0.3185
2025-07-22 19:51:50 - src.training.trainer - INFO - Epoch 59/59 (1.0s) - Train Loss: 0.3195, Train Dice: 0.8797, Val Loss: 0.4836, Val Dice: 0.4382, Val IoU: 0.3192
2025-07-22 19:51:52 - src.training.trainer - INFO - Saved checkpoint to experiments/crop_fixed/final_model.pth
2025-07-22 19:51:55 - src.visualization.visualize - INFO - Saved training history to experiments/crop_fixed/training_history.png
2025-07-22 19:51:55 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 19:51:55 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 19:51:55 - src.evaluation.metrics - INFO -   Dice: 34.30%
2025-07-22 19:51:55 - src.evaluation.metrics - INFO -   IoU: 25.83%
2025-07-22 19:51:55 - src.evaluation.metrics - INFO -   Pixel Accuracy: 87.43%
2025-07-22 19:51:55 - src.visualization.visualize - INFO - Saved visualization to experiments/crop_fixed/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 19:51:56 - src.visualization.visualize - INFO - Saved visualization to experiments/crop_fixed/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 19:51:56 - src.visualization.visualize - INFO - Saved visualization to experiments/crop_fixed/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 19:51:56 - src.visualization.visualize - INFO - Saved visualization to experiments/crop_fixed/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 19:51:57 - src.visualization.visualize - INFO - Saved visualization to experiments/crop_fixed/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 19:51:57 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 19:51:57 - src.training.experiment - INFO - Test Dice: 34.30%
2025-07-22 19:51:57 - src.training.experiment - INFO - Test IoU: 25.83%
2025-07-22 19:51:57 - src.training.experiment - INFO - Test Pixel Accuracy: 87.43%
2025-07-22 19:51:57 - root - INFO - 
============================================================
2025-07-22 19:51:57 - root - INFO - Running experiment: snake_crop
2025-07-22 19:51:57 - root - INFO - ============================================================

2025-07-22 19:51:57 - src.training.experiment - INFO - Starting experiment: snake_crop
2025-07-22 19:51:57 - src.training.experiment - INFO - Device: cuda
2025-07-22 19:51:57 - src.training.experiment - INFO - Snake ROI detected - reducing DataLoader workers to avoid tensor sharing issues
2025-07-22 19:51:57 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 19:51:57 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 19:51:57 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 19:51:57 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 19:51:57 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 19:51:57 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:51:57 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 19:52:01 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 19:52:01 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 19:52:13 - src.training.trainer - INFO - Epoch 0/59 (12.2s) - Train Loss: 0.8289, Train Dice: 0.1000, Val Loss: 0.8101, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:52:15 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_0.pth
2025-07-22 19:52:26 - src.training.trainer - INFO - Epoch 1/59 (11.3s) - Train Loss: 0.7505, Train Dice: 0.1601, Val Loss: 0.8116, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:52:39 - src.training.trainer - INFO - Epoch 2/59 (12.9s) - Train Loss: 0.6974, Train Dice: 0.2250, Val Loss: 0.8214, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 19:52:51 - src.training.trainer - INFO - Epoch 3/59 (11.7s) - Train Loss: 0.6693, Train Dice: 0.2399, Val Loss: 1.0412, Val Dice: 0.0670, Val IoU: 0.0361
2025-07-22 19:52:52 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:52:52 - src.training.trainer - INFO - New best model! Dice: 0.0670
2025-07-22 19:53:05 - src.training.trainer - INFO - Epoch 4/59 (12.2s) - Train Loss: 0.6541, Train Dice: 0.2741, Val Loss: 1.0080, Val Dice: 0.0949, Val IoU: 0.0514
2025-07-22 19:53:07 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:53:07 - src.training.trainer - INFO - New best model! Dice: 0.0949
2025-07-22 19:53:21 - src.training.trainer - INFO - Epoch 5/59 (14.2s) - Train Loss: 0.6390, Train Dice: 0.2670, Val Loss: 4.4796, Val Dice: 0.0862, Val IoU: 0.0461
2025-07-22 19:53:23 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_5.pth
2025-07-22 19:53:33 - src.training.trainer - INFO - Epoch 6/59 (10.9s) - Train Loss: 0.6272, Train Dice: 0.3199, Val Loss: 3.4151, Val Dice: 0.0815, Val IoU: 0.0435
2025-07-22 19:53:46 - src.training.trainer - INFO - Epoch 7/59 (12.5s) - Train Loss: 0.6234, Train Dice: 0.3714, Val Loss: 1.7693, Val Dice: 0.0065, Val IoU: 0.0033
2025-07-22 19:53:58 - src.training.trainer - INFO - Epoch 8/59 (12.0s) - Train Loss: 0.6223, Train Dice: 0.3487, Val Loss: 1.7733, Val Dice: 0.1203, Val IoU: 0.0661
2025-07-22 19:54:00 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:54:00 - src.training.trainer - INFO - New best model! Dice: 0.1203
2025-07-22 19:54:12 - src.training.trainer - INFO - Epoch 9/59 (12.0s) - Train Loss: 0.6072, Train Dice: 0.3821, Val Loss: 1.2328, Val Dice: 0.1300, Val IoU: 0.0722
2025-07-22 19:54:14 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:54:14 - src.training.trainer - INFO - New best model! Dice: 0.1300
2025-07-22 19:54:25 - src.training.trainer - INFO - Epoch 10/59 (11.3s) - Train Loss: 0.6018, Train Dice: 0.4110, Val Loss: 0.7453, Val Dice: 0.0334, Val IoU: 0.0191
2025-07-22 19:54:27 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_10.pth
2025-07-22 19:54:40 - src.training.trainer - INFO - Epoch 11/59 (12.8s) - Train Loss: 0.5790, Train Dice: 0.4413, Val Loss: 1.2045, Val Dice: 0.0140, Val IoU: 0.0072
2025-07-22 19:54:53 - src.training.trainer - INFO - Epoch 12/59 (13.1s) - Train Loss: 0.5694, Train Dice: 0.4684, Val Loss: 1.4206, Val Dice: 0.0402, Val IoU: 0.0212
2025-07-22 19:55:05 - src.training.trainer - INFO - Epoch 13/59 (12.0s) - Train Loss: 0.5572, Train Dice: 0.4775, Val Loss: 0.8247, Val Dice: 0.1724, Val IoU: 0.1003
2025-07-22 19:55:07 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:55:07 - src.training.trainer - INFO - New best model! Dice: 0.1724
2025-07-22 19:55:19 - src.training.trainer - INFO - Epoch 14/59 (12.2s) - Train Loss: 0.5414, Train Dice: 0.5390, Val Loss: 1.2779, Val Dice: 0.1048, Val IoU: 0.0570
2025-07-22 19:55:32 - src.training.trainer - INFO - Epoch 15/59 (13.2s) - Train Loss: 0.5315, Train Dice: 0.5588, Val Loss: 1.8534, Val Dice: 0.0959, Val IoU: 0.0518
2025-07-22 19:55:34 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_15.pth
2025-07-22 19:55:47 - src.training.trainer - INFO - Epoch 16/59 (13.3s) - Train Loss: 0.5200, Train Dice: 0.5844, Val Loss: 2.0557, Val Dice: 0.0887, Val IoU: 0.0476
2025-07-22 19:55:59 - src.training.trainer - INFO - Epoch 17/59 (11.8s) - Train Loss: 0.5084, Train Dice: 0.5878, Val Loss: 1.3604, Val Dice: 0.1069, Val IoU: 0.0583
2025-07-22 19:56:11 - src.training.trainer - INFO - Epoch 18/59 (12.3s) - Train Loss: 0.5029, Train Dice: 0.5908, Val Loss: 1.2237, Val Dice: 0.1371, Val IoU: 0.0768
2025-07-22 19:56:23 - src.training.trainer - INFO - Epoch 19/59 (11.9s) - Train Loss: 0.4900, Train Dice: 0.6274, Val Loss: 3.1005, Val Dice: 0.0987, Val IoU: 0.0535
2025-07-22 19:56:35 - src.training.trainer - INFO - Epoch 20/59 (11.9s) - Train Loss: 0.4836, Train Dice: 0.5868, Val Loss: 2.8242, Val Dice: 0.1100, Val IoU: 0.0598
2025-07-22 19:56:37 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_20.pth
2025-07-22 19:56:48 - src.training.trainer - INFO - Epoch 21/59 (10.8s) - Train Loss: 0.4786, Train Dice: 0.6250, Val Loss: 1.4807, Val Dice: 0.1137, Val IoU: 0.0623
2025-07-22 19:57:02 - src.training.trainer - INFO - Epoch 22/59 (14.5s) - Train Loss: 0.4834, Train Dice: 0.5972, Val Loss: 1.1732, Val Dice: 0.1293, Val IoU: 0.0713
2025-07-22 19:57:17 - src.training.trainer - INFO - Epoch 23/59 (14.4s) - Train Loss: 0.4592, Train Dice: 0.6620, Val Loss: 1.2191, Val Dice: 0.0948, Val IoU: 0.0517
2025-07-22 19:57:30 - src.training.trainer - INFO - Epoch 24/59 (12.8s) - Train Loss: 0.4676, Train Dice: 0.6093, Val Loss: 0.9805, Val Dice: 0.0956, Val IoU: 0.0521
2025-07-22 19:57:43 - src.training.trainer - INFO - Epoch 25/59 (13.7s) - Train Loss: 0.4563, Train Dice: 0.6538, Val Loss: 0.7968, Val Dice: 0.1378, Val IoU: 0.0773
2025-07-22 19:57:45 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_25.pth
2025-07-22 19:57:58 - src.training.trainer - INFO - Epoch 26/59 (12.5s) - Train Loss: 0.4481, Train Dice: 0.7191, Val Loss: 0.8019, Val Dice: 0.1643, Val IoU: 0.0930
2025-07-22 19:58:09 - src.training.trainer - INFO - Epoch 27/59 (11.9s) - Train Loss: 0.4444, Train Dice: 0.7031, Val Loss: 0.8598, Val Dice: 0.1692, Val IoU: 0.0959
2025-07-22 19:58:21 - src.training.trainer - INFO - Epoch 28/59 (11.4s) - Train Loss: 0.4417, Train Dice: 0.6958, Val Loss: 0.8096, Val Dice: 0.1721, Val IoU: 0.0979
2025-07-22 19:58:34 - src.training.trainer - INFO - Epoch 29/59 (12.8s) - Train Loss: 0.4373, Train Dice: 0.7159, Val Loss: 0.7364, Val Dice: 0.1823, Val IoU: 0.1058
2025-07-22 19:58:36 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:58:36 - src.training.trainer - INFO - New best model! Dice: 0.1823
2025-07-22 19:58:48 - src.training.trainer - INFO - Epoch 30/59 (12.3s) - Train Loss: 0.4307, Train Dice: 0.7339, Val Loss: 0.6761, Val Dice: 0.2143, Val IoU: 0.1272
2025-07-22 19:58:50 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:58:50 - src.training.trainer - INFO - New best model! Dice: 0.2143
2025-07-22 19:58:52 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_30.pth
2025-07-22 19:59:04 - src.training.trainer - INFO - Epoch 31/59 (12.1s) - Train Loss: 0.4361, Train Dice: 0.7125, Val Loss: 0.6682, Val Dice: 0.2447, Val IoU: 0.1479
2025-07-22 19:59:05 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:59:05 - src.training.trainer - INFO - New best model! Dice: 0.2447
2025-07-22 19:59:16 - src.training.trainer - INFO - Epoch 32/59 (11.0s) - Train Loss: 0.4261, Train Dice: 0.7297, Val Loss: 0.6044, Val Dice: 0.2920, Val IoU: 0.1816
2025-07-22 19:59:18 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:59:18 - src.training.trainer - INFO - New best model! Dice: 0.2920
2025-07-22 19:59:40 - src.training.trainer - INFO - Epoch 33/59 (21.2s) - Train Loss: 0.4234, Train Dice: 0.7382, Val Loss: 0.5868, Val Dice: 0.2888, Val IoU: 0.1800
2025-07-22 19:59:52 - src.training.trainer - INFO - Epoch 34/59 (12.9s) - Train Loss: 0.4220, Train Dice: 0.7379, Val Loss: 0.5843, Val Dice: 0.3051, Val IoU: 0.1920
2025-07-22 19:59:54 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 19:59:54 - src.training.trainer - INFO - New best model! Dice: 0.3051
2025-07-22 20:00:06 - src.training.trainer - INFO - Epoch 35/59 (12.1s) - Train Loss: 0.4143, Train Dice: 0.7660, Val Loss: 0.5869, Val Dice: 0.3102, Val IoU: 0.1965
2025-07-22 20:00:08 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 20:00:08 - src.training.trainer - INFO - New best model! Dice: 0.3102
2025-07-22 20:00:10 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_35.pth
2025-07-22 20:00:22 - src.training.trainer - INFO - Epoch 36/59 (11.7s) - Train Loss: 0.4128, Train Dice: 0.7751, Val Loss: 0.5914, Val Dice: 0.3101, Val IoU: 0.1990
2025-07-22 20:00:35 - src.training.trainer - INFO - Epoch 37/59 (12.9s) - Train Loss: 0.4114, Train Dice: 0.7574, Val Loss: 0.5124, Val Dice: 0.5197, Val IoU: 0.3791
2025-07-22 20:00:37 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 20:00:37 - src.training.trainer - INFO - New best model! Dice: 0.5197
2025-07-22 20:00:49 - src.training.trainer - INFO - Epoch 38/59 (12.0s) - Train Loss: 0.4062, Train Dice: 0.7754, Val Loss: 0.5302, Val Dice: 0.4150, Val IoU: 0.2977
2025-07-22 20:01:03 - src.training.trainer - INFO - Epoch 39/59 (14.1s) - Train Loss: 0.4021, Train Dice: 0.7967, Val Loss: 0.5954, Val Dice: 0.2531, Val IoU: 0.1612
2025-07-22 20:01:16 - src.training.trainer - INFO - Epoch 40/59 (13.5s) - Train Loss: 0.4013, Train Dice: 0.7906, Val Loss: 0.5277, Val Dice: 0.4594, Val IoU: 0.3205
2025-07-22 20:01:18 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_40.pth
2025-07-22 20:01:31 - src.training.trainer - INFO - Epoch 41/59 (12.7s) - Train Loss: 0.3958, Train Dice: 0.7896, Val Loss: 0.4862, Val Dice: 0.4944, Val IoU: 0.3731
2025-07-22 20:01:42 - src.training.trainer - INFO - Epoch 42/59 (11.3s) - Train Loss: 0.3992, Train Dice: 0.7765, Val Loss: 0.4961, Val Dice: 0.5344, Val IoU: 0.4037
2025-07-22 20:01:44 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 20:01:44 - src.training.trainer - INFO - New best model! Dice: 0.5344
2025-07-22 20:01:56 - src.training.trainer - INFO - Epoch 43/59 (12.0s) - Train Loss: 0.3900, Train Dice: 0.7998, Val Loss: 0.5595, Val Dice: 0.4416, Val IoU: 0.3148
2025-07-22 20:02:08 - src.training.trainer - INFO - Epoch 44/59 (11.9s) - Train Loss: 0.3922, Train Dice: 0.7855, Val Loss: 0.5340, Val Dice: 0.4606, Val IoU: 0.3375
2025-07-22 20:02:20 - src.training.trainer - INFO - Epoch 45/59 (11.6s) - Train Loss: 0.3851, Train Dice: 0.7970, Val Loss: 0.5022, Val Dice: 0.4177, Val IoU: 0.3095
2025-07-22 20:02:21 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_45.pth
2025-07-22 20:02:34 - src.training.trainer - INFO - Epoch 46/59 (12.8s) - Train Loss: 0.3884, Train Dice: 0.7876, Val Loss: 0.5257, Val Dice: 0.3389, Val IoU: 0.2413
2025-07-22 20:02:45 - src.training.trainer - INFO - Epoch 47/59 (10.5s) - Train Loss: 0.3823, Train Dice: 0.8082, Val Loss: 0.5124, Val Dice: 0.4203, Val IoU: 0.3151
2025-07-22 20:02:58 - src.training.trainer - INFO - Epoch 48/59 (12.8s) - Train Loss: 0.3929, Train Dice: 0.7545, Val Loss: 0.4724, Val Dice: 0.5539, Val IoU: 0.4293
2025-07-22 20:02:59 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/best_model.pth
2025-07-22 20:02:59 - src.training.trainer - INFO - New best model! Dice: 0.5539
2025-07-22 20:03:12 - src.training.trainer - INFO - Epoch 49/59 (12.6s) - Train Loss: 0.3819, Train Dice: 0.8026, Val Loss: 0.5019, Val Dice: 0.5127, Val IoU: 0.3859
2025-07-22 20:03:27 - src.training.trainer - INFO - Epoch 50/59 (14.5s) - Train Loss: 0.3806, Train Dice: 0.8134, Val Loss: 0.4907, Val Dice: 0.4959, Val IoU: 0.3665
2025-07-22 20:03:28 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_50.pth
2025-07-22 20:03:42 - src.training.trainer - INFO - Epoch 51/59 (14.0s) - Train Loss: 0.3737, Train Dice: 0.8305, Val Loss: 0.4749, Val Dice: 0.4926, Val IoU: 0.3707
2025-07-22 20:03:56 - src.training.trainer - INFO - Epoch 52/59 (13.2s) - Train Loss: 0.3801, Train Dice: 0.7703, Val Loss: 0.4549, Val Dice: 0.5501, Val IoU: 0.4363
2025-07-22 20:04:07 - src.training.trainer - INFO - Epoch 53/59 (11.8s) - Train Loss: 0.3739, Train Dice: 0.7761, Val Loss: 0.4648, Val Dice: 0.4674, Val IoU: 0.3654
2025-07-22 20:04:20 - src.training.trainer - INFO - Epoch 54/59 (12.8s) - Train Loss: 0.3667, Train Dice: 0.8087, Val Loss: 0.4908, Val Dice: 0.3906, Val IoU: 0.2825
2025-07-22 20:04:32 - src.training.trainer - INFO - Epoch 55/59 (11.8s) - Train Loss: 0.3604, Train Dice: 0.8358, Val Loss: 0.4849, Val Dice: 0.4226, Val IoU: 0.3136
2025-07-22 20:04:34 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/checkpoint_epoch_55.pth
2025-07-22 20:04:45 - src.training.trainer - INFO - Epoch 56/59 (11.6s) - Train Loss: 0.3633, Train Dice: 0.8403, Val Loss: 0.4727, Val Dice: 0.4937, Val IoU: 0.3797
2025-07-22 20:04:58 - src.training.trainer - INFO - Epoch 57/59 (12.6s) - Train Loss: 0.3596, Train Dice: 0.8479, Val Loss: 0.4766, Val Dice: 0.4949, Val IoU: 0.3750
2025-07-22 20:05:10 - src.training.trainer - INFO - Epoch 58/59 (12.2s) - Train Loss: 0.3563, Train Dice: 0.8510, Val Loss: 0.4776, Val Dice: 0.4788, Val IoU: 0.3612
2025-07-22 20:05:23 - src.training.trainer - INFO - Epoch 59/59 (12.5s) - Train Loss: 0.3520, Train Dice: 0.8460, Val Loss: 0.4691, Val Dice: 0.4844, Val IoU: 0.3735
2025-07-22 20:05:24 - src.training.trainer - INFO - Saved checkpoint to experiments/snake_crop/final_model.pth
2025-07-22 20:05:28 - src.visualization.visualize - INFO - Saved training history to experiments/snake_crop/training_history.png
2025-07-22 20:05:28 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:05:32 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:05:32 - src.evaluation.metrics - INFO -   Dice: 55.21%
2025-07-22 20:05:32 - src.evaluation.metrics - INFO -   IoU: 44.17%
2025-07-22 20:05:32 - src.evaluation.metrics - INFO -   Pixel Accuracy: 96.49%
2025-07-22 20:05:33 - src.visualization.visualize - INFO - Saved visualization to experiments/snake_crop/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:05:33 - src.visualization.visualize - INFO - Saved visualization to experiments/snake_crop/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:05:34 - src.visualization.visualize - INFO - Saved visualization to experiments/snake_crop/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:05:34 - src.visualization.visualize - INFO - Saved visualization to experiments/snake_crop/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:05:35 - src.visualization.visualize - INFO - Saved visualization to experiments/snake_crop/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:05:35 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:05:35 - src.training.experiment - INFO - Test Dice: 55.21%
2025-07-22 20:05:35 - src.training.experiment - INFO - Test IoU: 44.17%
2025-07-22 20:05:35 - src.training.experiment - INFO - Test Pixel Accuracy: 96.49%
2025-07-22 20:05:35 - root - INFO - 
============================================================
2025-07-22 20:05:35 - root - INFO - Running experiment: hist_eq
2025-07-22 20:05:35 - root - INFO - ============================================================

2025-07-22 20:05:35 - src.training.experiment - INFO - Starting experiment: hist_eq
2025-07-22 20:05:35 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:05:35 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:05:35 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:05:35 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:05:35 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:05:35 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:05:35 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:05:35 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:05:39 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:05:39 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:05:41 - src.training.trainer - INFO - Epoch 0/59 (2.5s) - Train Loss: 0.8512, Train Dice: 0.0678, Val Loss: 0.8355, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:05:43 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_0.pth
2025-07-22 20:05:46 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.7735, Train Dice: 0.1429, Val Loss: 0.8382, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:05:48 - src.training.trainer - INFO - Epoch 2/59 (2.5s) - Train Loss: 0.7172, Train Dice: 0.1701, Val Loss: 0.8181, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:05:51 - src.training.trainer - INFO - Epoch 3/59 (2.5s) - Train Loss: 0.6829, Train Dice: 0.2037, Val Loss: 0.8376, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:05:54 - src.training.trainer - INFO - Epoch 4/59 (2.7s) - Train Loss: 0.6631, Train Dice: 0.2056, Val Loss: 0.8701, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:05:56 - src.training.trainer - INFO - Epoch 5/59 (2.5s) - Train Loss: 0.6518, Train Dice: 0.2127, Val Loss: 0.9074, Val Dice: 0.1285, Val IoU: 0.0712
2025-07-22 20:05:58 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:05:58 - src.training.trainer - INFO - New best model! Dice: 0.1285
2025-07-22 20:06:00 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_5.pth
2025-07-22 20:06:02 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.6453, Train Dice: 0.2403, Val Loss: 0.8109, Val Dice: 0.0900, Val IoU: 0.0542
2025-07-22 20:06:05 - src.training.trainer - INFO - Epoch 7/59 (2.5s) - Train Loss: 0.6348, Train Dice: 0.2617, Val Loss: 0.8282, Val Dice: 0.1110, Val IoU: 0.0657
2025-07-22 20:06:07 - src.training.trainer - INFO - Epoch 8/59 (2.5s) - Train Loss: 0.6280, Train Dice: 0.2688, Val Loss: 0.9055, Val Dice: 0.1043, Val IoU: 0.0574
2025-07-22 20:06:10 - src.training.trainer - INFO - Epoch 9/59 (2.5s) - Train Loss: 0.6192, Train Dice: 0.3154, Val Loss: 0.9395, Val Dice: 0.1121, Val IoU: 0.0607
2025-07-22 20:06:12 - src.training.trainer - INFO - Epoch 10/59 (2.5s) - Train Loss: 0.6106, Train Dice: 0.3144, Val Loss: 0.9917, Val Dice: 0.0658, Val IoU: 0.0345
2025-07-22 20:06:14 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_10.pth
2025-07-22 20:06:17 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.6018, Train Dice: 0.3679, Val Loss: 0.9828, Val Dice: 0.0618, Val IoU: 0.0323
2025-07-22 20:06:19 - src.training.trainer - INFO - Epoch 12/59 (2.5s) - Train Loss: 0.5946, Train Dice: 0.4409, Val Loss: 1.0008, Val Dice: 0.0639, Val IoU: 0.0335
2025-07-22 20:06:22 - src.training.trainer - INFO - Epoch 13/59 (2.5s) - Train Loss: 0.5873, Train Dice: 0.4240, Val Loss: 0.9884, Val Dice: 0.0649, Val IoU: 0.0341
2025-07-22 20:06:24 - src.training.trainer - INFO - Epoch 14/59 (2.6s) - Train Loss: 0.5837, Train Dice: 0.4296, Val Loss: 1.0331, Val Dice: 0.0643, Val IoU: 0.0337
2025-07-22 20:06:27 - src.training.trainer - INFO - Epoch 15/59 (2.5s) - Train Loss: 0.5762, Train Dice: 0.4850, Val Loss: 1.0956, Val Dice: 0.0623, Val IoU: 0.0326
2025-07-22 20:06:29 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_15.pth
2025-07-22 20:06:31 - src.training.trainer - INFO - Epoch 16/59 (2.6s) - Train Loss: 0.5744, Train Dice: 0.4893, Val Loss: 1.1196, Val Dice: 0.0631, Val IoU: 0.0331
2025-07-22 20:06:34 - src.training.trainer - INFO - Epoch 17/59 (2.6s) - Train Loss: 0.5670, Train Dice: 0.4943, Val Loss: 1.1276, Val Dice: 0.0637, Val IoU: 0.0333
2025-07-22 20:06:36 - src.training.trainer - INFO - Epoch 18/59 (2.5s) - Train Loss: 0.5611, Train Dice: 0.5087, Val Loss: 1.1066, Val Dice: 0.0642, Val IoU: 0.0336
2025-07-22 20:06:39 - src.training.trainer - INFO - Epoch 19/59 (2.6s) - Train Loss: 0.5590, Train Dice: 0.5451, Val Loss: 1.0973, Val Dice: 0.0621, Val IoU: 0.0325
2025-07-22 20:06:42 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.5512, Train Dice: 0.5629, Val Loss: 1.1042, Val Dice: 0.0649, Val IoU: 0.0340
2025-07-22 20:06:43 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_20.pth
2025-07-22 20:06:46 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.5498, Train Dice: 0.5705, Val Loss: 1.0816, Val Dice: 0.0642, Val IoU: 0.0337
2025-07-22 20:06:48 - src.training.trainer - INFO - Epoch 22/59 (2.5s) - Train Loss: 0.5493, Train Dice: 0.5567, Val Loss: 1.0693, Val Dice: 0.0603, Val IoU: 0.0317
2025-07-22 20:06:51 - src.training.trainer - INFO - Epoch 23/59 (2.5s) - Train Loss: 0.5437, Train Dice: 0.5911, Val Loss: 1.0427, Val Dice: 0.0635, Val IoU: 0.0335
2025-07-22 20:06:54 - src.training.trainer - INFO - Epoch 24/59 (2.5s) - Train Loss: 0.5390, Train Dice: 0.6128, Val Loss: 0.9920, Val Dice: 0.0654, Val IoU: 0.0346
2025-07-22 20:06:56 - src.training.trainer - INFO - Epoch 25/59 (2.6s) - Train Loss: 0.5377, Train Dice: 0.6020, Val Loss: 0.9115, Val Dice: 0.0696, Val IoU: 0.0372
2025-07-22 20:06:58 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_25.pth
2025-07-22 20:07:01 - src.training.trainer - INFO - Epoch 26/59 (2.6s) - Train Loss: 0.5345, Train Dice: 0.6453, Val Loss: 0.8011, Val Dice: 0.0883, Val IoU: 0.0483
2025-07-22 20:07:03 - src.training.trainer - INFO - Epoch 27/59 (2.5s) - Train Loss: 0.5334, Train Dice: 0.6386, Val Loss: 0.6807, Val Dice: 0.1548, Val IoU: 0.0901
2025-07-22 20:07:05 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:05 - src.training.trainer - INFO - New best model! Dice: 0.1548
2025-07-22 20:07:07 - src.training.trainer - INFO - Epoch 28/59 (2.5s) - Train Loss: 0.5327, Train Dice: 0.6614, Val Loss: 0.6089, Val Dice: 0.2092, Val IoU: 0.1360
2025-07-22 20:07:09 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:09 - src.training.trainer - INFO - New best model! Dice: 0.2092
2025-07-22 20:07:12 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.5294, Train Dice: 0.6449, Val Loss: 0.5659, Val Dice: 0.4018, Val IoU: 0.3000
2025-07-22 20:07:14 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:14 - src.training.trainer - INFO - New best model! Dice: 0.4018
2025-07-22 20:07:16 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.5296, Train Dice: 0.6454, Val Loss: 0.5473, Val Dice: 0.5685, Val IoU: 0.4387
2025-07-22 20:07:18 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:18 - src.training.trainer - INFO - New best model! Dice: 0.5685
2025-07-22 20:07:20 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_30.pth
2025-07-22 20:07:22 - src.training.trainer - INFO - Epoch 31/59 (2.6s) - Train Loss: 0.5253, Train Dice: 0.6855, Val Loss: 0.5517, Val Dice: 0.4759, Val IoU: 0.3700
2025-07-22 20:07:25 - src.training.trainer - INFO - Epoch 32/59 (2.5s) - Train Loss: 0.5306, Train Dice: 0.6103, Val Loss: 0.5615, Val Dice: 0.3337, Val IoU: 0.2680
2025-07-22 20:07:42 - src.training.trainer - INFO - Epoch 33/59 (17.5s) - Train Loss: 0.5249, Train Dice: 0.6685, Val Loss: 0.5520, Val Dice: 0.4941, Val IoU: 0.3795
2025-07-22 20:07:45 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.5245, Train Dice: 0.6992, Val Loss: 0.5388, Val Dice: 0.5925, Val IoU: 0.4488
2025-07-22 20:07:47 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:47 - src.training.trainer - INFO - New best model! Dice: 0.5925
2025-07-22 20:07:49 - src.training.trainer - INFO - Epoch 35/59 (2.5s) - Train Loss: 0.5212, Train Dice: 0.6815, Val Loss: 0.5347, Val Dice: 0.6130, Val IoU: 0.4744
2025-07-22 20:07:51 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/best_model.pth
2025-07-22 20:07:51 - src.training.trainer - INFO - New best model! Dice: 0.6130
2025-07-22 20:07:53 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_35.pth
2025-07-22 20:07:56 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.5251, Train Dice: 0.6312, Val Loss: 0.5440, Val Dice: 0.4863, Val IoU: 0.3778
2025-07-22 20:07:58 - src.training.trainer - INFO - Epoch 37/59 (2.6s) - Train Loss: 0.5183, Train Dice: 0.6880, Val Loss: 0.5467, Val Dice: 0.4806, Val IoU: 0.3771
2025-07-22 20:08:01 - src.training.trainer - INFO - Epoch 38/59 (2.5s) - Train Loss: 0.5172, Train Dice: 0.7025, Val Loss: 0.5414, Val Dice: 0.5471, Val IoU: 0.4301
2025-07-22 20:08:03 - src.training.trainer - INFO - Epoch 39/59 (2.5s) - Train Loss: 0.5152, Train Dice: 0.7122, Val Loss: 0.5505, Val Dice: 0.3842, Val IoU: 0.3038
2025-07-22 20:08:06 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.5104, Train Dice: 0.7553, Val Loss: 0.5573, Val Dice: 0.2779, Val IoU: 0.2288
2025-07-22 20:08:08 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_40.pth
2025-07-22 20:08:10 - src.training.trainer - INFO - Epoch 41/59 (2.6s) - Train Loss: 0.5151, Train Dice: 0.7001, Val Loss: 0.5513, Val Dice: 0.3221, Val IoU: 0.2637
2025-07-22 20:08:13 - src.training.trainer - INFO - Epoch 42/59 (2.5s) - Train Loss: 0.5121, Train Dice: 0.7020, Val Loss: 0.5471, Val Dice: 0.3958, Val IoU: 0.3196
2025-07-22 20:08:15 - src.training.trainer - INFO - Epoch 43/59 (2.5s) - Train Loss: 0.5110, Train Dice: 0.7418, Val Loss: 0.5434, Val Dice: 0.4222, Val IoU: 0.3346
2025-07-22 20:08:18 - src.training.trainer - INFO - Epoch 44/59 (2.5s) - Train Loss: 0.5087, Train Dice: 0.7497, Val Loss: 0.5418, Val Dice: 0.4442, Val IoU: 0.3470
2025-07-22 20:08:20 - src.training.trainer - INFO - Epoch 45/59 (2.5s) - Train Loss: 0.5071, Train Dice: 0.7427, Val Loss: 0.5450, Val Dice: 0.3901, Val IoU: 0.3075
2025-07-22 20:08:22 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_45.pth
2025-07-22 20:08:25 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.5053, Train Dice: 0.7419, Val Loss: 0.5477, Val Dice: 0.3537, Val IoU: 0.2779
2025-07-22 20:08:27 - src.training.trainer - INFO - Epoch 47/59 (2.6s) - Train Loss: 0.5033, Train Dice: 0.7727, Val Loss: 0.5385, Val Dice: 0.4707, Val IoU: 0.3624
2025-07-22 20:08:30 - src.training.trainer - INFO - Epoch 48/59 (2.6s) - Train Loss: 0.5040, Train Dice: 0.7581, Val Loss: 0.5316, Val Dice: 0.5250, Val IoU: 0.4143
2025-07-22 20:08:33 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.5042, Train Dice: 0.7558, Val Loss: 0.5308, Val Dice: 0.5297, Val IoU: 0.4177
2025-07-22 20:08:36 - src.training.trainer - INFO - Epoch 50/59 (2.6s) - Train Loss: 0.5025, Train Dice: 0.7612, Val Loss: 0.5336, Val Dice: 0.5022, Val IoU: 0.3902
2025-07-22 20:08:37 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_50.pth
2025-07-22 20:08:40 - src.training.trainer - INFO - Epoch 51/59 (2.6s) - Train Loss: 0.5039, Train Dice: 0.7565, Val Loss: 0.5402, Val Dice: 0.3988, Val IoU: 0.3138
2025-07-22 20:08:42 - src.training.trainer - INFO - Epoch 52/59 (2.5s) - Train Loss: 0.5018, Train Dice: 0.7651, Val Loss: 0.5450, Val Dice: 0.3500, Val IoU: 0.2753
2025-07-22 20:08:45 - src.training.trainer - INFO - Epoch 53/59 (2.6s) - Train Loss: 0.5028, Train Dice: 0.7615, Val Loss: 0.5451, Val Dice: 0.3405, Val IoU: 0.2683
2025-07-22 20:08:48 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.5023, Train Dice: 0.7679, Val Loss: 0.5416, Val Dice: 0.3756, Val IoU: 0.2913
2025-07-22 20:08:50 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.5009, Train Dice: 0.7766, Val Loss: 0.5369, Val Dice: 0.4150, Val IoU: 0.3203
2025-07-22 20:08:52 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/checkpoint_epoch_55.pth
2025-07-22 20:08:55 - src.training.trainer - INFO - Epoch 56/59 (2.8s) - Train Loss: 0.5002, Train Dice: 0.7813, Val Loss: 0.5292, Val Dice: 0.4936, Val IoU: 0.3783
2025-07-22 20:08:57 - src.training.trainer - INFO - Epoch 57/59 (2.5s) - Train Loss: 0.4994, Train Dice: 0.7738, Val Loss: 0.5245, Val Dice: 0.5395, Val IoU: 0.4242
2025-07-22 20:09:00 - src.training.trainer - INFO - Epoch 58/59 (2.5s) - Train Loss: 0.4974, Train Dice: 0.7820, Val Loss: 0.5217, Val Dice: 0.5738, Val IoU: 0.4503
2025-07-22 20:09:02 - src.training.trainer - INFO - Epoch 59/59 (2.5s) - Train Loss: 0.4986, Train Dice: 0.7768, Val Loss: 0.5208, Val Dice: 0.5839, Val IoU: 0.4586
2025-07-22 20:09:04 - src.training.trainer - INFO - Saved checkpoint to experiments/hist_eq/final_model.pth
2025-07-22 20:09:06 - src.visualization.visualize - INFO - Saved training history to experiments/hist_eq/training_history.png
2025-07-22 20:09:06 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:09:09 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:09:09 - src.evaluation.metrics - INFO -   Dice: 40.20%
2025-07-22 20:09:09 - src.evaluation.metrics - INFO -   IoU: 30.18%
2025-07-22 20:09:09 - src.evaluation.metrics - INFO -   Pixel Accuracy: 96.81%
2025-07-22 20:09:10 - src.visualization.visualize - INFO - Saved visualization to experiments/hist_eq/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:09:11 - src.visualization.visualize - INFO - Saved visualization to experiments/hist_eq/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:09:11 - src.visualization.visualize - INFO - Saved visualization to experiments/hist_eq/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:09:12 - src.visualization.visualize - INFO - Saved visualization to experiments/hist_eq/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:09:12 - src.visualization.visualize - INFO - Saved visualization to experiments/hist_eq/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:09:12 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:09:12 - src.training.experiment - INFO - Test Dice: 40.20%
2025-07-22 20:09:12 - src.training.experiment - INFO - Test IoU: 30.18%
2025-07-22 20:09:12 - src.training.experiment - INFO - Test Pixel Accuracy: 96.81%
2025-07-22 20:09:12 - root - INFO - 
============================================================
2025-07-22 20:09:12 - root - INFO - Running experiment: blur
2025-07-22 20:09:12 - root - INFO - ============================================================

2025-07-22 20:09:12 - src.training.experiment - INFO - Starting experiment: blur
2025-07-22 20:09:12 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:09:12 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:09:12 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:09:12 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:09:12 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:09:12 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:09:12 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:09:12 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:09:15 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:09:15 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:09:18 - src.training.trainer - INFO - Epoch 0/59 (2.6s) - Train Loss: 0.8438, Train Dice: 0.0503, Val Loss: 0.8442, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:19 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_0.pth
2025-07-22 20:09:22 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.7646, Train Dice: 0.1144, Val Loss: 0.8538, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:25 - src.training.trainer - INFO - Epoch 2/59 (2.6s) - Train Loss: 0.7081, Train Dice: 0.1792, Val Loss: 0.8529, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:27 - src.training.trainer - INFO - Epoch 3/59 (2.6s) - Train Loss: 0.6803, Train Dice: 0.2065, Val Loss: 0.8624, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:30 - src.training.trainer - INFO - Epoch 4/59 (2.6s) - Train Loss: 0.6677, Train Dice: 0.2122, Val Loss: 0.7923, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:32 - src.training.trainer - INFO - Epoch 5/59 (2.5s) - Train Loss: 0.6585, Train Dice: 0.2290, Val Loss: 0.7743, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:34 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_5.pth
2025-07-22 20:09:37 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.6483, Train Dice: 0.2569, Val Loss: 0.7563, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:39 - src.training.trainer - INFO - Epoch 7/59 (2.5s) - Train Loss: 0.6387, Train Dice: 0.2698, Val Loss: 0.7543, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:42 - src.training.trainer - INFO - Epoch 8/59 (2.6s) - Train Loss: 0.6334, Train Dice: 0.2789, Val Loss: 0.7520, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:44 - src.training.trainer - INFO - Epoch 9/59 (2.5s) - Train Loss: 0.6302, Train Dice: 0.2964, Val Loss: 0.7506, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:47 - src.training.trainer - INFO - Epoch 10/59 (2.6s) - Train Loss: 0.6234, Train Dice: 0.3461, Val Loss: 0.7567, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:49 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_10.pth
2025-07-22 20:09:51 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.6201, Train Dice: 0.3528, Val Loss: 0.7622, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:54 - src.training.trainer - INFO - Epoch 12/59 (2.5s) - Train Loss: 0.6141, Train Dice: 0.3905, Val Loss: 0.7863, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:56 - src.training.trainer - INFO - Epoch 13/59 (2.5s) - Train Loss: 0.6072, Train Dice: 0.4457, Val Loss: 0.8162, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:09:59 - src.training.trainer - INFO - Epoch 14/59 (2.5s) - Train Loss: 0.6040, Train Dice: 0.4800, Val Loss: 0.8325, Val Dice: 0.0050, Val IoU: 0.0025
2025-07-22 20:10:01 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:01 - src.training.trainer - INFO - New best model! Dice: 0.0050
2025-07-22 20:10:03 - src.training.trainer - INFO - Epoch 15/59 (2.7s) - Train Loss: 0.5984, Train Dice: 0.5076, Val Loss: 0.8429, Val Dice: 0.0229, Val IoU: 0.0119
2025-07-22 20:10:05 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:05 - src.training.trainer - INFO - New best model! Dice: 0.0229
2025-07-22 20:10:07 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_15.pth
2025-07-22 20:10:10 - src.training.trainer - INFO - Epoch 16/59 (2.6s) - Train Loss: 0.5944, Train Dice: 0.5046, Val Loss: 0.8579, Val Dice: 0.0362, Val IoU: 0.0189
2025-07-22 20:10:11 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:11 - src.training.trainer - INFO - New best model! Dice: 0.0362
2025-07-22 20:10:14 - src.training.trainer - INFO - Epoch 17/59 (2.6s) - Train Loss: 0.5924, Train Dice: 0.5134, Val Loss: 0.8983, Val Dice: 0.0552, Val IoU: 0.0288
2025-07-22 20:10:16 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:16 - src.training.trainer - INFO - New best model! Dice: 0.0552
2025-07-22 20:10:18 - src.training.trainer - INFO - Epoch 18/59 (2.5s) - Train Loss: 0.5871, Train Dice: 0.5037, Val Loss: 0.9153, Val Dice: 0.0630, Val IoU: 0.0330
2025-07-22 20:10:20 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:20 - src.training.trainer - INFO - New best model! Dice: 0.0630
2025-07-22 20:10:23 - src.training.trainer - INFO - Epoch 19/59 (2.5s) - Train Loss: 0.5855, Train Dice: 0.5288, Val Loss: 0.8995, Val Dice: 0.0672, Val IoU: 0.0353
2025-07-22 20:10:25 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:25 - src.training.trainer - INFO - New best model! Dice: 0.0672
2025-07-22 20:10:27 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.5797, Train Dice: 0.5797, Val Loss: 0.9057, Val Dice: 0.0715, Val IoU: 0.0377
2025-07-22 20:10:29 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:29 - src.training.trainer - INFO - New best model! Dice: 0.0715
2025-07-22 20:10:31 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_20.pth
2025-07-22 20:10:33 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.5810, Train Dice: 0.5059, Val Loss: 0.9852, Val Dice: 0.0742, Val IoU: 0.0391
2025-07-22 20:10:35 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:35 - src.training.trainer - INFO - New best model! Dice: 0.0742
2025-07-22 20:10:38 - src.training.trainer - INFO - Epoch 22/59 (2.6s) - Train Loss: 0.5709, Train Dice: 0.5341, Val Loss: 0.9545, Val Dice: 0.0793, Val IoU: 0.0420
2025-07-22 20:10:40 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:40 - src.training.trainer - INFO - New best model! Dice: 0.0793
2025-07-22 20:10:42 - src.training.trainer - INFO - Epoch 23/59 (2.5s) - Train Loss: 0.5671, Train Dice: 0.5644, Val Loss: 0.9706, Val Dice: 0.0635, Val IoU: 0.0334
2025-07-22 20:10:45 - src.training.trainer - INFO - Epoch 24/59 (2.6s) - Train Loss: 0.5670, Train Dice: 0.5503, Val Loss: 1.0737, Val Dice: 0.0670, Val IoU: 0.0352
2025-07-22 20:10:47 - src.training.trainer - INFO - Epoch 25/59 (2.5s) - Train Loss: 0.5641, Train Dice: 0.5315, Val Loss: 1.1805, Val Dice: 0.0711, Val IoU: 0.0375
2025-07-22 20:10:49 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_25.pth
2025-07-22 20:10:52 - src.training.trainer - INFO - Epoch 26/59 (2.6s) - Train Loss: 0.5586, Train Dice: 0.5950, Val Loss: 1.2457, Val Dice: 0.0713, Val IoU: 0.0376
2025-07-22 20:10:54 - src.training.trainer - INFO - Epoch 27/59 (2.5s) - Train Loss: 0.5572, Train Dice: 0.5917, Val Loss: 1.2501, Val Dice: 0.0680, Val IoU: 0.0358
2025-07-22 20:10:57 - src.training.trainer - INFO - Epoch 28/59 (2.5s) - Train Loss: 0.5518, Train Dice: 0.5973, Val Loss: 1.0950, Val Dice: 0.0813, Val IoU: 0.0430
2025-07-22 20:10:59 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:10:59 - src.training.trainer - INFO - New best model! Dice: 0.0813
2025-07-22 20:11:01 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.5481, Train Dice: 0.6177, Val Loss: 1.1850, Val Dice: 0.0801, Val IoU: 0.0425
2025-07-22 20:11:04 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.5490, Train Dice: 0.5984, Val Loss: 0.9974, Val Dice: 0.0987, Val IoU: 0.0530
2025-07-22 20:11:06 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:06 - src.training.trainer - INFO - New best model! Dice: 0.0987
2025-07-22 20:11:08 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_30.pth
2025-07-22 20:11:10 - src.training.trainer - INFO - Epoch 31/59 (2.6s) - Train Loss: 0.5468, Train Dice: 0.6159, Val Loss: 0.9916, Val Dice: 0.1156, Val IoU: 0.0630
2025-07-22 20:11:12 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:12 - src.training.trainer - INFO - New best model! Dice: 0.1156
2025-07-22 20:11:15 - src.training.trainer - INFO - Epoch 32/59 (2.6s) - Train Loss: 0.5440, Train Dice: 0.6069, Val Loss: 0.7896, Val Dice: 0.1625, Val IoU: 0.0911
2025-07-22 20:11:17 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:17 - src.training.trainer - INFO - New best model! Dice: 0.1625
2025-07-22 20:11:31 - src.training.trainer - INFO - Epoch 33/59 (14.1s) - Train Loss: 0.5374, Train Dice: 0.6518, Val Loss: 0.7719, Val Dice: 0.1237, Val IoU: 0.0692
2025-07-22 20:11:33 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.5408, Train Dice: 0.6099, Val Loss: 0.8316, Val Dice: 0.1284, Val IoU: 0.0707
2025-07-22 20:11:36 - src.training.trainer - INFO - Epoch 35/59 (2.5s) - Train Loss: 0.5382, Train Dice: 0.5957, Val Loss: 0.6937, Val Dice: 0.2559, Val IoU: 0.1541
2025-07-22 20:11:38 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:38 - src.training.trainer - INFO - New best model! Dice: 0.2559
2025-07-22 20:11:39 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_35.pth
2025-07-22 20:11:42 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.5355, Train Dice: 0.6308, Val Loss: 0.6694, Val Dice: 0.2714, Val IoU: 0.1644
2025-07-22 20:11:44 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:44 - src.training.trainer - INFO - New best model! Dice: 0.2714
2025-07-22 20:11:46 - src.training.trainer - INFO - Epoch 37/59 (2.5s) - Train Loss: 0.5313, Train Dice: 0.6677, Val Loss: 0.6957, Val Dice: 0.2282, Val IoU: 0.1334
2025-07-22 20:11:49 - src.training.trainer - INFO - Epoch 38/59 (2.6s) - Train Loss: 0.5322, Train Dice: 0.6274, Val Loss: 0.6795, Val Dice: 0.2343, Val IoU: 0.1380
2025-07-22 20:11:51 - src.training.trainer - INFO - Epoch 39/59 (2.5s) - Train Loss: 0.5269, Train Dice: 0.6531, Val Loss: 0.6414, Val Dice: 0.2815, Val IoU: 0.1710
2025-07-22 20:11:53 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:53 - src.training.trainer - INFO - New best model! Dice: 0.2815
2025-07-22 20:11:56 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.5238, Train Dice: 0.6577, Val Loss: 0.5834, Val Dice: 0.4652, Val IoU: 0.3253
2025-07-22 20:11:58 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:11:58 - src.training.trainer - INFO - New best model! Dice: 0.4652
2025-07-22 20:12:00 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_40.pth
2025-07-22 20:12:02 - src.training.trainer - INFO - Epoch 41/59 (2.6s) - Train Loss: 0.5221, Train Dice: 0.6442, Val Loss: 0.5774, Val Dice: 0.5205, Val IoU: 0.3789
2025-07-22 20:12:04 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:12:04 - src.training.trainer - INFO - New best model! Dice: 0.5205
2025-07-22 20:12:07 - src.training.trainer - INFO - Epoch 42/59 (2.5s) - Train Loss: 0.5152, Train Dice: 0.7201, Val Loss: 0.5530, Val Dice: 0.5186, Val IoU: 0.3809
2025-07-22 20:12:09 - src.training.trainer - INFO - Epoch 43/59 (2.5s) - Train Loss: 0.5134, Train Dice: 0.7165, Val Loss: 0.5568, Val Dice: 0.4857, Val IoU: 0.3525
2025-07-22 20:12:12 - src.training.trainer - INFO - Epoch 44/59 (2.5s) - Train Loss: 0.5122, Train Dice: 0.7039, Val Loss: 0.5512, Val Dice: 0.5048, Val IoU: 0.3720
2025-07-22 20:12:14 - src.training.trainer - INFO - Epoch 45/59 (2.5s) - Train Loss: 0.5097, Train Dice: 0.7298, Val Loss: 0.5483, Val Dice: 0.5039, Val IoU: 0.3656
2025-07-22 20:12:16 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_45.pth
2025-07-22 20:12:19 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.5033, Train Dice: 0.7203, Val Loss: 0.5469, Val Dice: 0.5541, Val IoU: 0.4085
2025-07-22 20:12:21 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/best_model.pth
2025-07-22 20:12:21 - src.training.trainer - INFO - New best model! Dice: 0.5541
2025-07-22 20:12:23 - src.training.trainer - INFO - Epoch 47/59 (2.5s) - Train Loss: 0.5088, Train Dice: 0.6648, Val Loss: 0.5431, Val Dice: 0.5312, Val IoU: 0.3929
2025-07-22 20:12:26 - src.training.trainer - INFO - Epoch 48/59 (2.6s) - Train Loss: 0.5054, Train Dice: 0.7096, Val Loss: 0.5346, Val Dice: 0.4975, Val IoU: 0.3707
2025-07-22 20:12:29 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.5005, Train Dice: 0.7196, Val Loss: 0.5326, Val Dice: 0.4676, Val IoU: 0.3529
2025-07-22 20:12:31 - src.training.trainer - INFO - Epoch 50/59 (2.5s) - Train Loss: 0.4997, Train Dice: 0.7077, Val Loss: 0.5265, Val Dice: 0.5078, Val IoU: 0.3816
2025-07-22 20:12:33 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_50.pth
2025-07-22 20:12:36 - src.training.trainer - INFO - Epoch 51/59 (2.6s) - Train Loss: 0.4958, Train Dice: 0.7623, Val Loss: 0.5267, Val Dice: 0.5339, Val IoU: 0.3901
2025-07-22 20:12:38 - src.training.trainer - INFO - Epoch 52/59 (2.6s) - Train Loss: 0.4967, Train Dice: 0.7060, Val Loss: 0.5381, Val Dice: 0.5074, Val IoU: 0.3693
2025-07-22 20:12:41 - src.training.trainer - INFO - Epoch 53/59 (2.5s) - Train Loss: 0.4930, Train Dice: 0.7101, Val Loss: 0.5361, Val Dice: 0.4833, Val IoU: 0.3546
2025-07-22 20:12:43 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.4903, Train Dice: 0.7541, Val Loss: 0.5307, Val Dice: 0.4894, Val IoU: 0.3684
2025-07-22 20:12:46 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.4887, Train Dice: 0.7833, Val Loss: 0.5268, Val Dice: 0.4776, Val IoU: 0.3652
2025-07-22 20:12:48 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/checkpoint_epoch_55.pth
2025-07-22 20:12:50 - src.training.trainer - INFO - Epoch 56/59 (2.6s) - Train Loss: 0.4853, Train Dice: 0.7731, Val Loss: 0.5261, Val Dice: 0.4783, Val IoU: 0.3606
2025-07-22 20:12:53 - src.training.trainer - INFO - Epoch 57/59 (2.5s) - Train Loss: 0.4863, Train Dice: 0.7319, Val Loss: 0.5276, Val Dice: 0.4629, Val IoU: 0.3527
2025-07-22 20:12:55 - src.training.trainer - INFO - Epoch 58/59 (2.5s) - Train Loss: 0.4826, Train Dice: 0.7750, Val Loss: 0.5277, Val Dice: 0.4382, Val IoU: 0.3439
2025-07-22 20:12:58 - src.training.trainer - INFO - Epoch 59/59 (2.6s) - Train Loss: 0.4857, Train Dice: 0.7818, Val Loss: 0.5266, Val Dice: 0.4531, Val IoU: 0.3567
2025-07-22 20:13:00 - src.training.trainer - INFO - Saved checkpoint to experiments/blur/final_model.pth
2025-07-22 20:13:02 - src.visualization.visualize - INFO - Saved training history to experiments/blur/training_history.png
2025-07-22 20:13:02 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:13:05 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:13:05 - src.evaluation.metrics - INFO -   Dice: 49.60%
2025-07-22 20:13:05 - src.evaluation.metrics - INFO -   IoU: 37.37%
2025-07-22 20:13:05 - src.evaluation.metrics - INFO -   Pixel Accuracy: 97.14%
2025-07-22 20:13:06 - src.visualization.visualize - INFO - Saved visualization to experiments/blur/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:13:06 - src.visualization.visualize - INFO - Saved visualization to experiments/blur/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:13:07 - src.visualization.visualize - INFO - Saved visualization to experiments/blur/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:13:07 - src.visualization.visualize - INFO - Saved visualization to experiments/blur/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:13:07 - src.visualization.visualize - INFO - Saved visualization to experiments/blur/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:13:07 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:13:07 - src.training.experiment - INFO - Test Dice: 49.60%
2025-07-22 20:13:07 - src.training.experiment - INFO - Test IoU: 37.37%
2025-07-22 20:13:07 - src.training.experiment - INFO - Test Pixel Accuracy: 97.14%
2025-07-22 20:13:07 - root - INFO - 
============================================================
2025-07-22 20:13:07 - root - INFO - Running experiment: sharpen
2025-07-22 20:13:07 - root - INFO - ============================================================

2025-07-22 20:13:07 - src.training.experiment - INFO - Starting experiment: sharpen
2025-07-22 20:13:07 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:13:07 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:13:07 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:13:07 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:13:07 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:13:07 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:13:07 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:13:07 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:13:11 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:13:11 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:13:14 - src.training.trainer - INFO - Epoch 0/59 (2.6s) - Train Loss: 0.7689, Train Dice: 0.0900, Val Loss: 0.8136, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:13:16 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_0.pth
2025-07-22 20:13:18 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.6964, Train Dice: 0.2214, Val Loss: 0.7901, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:13:21 - src.training.trainer - INFO - Epoch 2/59 (2.6s) - Train Loss: 0.6575, Train Dice: 0.2481, Val Loss: 0.8131, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:13:23 - src.training.trainer - INFO - Epoch 3/59 (2.6s) - Train Loss: 0.6371, Train Dice: 0.2772, Val Loss: 0.7630, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:13:26 - src.training.trainer - INFO - Epoch 4/59 (2.5s) - Train Loss: 0.6192, Train Dice: 0.3549, Val Loss: 0.8499, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:13:29 - src.training.trainer - INFO - Epoch 5/59 (2.6s) - Train Loss: 0.6163, Train Dice: 0.3115, Val Loss: 0.9314, Val Dice: 0.0501, Val IoU: 0.0260
2025-07-22 20:13:30 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:13:30 - src.training.trainer - INFO - New best model! Dice: 0.0501
2025-07-22 20:13:32 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_5.pth
2025-07-22 20:13:35 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.6047, Train Dice: 0.3257, Val Loss: 3.3639, Val Dice: 0.0500, Val IoU: 0.0260
2025-07-22 20:13:37 - src.training.trainer - INFO - Epoch 7/59 (2.6s) - Train Loss: 0.5898, Train Dice: 0.4239, Val Loss: 2.8270, Val Dice: 0.0501, Val IoU: 0.0260
2025-07-22 20:13:39 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:13:39 - src.training.trainer - INFO - New best model! Dice: 0.0501
2025-07-22 20:13:42 - src.training.trainer - INFO - Epoch 8/59 (2.6s) - Train Loss: 0.5825, Train Dice: 0.4155, Val Loss: 2.4628, Val Dice: 0.0502, Val IoU: 0.0261
2025-07-22 20:13:44 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:13:44 - src.training.trainer - INFO - New best model! Dice: 0.0502
2025-07-22 20:13:46 - src.training.trainer - INFO - Epoch 9/59 (2.5s) - Train Loss: 0.5677, Train Dice: 0.4324, Val Loss: 3.2378, Val Dice: 0.0501, Val IoU: 0.0260
2025-07-22 20:13:49 - src.training.trainer - INFO - Epoch 10/59 (2.6s) - Train Loss: 0.5542, Train Dice: 0.5162, Val Loss: 2.8421, Val Dice: 0.0535, Val IoU: 0.0278
2025-07-22 20:13:51 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:13:51 - src.training.trainer - INFO - New best model! Dice: 0.0535
2025-07-22 20:13:52 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_10.pth
2025-07-22 20:13:55 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.5490, Train Dice: 0.5023, Val Loss: 3.5349, Val Dice: 0.0520, Val IoU: 0.0271
2025-07-22 20:13:58 - src.training.trainer - INFO - Epoch 12/59 (2.6s) - Train Loss: 0.5348, Train Dice: 0.5105, Val Loss: 2.6486, Val Dice: 0.0626, Val IoU: 0.0328
2025-07-22 20:13:59 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:13:59 - src.training.trainer - INFO - New best model! Dice: 0.0626
2025-07-22 20:14:02 - src.training.trainer - INFO - Epoch 13/59 (2.6s) - Train Loss: 0.5263, Train Dice: 0.5484, Val Loss: 3.2856, Val Dice: 0.0521, Val IoU: 0.0271
2025-07-22 20:14:05 - src.training.trainer - INFO - Epoch 14/59 (2.5s) - Train Loss: 0.5232, Train Dice: 0.5127, Val Loss: 3.5219, Val Dice: 0.0521, Val IoU: 0.0271
2025-07-22 20:14:07 - src.training.trainer - INFO - Epoch 15/59 (2.5s) - Train Loss: 0.5213, Train Dice: 0.5234, Val Loss: 3.8523, Val Dice: 0.0526, Val IoU: 0.0274
2025-07-22 20:14:09 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_15.pth
2025-07-22 20:14:12 - src.training.trainer - INFO - Epoch 16/59 (2.7s) - Train Loss: 0.5041, Train Dice: 0.5639, Val Loss: 3.0203, Val Dice: 0.0540, Val IoU: 0.0281
2025-07-22 20:14:14 - src.training.trainer - INFO - Epoch 17/59 (2.6s) - Train Loss: 0.5005, Train Dice: 0.5505, Val Loss: 3.0067, Val Dice: 0.0613, Val IoU: 0.0321
2025-07-22 20:14:17 - src.training.trainer - INFO - Epoch 18/59 (2.6s) - Train Loss: 0.4907, Train Dice: 0.6024, Val Loss: 2.9094, Val Dice: 0.0592, Val IoU: 0.0309
2025-07-22 20:14:19 - src.training.trainer - INFO - Epoch 19/59 (2.5s) - Train Loss: 0.4874, Train Dice: 0.5581, Val Loss: 2.0038, Val Dice: 0.0720, Val IoU: 0.0380
2025-07-22 20:14:21 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:21 - src.training.trainer - INFO - New best model! Dice: 0.0720
2025-07-22 20:14:24 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.4833, Train Dice: 0.5894, Val Loss: 1.2176, Val Dice: 0.1088, Val IoU: 0.0588
2025-07-22 20:14:26 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:26 - src.training.trainer - INFO - New best model! Dice: 0.1088
2025-07-22 20:14:27 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_20.pth
2025-07-22 20:14:30 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.4793, Train Dice: 0.6182, Val Loss: 1.0147, Val Dice: 0.1191, Val IoU: 0.0644
2025-07-22 20:14:32 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:32 - src.training.trainer - INFO - New best model! Dice: 0.1191
2025-07-22 20:14:34 - src.training.trainer - INFO - Epoch 22/59 (2.5s) - Train Loss: 0.4721, Train Dice: 0.6231, Val Loss: 1.0086, Val Dice: 0.1069, Val IoU: 0.0574
2025-07-22 20:14:37 - src.training.trainer - INFO - Epoch 23/59 (2.5s) - Train Loss: 0.4691, Train Dice: 0.6115, Val Loss: 0.7348, Val Dice: 0.1754, Val IoU: 0.0999
2025-07-22 20:14:39 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:39 - src.training.trainer - INFO - New best model! Dice: 0.1754
2025-07-22 20:14:41 - src.training.trainer - INFO - Epoch 24/59 (2.5s) - Train Loss: 0.4624, Train Dice: 0.6344, Val Loss: 0.6154, Val Dice: 0.1588, Val IoU: 0.0959
2025-07-22 20:14:44 - src.training.trainer - INFO - Epoch 25/59 (2.5s) - Train Loss: 0.4579, Train Dice: 0.6519, Val Loss: 0.5924, Val Dice: 0.1243, Val IoU: 0.0750
2025-07-22 20:14:46 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_25.pth
2025-07-22 20:14:48 - src.training.trainer - INFO - Epoch 26/59 (2.7s) - Train Loss: 0.4593, Train Dice: 0.6107, Val Loss: 0.5547, Val Dice: 0.1904, Val IoU: 0.1207
2025-07-22 20:14:50 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:50 - src.training.trainer - INFO - New best model! Dice: 0.1904
2025-07-22 20:14:53 - src.training.trainer - INFO - Epoch 27/59 (2.5s) - Train Loss: 0.4553, Train Dice: 0.6402, Val Loss: 0.5168, Val Dice: 0.4153, Val IoU: 0.2922
2025-07-22 20:14:55 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:14:55 - src.training.trainer - INFO - New best model! Dice: 0.4153
2025-07-22 20:14:57 - src.training.trainer - INFO - Epoch 28/59 (2.5s) - Train Loss: 0.4488, Train Dice: 0.6422, Val Loss: 0.5173, Val Dice: 0.2632, Val IoU: 0.1922
2025-07-22 20:15:00 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.4509, Train Dice: 0.6674, Val Loss: 0.5250, Val Dice: 0.2007, Val IoU: 0.1518
2025-07-22 20:15:02 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.4449, Train Dice: 0.6094, Val Loss: 0.4901, Val Dice: 0.4620, Val IoU: 0.3415
2025-07-22 20:15:04 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:15:04 - src.training.trainer - INFO - New best model! Dice: 0.4620
2025-07-22 20:15:06 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_30.pth
2025-07-22 20:15:09 - src.training.trainer - INFO - Epoch 31/59 (2.6s) - Train Loss: 0.4346, Train Dice: 0.6517, Val Loss: 0.4780, Val Dice: 0.5298, Val IoU: 0.4093
2025-07-22 20:15:10 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:15:10 - src.training.trainer - INFO - New best model! Dice: 0.5298
2025-07-22 20:15:13 - src.training.trainer - INFO - Epoch 32/59 (2.5s) - Train Loss: 0.4351, Train Dice: 0.7040, Val Loss: 0.4814, Val Dice: 0.4957, Val IoU: 0.3758
2025-07-22 20:15:32 - src.training.trainer - INFO - Epoch 33/59 (18.7s) - Train Loss: 0.4295, Train Dice: 0.6655, Val Loss: 0.4844, Val Dice: 0.4203, Val IoU: 0.3129
2025-07-22 20:15:34 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.4239, Train Dice: 0.6730, Val Loss: 0.5078, Val Dice: 0.2304, Val IoU: 0.1764
2025-07-22 20:15:37 - src.training.trainer - INFO - Epoch 35/59 (2.6s) - Train Loss: 0.4227, Train Dice: 0.6844, Val Loss: 0.4664, Val Dice: 0.4860, Val IoU: 0.3633
2025-07-22 20:15:39 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_35.pth
2025-07-22 20:15:41 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.4173, Train Dice: 0.6872, Val Loss: 0.4610, Val Dice: 0.5019, Val IoU: 0.3820
2025-07-22 20:15:44 - src.training.trainer - INFO - Epoch 37/59 (2.6s) - Train Loss: 0.4096, Train Dice: 0.7269, Val Loss: 0.4438, Val Dice: 0.5607, Val IoU: 0.4389
2025-07-22 20:15:46 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:15:46 - src.training.trainer - INFO - New best model! Dice: 0.5607
2025-07-22 20:15:48 - src.training.trainer - INFO - Epoch 38/59 (2.6s) - Train Loss: 0.4100, Train Dice: 0.7036, Val Loss: 0.4546, Val Dice: 0.4713, Val IoU: 0.3671
2025-07-22 20:15:51 - src.training.trainer - INFO - Epoch 39/59 (2.5s) - Train Loss: 0.3995, Train Dice: 0.7257, Val Loss: 0.4825, Val Dice: 0.2997, Val IoU: 0.2404
2025-07-22 20:15:53 - src.training.trainer - INFO - Epoch 40/59 (2.6s) - Train Loss: 0.4028, Train Dice: 0.7300, Val Loss: 0.4226, Val Dice: 0.6210, Val IoU: 0.4743
2025-07-22 20:15:55 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/best_model.pth
2025-07-22 20:15:55 - src.training.trainer - INFO - New best model! Dice: 0.6210
2025-07-22 20:15:57 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_40.pth
2025-07-22 20:16:00 - src.training.trainer - INFO - Epoch 41/59 (2.7s) - Train Loss: 0.3977, Train Dice: 0.7346, Val Loss: 0.4243, Val Dice: 0.6066, Val IoU: 0.4588
2025-07-22 20:16:02 - src.training.trainer - INFO - Epoch 42/59 (2.6s) - Train Loss: 0.3870, Train Dice: 0.7508, Val Loss: 0.4557, Val Dice: 0.4489, Val IoU: 0.3456
2025-07-22 20:16:05 - src.training.trainer - INFO - Epoch 43/59 (2.6s) - Train Loss: 0.3837, Train Dice: 0.7643, Val Loss: 0.4440, Val Dice: 0.4907, Val IoU: 0.3945
2025-07-22 20:16:07 - src.training.trainer - INFO - Epoch 44/59 (2.6s) - Train Loss: 0.3781, Train Dice: 0.7455, Val Loss: 0.4644, Val Dice: 0.4020, Val IoU: 0.3166
2025-07-22 20:16:10 - src.training.trainer - INFO - Epoch 45/59 (2.6s) - Train Loss: 0.3715, Train Dice: 0.7678, Val Loss: 0.4909, Val Dice: 0.2421, Val IoU: 0.1918
2025-07-22 20:16:12 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_45.pth
2025-07-22 20:16:14 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.3735, Train Dice: 0.7837, Val Loss: 0.4661, Val Dice: 0.3627, Val IoU: 0.2879
2025-07-22 20:16:17 - src.training.trainer - INFO - Epoch 47/59 (2.6s) - Train Loss: 0.3720, Train Dice: 0.7346, Val Loss: 0.4464, Val Dice: 0.4568, Val IoU: 0.3666
2025-07-22 20:16:19 - src.training.trainer - INFO - Epoch 48/59 (2.6s) - Train Loss: 0.3623, Train Dice: 0.8013, Val Loss: 0.4404, Val Dice: 0.4632, Val IoU: 0.3740
2025-07-22 20:16:22 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.3606, Train Dice: 0.8039, Val Loss: 0.4420, Val Dice: 0.4540, Val IoU: 0.3576
2025-07-22 20:16:25 - src.training.trainer - INFO - Epoch 50/59 (2.6s) - Train Loss: 0.3631, Train Dice: 0.7693, Val Loss: 0.4501, Val Dice: 0.3950, Val IoU: 0.3213
2025-07-22 20:16:27 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_50.pth
2025-07-22 20:16:29 - src.training.trainer - INFO - Epoch 51/59 (2.6s) - Train Loss: 0.3512, Train Dice: 0.8068, Val Loss: 0.4587, Val Dice: 0.3643, Val IoU: 0.2853
2025-07-22 20:16:32 - src.training.trainer - INFO - Epoch 52/59 (2.6s) - Train Loss: 0.3533, Train Dice: 0.7936, Val Loss: 0.4433, Val Dice: 0.4131, Val IoU: 0.3362
2025-07-22 20:16:35 - src.training.trainer - INFO - Epoch 53/59 (2.6s) - Train Loss: 0.3439, Train Dice: 0.8232, Val Loss: 0.4359, Val Dice: 0.4459, Val IoU: 0.3611
2025-07-22 20:16:37 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.3438, Train Dice: 0.8317, Val Loss: 0.4332, Val Dice: 0.4547, Val IoU: 0.3669
2025-07-22 20:16:40 - src.training.trainer - INFO - Epoch 55/59 (2.6s) - Train Loss: 0.3442, Train Dice: 0.8389, Val Loss: 0.4320, Val Dice: 0.4668, Val IoU: 0.3739
2025-07-22 20:16:41 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/checkpoint_epoch_55.pth
2025-07-22 20:16:44 - src.training.trainer - INFO - Epoch 56/59 (2.6s) - Train Loss: 0.3429, Train Dice: 0.8290, Val Loss: 0.4384, Val Dice: 0.4404, Val IoU: 0.3551
2025-07-22 20:16:47 - src.training.trainer - INFO - Epoch 57/59 (2.6s) - Train Loss: 0.3399, Train Dice: 0.8320, Val Loss: 0.4425, Val Dice: 0.4144, Val IoU: 0.3347
2025-07-22 20:16:49 - src.training.trainer - INFO - Epoch 58/59 (2.6s) - Train Loss: 0.3376, Train Dice: 0.8198, Val Loss: 0.4435, Val Dice: 0.4043, Val IoU: 0.3249
2025-07-22 20:16:52 - src.training.trainer - INFO - Epoch 59/59 (2.6s) - Train Loss: 0.3376, Train Dice: 0.8466, Val Loss: 0.4383, Val Dice: 0.4348, Val IoU: 0.3482
2025-07-22 20:16:54 - src.training.trainer - INFO - Saved checkpoint to experiments/sharpen/final_model.pth
2025-07-22 20:16:56 - src.visualization.visualize - INFO - Saved training history to experiments/sharpen/training_history.png
2025-07-22 20:16:56 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:16:59 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:16:59 - src.evaluation.metrics - INFO -   Dice: 36.42%
2025-07-22 20:16:59 - src.evaluation.metrics - INFO -   IoU: 26.36%
2025-07-22 20:16:59 - src.evaluation.metrics - INFO -   Pixel Accuracy: 97.00%
2025-07-22 20:17:00 - src.visualization.visualize - INFO - Saved visualization to experiments/sharpen/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:17:00 - src.visualization.visualize - INFO - Saved visualization to experiments/sharpen/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:17:01 - src.visualization.visualize - INFO - Saved visualization to experiments/sharpen/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:17:01 - src.visualization.visualize - INFO - Saved visualization to experiments/sharpen/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:17:02 - src.visualization.visualize - INFO - Saved visualization to experiments/sharpen/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:17:02 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:17:02 - src.training.experiment - INFO - Test Dice: 36.42%
2025-07-22 20:17:02 - src.training.experiment - INFO - Test IoU: 26.36%
2025-07-22 20:17:02 - src.training.experiment - INFO - Test Pixel Accuracy: 97.00%
2025-07-22 20:17:02 - root - INFO - 
============================================================
2025-07-22 20:17:02 - root - INFO - Running experiment: normalize
2025-07-22 20:17:02 - root - INFO - ============================================================

2025-07-22 20:17:02 - src.training.experiment - INFO - Starting experiment: normalize
2025-07-22 20:17:02 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:17:02 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:17:02 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:17:02 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:17:02 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:17:02 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:17:02 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:17:02 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:17:05 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:17:05 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:17:08 - src.training.trainer - INFO - Epoch 0/59 (2.6s) - Train Loss: 0.8036, Train Dice: 0.0578, Val Loss: 0.8078, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:10 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_0.pth
2025-07-22 20:17:12 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.7284, Train Dice: 0.1195, Val Loss: 0.8093, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:15 - src.training.trainer - INFO - Epoch 2/59 (2.6s) - Train Loss: 0.6870, Train Dice: 0.0494, Val Loss: 0.8131, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:17 - src.training.trainer - INFO - Epoch 3/59 (2.6s) - Train Loss: 0.6632, Train Dice: 0.0822, Val Loss: 0.8009, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:20 - src.training.trainer - INFO - Epoch 4/59 (2.6s) - Train Loss: 0.6486, Train Dice: 0.1322, Val Loss: 0.7880, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:23 - src.training.trainer - INFO - Epoch 5/59 (2.5s) - Train Loss: 0.6404, Train Dice: 0.1728, Val Loss: 0.8238, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:24 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_5.pth
2025-07-22 20:17:27 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.6288, Train Dice: 0.2320, Val Loss: 0.8107, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:30 - src.training.trainer - INFO - Epoch 7/59 (2.6s) - Train Loss: 0.6194, Train Dice: 0.3320, Val Loss: 0.8343, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:32 - src.training.trainer - INFO - Epoch 8/59 (2.6s) - Train Loss: 0.6122, Train Dice: 0.3678, Val Loss: 0.8021, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:35 - src.training.trainer - INFO - Epoch 9/59 (2.6s) - Train Loss: 0.6085, Train Dice: 0.3963, Val Loss: 0.8081, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:37 - src.training.trainer - INFO - Epoch 10/59 (2.6s) - Train Loss: 0.6013, Train Dice: 0.4459, Val Loss: 0.8210, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:39 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_10.pth
2025-07-22 20:17:42 - src.training.trainer - INFO - Epoch 11/59 (2.7s) - Train Loss: 0.5966, Train Dice: 0.4635, Val Loss: 0.8348, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:44 - src.training.trainer - INFO - Epoch 12/59 (2.6s) - Train Loss: 0.5885, Train Dice: 0.4687, Val Loss: 0.8588, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:17:47 - src.training.trainer - INFO - Epoch 13/59 (2.6s) - Train Loss: 0.5812, Train Dice: 0.5018, Val Loss: 0.8258, Val Dice: 0.0142, Val IoU: 0.0073
2025-07-22 20:17:49 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:17:49 - src.training.trainer - INFO - New best model! Dice: 0.0142
2025-07-22 20:17:51 - src.training.trainer - INFO - Epoch 14/59 (2.6s) - Train Loss: 0.5775, Train Dice: 0.5153, Val Loss: 0.8337, Val Dice: 0.0231, Val IoU: 0.0121
2025-07-22 20:17:53 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:17:53 - src.training.trainer - INFO - New best model! Dice: 0.0231
2025-07-22 20:17:56 - src.training.trainer - INFO - Epoch 15/59 (2.6s) - Train Loss: 0.5725, Train Dice: 0.5308, Val Loss: 0.8616, Val Dice: 0.0334, Val IoU: 0.0176
2025-07-22 20:17:58 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:17:58 - src.training.trainer - INFO - New best model! Dice: 0.0334
2025-07-22 20:17:59 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_15.pth
2025-07-22 20:18:02 - src.training.trainer - INFO - Epoch 16/59 (2.6s) - Train Loss: 0.5689, Train Dice: 0.5324, Val Loss: 0.9108, Val Dice: 0.0488, Val IoU: 0.0256
2025-07-22 20:18:04 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:18:04 - src.training.trainer - INFO - New best model! Dice: 0.0488
2025-07-22 20:18:06 - src.training.trainer - INFO - Epoch 17/59 (2.5s) - Train Loss: 0.5640, Train Dice: 0.5386, Val Loss: 0.7040, Val Dice: 0.0439, Val IoU: 0.0256
2025-07-22 20:18:09 - src.training.trainer - INFO - Epoch 18/59 (2.6s) - Train Loss: 0.5557, Train Dice: 0.5849, Val Loss: 0.9581, Val Dice: 0.0671, Val IoU: 0.0352
2025-07-22 20:18:11 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:18:11 - src.training.trainer - INFO - New best model! Dice: 0.0671
2025-07-22 20:18:13 - src.training.trainer - INFO - Epoch 19/59 (2.5s) - Train Loss: 0.5589, Train Dice: 0.5074, Val Loss: 0.8818, Val Dice: 0.0558, Val IoU: 0.0293
2025-07-22 20:18:16 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.5527, Train Dice: 0.5528, Val Loss: 0.7140, Val Dice: 0.1568, Val IoU: 0.0867
2025-07-22 20:18:18 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:18:18 - src.training.trainer - INFO - New best model! Dice: 0.1568
2025-07-22 20:18:20 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_20.pth
2025-07-22 20:18:22 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.5449, Train Dice: 0.6027, Val Loss: 0.7830, Val Dice: 0.1355, Val IoU: 0.0743
2025-07-22 20:18:25 - src.training.trainer - INFO - Epoch 22/59 (2.6s) - Train Loss: 0.5488, Train Dice: 0.5527, Val Loss: 0.6232, Val Dice: 0.2822, Val IoU: 0.1724
2025-07-22 20:18:27 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:18:27 - src.training.trainer - INFO - New best model! Dice: 0.2822
2025-07-22 20:18:29 - src.training.trainer - INFO - Epoch 23/59 (2.6s) - Train Loss: 0.5387, Train Dice: 0.6227, Val Loss: 0.6737, Val Dice: 0.2105, Val IoU: 0.1233
2025-07-22 20:18:32 - src.training.trainer - INFO - Epoch 24/59 (2.6s) - Train Loss: 0.5424, Train Dice: 0.5633, Val Loss: 0.7616, Val Dice: 0.0792, Val IoU: 0.0443
2025-07-22 20:18:35 - src.training.trainer - INFO - Epoch 25/59 (2.6s) - Train Loss: 0.5311, Train Dice: 0.6394, Val Loss: 0.7888, Val Dice: 0.1466, Val IoU: 0.0808
2025-07-22 20:18:36 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_25.pth
2025-07-22 20:18:39 - src.training.trainer - INFO - Epoch 26/59 (2.6s) - Train Loss: 0.5283, Train Dice: 0.6166, Val Loss: 0.9827, Val Dice: 0.0655, Val IoU: 0.0348
2025-07-22 20:18:42 - src.training.trainer - INFO - Epoch 27/59 (2.6s) - Train Loss: 0.5281, Train Dice: 0.6535, Val Loss: 0.7360, Val Dice: 0.1738, Val IoU: 0.0994
2025-07-22 20:18:44 - src.training.trainer - INFO - Epoch 28/59 (2.6s) - Train Loss: 0.5266, Train Dice: 0.5902, Val Loss: 0.5902, Val Dice: 0.4056, Val IoU: 0.2735
2025-07-22 20:18:46 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:18:46 - src.training.trainer - INFO - New best model! Dice: 0.4056
2025-07-22 20:18:49 - src.training.trainer - INFO - Epoch 29/59 (2.5s) - Train Loss: 0.5235, Train Dice: 0.6345, Val Loss: 0.7101, Val Dice: 0.1682, Val IoU: 0.0959
2025-07-22 20:18:51 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.5202, Train Dice: 0.6507, Val Loss: 0.8807, Val Dice: 0.1169, Val IoU: 0.0631
2025-07-22 20:18:53 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_30.pth
2025-07-22 20:18:56 - src.training.trainer - INFO - Epoch 31/59 (2.7s) - Train Loss: 0.5185, Train Dice: 0.6521, Val Loss: 0.8005, Val Dice: 0.1607, Val IoU: 0.0897
2025-07-22 20:18:58 - src.training.trainer - INFO - Epoch 32/59 (2.6s) - Train Loss: 0.5117, Train Dice: 0.6781, Val Loss: 0.6055, Val Dice: 0.3647, Val IoU: 0.2387
2025-07-22 20:19:17 - src.training.trainer - INFO - Epoch 33/59 (19.1s) - Train Loss: 0.5085, Train Dice: 0.7015, Val Loss: 0.5597, Val Dice: 0.5072, Val IoU: 0.3735
2025-07-22 20:19:19 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:19:19 - src.training.trainer - INFO - New best model! Dice: 0.5072
2025-07-22 20:19:22 - src.training.trainer - INFO - Epoch 34/59 (2.5s) - Train Loss: 0.5051, Train Dice: 0.7062, Val Loss: 0.5771, Val Dice: 0.4436, Val IoU: 0.3368
2025-07-22 20:19:24 - src.training.trainer - INFO - Epoch 35/59 (2.5s) - Train Loss: 0.5041, Train Dice: 0.7202, Val Loss: 0.5887, Val Dice: 0.3046, Val IoU: 0.2281
2025-07-22 20:19:26 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_35.pth
2025-07-22 20:19:29 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.4999, Train Dice: 0.7290, Val Loss: 0.5432, Val Dice: 0.5669, Val IoU: 0.4343
2025-07-22 20:19:30 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:19:30 - src.training.trainer - INFO - New best model! Dice: 0.5669
2025-07-22 20:19:33 - src.training.trainer - INFO - Epoch 37/59 (2.6s) - Train Loss: 0.5006, Train Dice: 0.7184, Val Loss: 0.5663, Val Dice: 0.4681, Val IoU: 0.3527
2025-07-22 20:19:36 - src.training.trainer - INFO - Epoch 38/59 (2.6s) - Train Loss: 0.4966, Train Dice: 0.7365, Val Loss: 0.6424, Val Dice: 0.2300, Val IoU: 0.1488
2025-07-22 20:19:38 - src.training.trainer - INFO - Epoch 39/59 (2.6s) - Train Loss: 0.4964, Train Dice: 0.7286, Val Loss: 0.6270, Val Dice: 0.1804, Val IoU: 0.1308
2025-07-22 20:19:41 - src.training.trainer - INFO - Epoch 40/59 (2.6s) - Train Loss: 0.4948, Train Dice: 0.7463, Val Loss: 0.5760, Val Dice: 0.3083, Val IoU: 0.2233
2025-07-22 20:19:43 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_40.pth
2025-07-22 20:19:45 - src.training.trainer - INFO - Epoch 41/59 (2.6s) - Train Loss: 0.4922, Train Dice: 0.7345, Val Loss: 0.5744, Val Dice: 0.2374, Val IoU: 0.1845
2025-07-22 20:19:48 - src.training.trainer - INFO - Epoch 42/59 (2.6s) - Train Loss: 0.4954, Train Dice: 0.7662, Val Loss: 0.5433, Val Dice: 0.5210, Val IoU: 0.4076
2025-07-22 20:19:50 - src.training.trainer - INFO - Epoch 43/59 (2.6s) - Train Loss: 0.4975, Train Dice: 0.6396, Val Loss: 0.5341, Val Dice: 0.5177, Val IoU: 0.4029
2025-07-22 20:19:53 - src.training.trainer - INFO - Epoch 44/59 (2.6s) - Train Loss: 0.4868, Train Dice: 0.7449, Val Loss: 0.5368, Val Dice: 0.4388, Val IoU: 0.3370
2025-07-22 20:19:55 - src.training.trainer - INFO - Epoch 45/59 (2.6s) - Train Loss: 0.4861, Train Dice: 0.7828, Val Loss: 0.5283, Val Dice: 0.5118, Val IoU: 0.3994
2025-07-22 20:19:57 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_45.pth
2025-07-22 20:20:00 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.4817, Train Dice: 0.7726, Val Loss: 0.5184, Val Dice: 0.6162, Val IoU: 0.4718
2025-07-22 20:20:02 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:20:02 - src.training.trainer - INFO - New best model! Dice: 0.6162
2025-07-22 20:20:04 - src.training.trainer - INFO - Epoch 47/59 (2.6s) - Train Loss: 0.4840, Train Dice: 0.7337, Val Loss: 0.5156, Val Dice: 0.6297, Val IoU: 0.4796
2025-07-22 20:20:06 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/best_model.pth
2025-07-22 20:20:06 - src.training.trainer - INFO - New best model! Dice: 0.6297
2025-07-22 20:20:09 - src.training.trainer - INFO - Epoch 48/59 (2.5s) - Train Loss: 0.4809, Train Dice: 0.7739, Val Loss: 0.5249, Val Dice: 0.5475, Val IoU: 0.4115
2025-07-22 20:20:12 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.4800, Train Dice: 0.7901, Val Loss: 0.5224, Val Dice: 0.5291, Val IoU: 0.4106
2025-07-22 20:20:14 - src.training.trainer - INFO - Epoch 50/59 (2.5s) - Train Loss: 0.4798, Train Dice: 0.7520, Val Loss: 0.5153, Val Dice: 0.5599, Val IoU: 0.4205
2025-07-22 20:20:16 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_50.pth
2025-07-22 20:20:19 - src.training.trainer - INFO - Epoch 51/59 (2.6s) - Train Loss: 0.4735, Train Dice: 0.7944, Val Loss: 0.5160, Val Dice: 0.5432, Val IoU: 0.4029
2025-07-22 20:20:21 - src.training.trainer - INFO - Epoch 52/59 (2.6s) - Train Loss: 0.4721, Train Dice: 0.8022, Val Loss: 0.5132, Val Dice: 0.5656, Val IoU: 0.4330
2025-07-22 20:20:24 - src.training.trainer - INFO - Epoch 53/59 (2.6s) - Train Loss: 0.4706, Train Dice: 0.8016, Val Loss: 0.5175, Val Dice: 0.5277, Val IoU: 0.4144
2025-07-22 20:20:26 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.4691, Train Dice: 0.8110, Val Loss: 0.5167, Val Dice: 0.5315, Val IoU: 0.4183
2025-07-22 20:20:29 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.4672, Train Dice: 0.8331, Val Loss: 0.5144, Val Dice: 0.5444, Val IoU: 0.4280
2025-07-22 20:20:31 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/checkpoint_epoch_55.pth
2025-07-22 20:20:33 - src.training.trainer - INFO - Epoch 56/59 (2.6s) - Train Loss: 0.4682, Train Dice: 0.8170, Val Loss: 0.5114, Val Dice: 0.5497, Val IoU: 0.4292
2025-07-22 20:20:36 - src.training.trainer - INFO - Epoch 57/59 (2.6s) - Train Loss: 0.4670, Train Dice: 0.8238, Val Loss: 0.5088, Val Dice: 0.5521, Val IoU: 0.4309
2025-07-22 20:20:39 - src.training.trainer - INFO - Epoch 58/59 (2.6s) - Train Loss: 0.4661, Train Dice: 0.8255, Val Loss: 0.5098, Val Dice: 0.5416, Val IoU: 0.4234
2025-07-22 20:20:41 - src.training.trainer - INFO - Epoch 59/59 (2.6s) - Train Loss: 0.4664, Train Dice: 0.8240, Val Loss: 0.5120, Val Dice: 0.5139, Val IoU: 0.4008
2025-07-22 20:20:43 - src.training.trainer - INFO - Saved checkpoint to experiments/normalize/final_model.pth
2025-07-22 20:20:46 - src.visualization.visualize - INFO - Saved training history to experiments/normalize/training_history.png
2025-07-22 20:20:46 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:20:49 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:20:49 - src.evaluation.metrics - INFO -   Dice: 36.63%
2025-07-22 20:20:49 - src.evaluation.metrics - INFO -   IoU: 26.89%
2025-07-22 20:20:49 - src.evaluation.metrics - INFO -   Pixel Accuracy: 96.98%
2025-07-22 20:20:50 - src.visualization.visualize - INFO - Saved visualization to experiments/normalize/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:20:51 - src.visualization.visualize - INFO - Saved visualization to experiments/normalize/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:20:51 - src.visualization.visualize - INFO - Saved visualization to experiments/normalize/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:20:51 - src.visualization.visualize - INFO - Saved visualization to experiments/normalize/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:20:52 - src.visualization.visualize - INFO - Saved visualization to experiments/normalize/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:20:52 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:20:52 - src.training.experiment - INFO - Test Dice: 36.63%
2025-07-22 20:20:52 - src.training.experiment - INFO - Test IoU: 26.89%
2025-07-22 20:20:52 - src.training.experiment - INFO - Test Pixel Accuracy: 96.98%
2025-07-22 20:20:52 - root - INFO - 
============================================================
2025-07-22 20:20:52 - root - INFO - Running experiment: augmentation
2025-07-22 20:20:52 - root - INFO - ============================================================

2025-07-22 20:20:52 - src.training.experiment - INFO - Starting experiment: augmentation
2025-07-22 20:20:52 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:20:52 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:20:52 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:20:52 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:20:52 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:20:52 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:20:52 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:20:52 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:20:56 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:20:56 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:20:59 - src.training.trainer - INFO - Epoch 0/59 (2.5s) - Train Loss: 0.8157, Train Dice: 0.0529, Val Loss: 0.8376, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:00 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_0.pth
2025-07-22 20:21:03 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.7459, Train Dice: 0.0293, Val Loss: 0.8339, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:06 - src.training.trainer - INFO - Epoch 2/59 (2.6s) - Train Loss: 0.7035, Train Dice: 0.0569, Val Loss: 0.8297, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:08 - src.training.trainer - INFO - Epoch 3/59 (2.6s) - Train Loss: 0.6839, Train Dice: 0.0490, Val Loss: 0.8073, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:11 - src.training.trainer - INFO - Epoch 4/59 (2.6s) - Train Loss: 0.6669, Train Dice: 0.0645, Val Loss: 0.7902, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:13 - src.training.trainer - INFO - Epoch 5/59 (2.6s) - Train Loss: 0.6600, Train Dice: 0.0745, Val Loss: 0.8004, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:15 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_5.pth
2025-07-22 20:21:18 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.6506, Train Dice: 0.0787, Val Loss: 0.7355, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:20 - src.training.trainer - INFO - Epoch 7/59 (2.6s) - Train Loss: 0.6433, Train Dice: 0.0763, Val Loss: 0.7026, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:23 - src.training.trainer - INFO - Epoch 8/59 (2.6s) - Train Loss: 0.6367, Train Dice: 0.1265, Val Loss: 0.7125, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:25 - src.training.trainer - INFO - Epoch 9/59 (2.6s) - Train Loss: 0.6315, Train Dice: 0.1966, Val Loss: 0.7073, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:28 - src.training.trainer - INFO - Epoch 10/59 (2.6s) - Train Loss: 0.6240, Train Dice: 0.2409, Val Loss: 0.7044, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:30 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_10.pth
2025-07-22 20:21:32 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.6171, Train Dice: 0.2944, Val Loss: 0.7403, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:35 - src.training.trainer - INFO - Epoch 12/59 (2.6s) - Train Loss: 0.6127, Train Dice: 0.3201, Val Loss: 0.7742, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:38 - src.training.trainer - INFO - Epoch 13/59 (2.6s) - Train Loss: 0.6086, Train Dice: 0.3603, Val Loss: 0.7407, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:40 - src.training.trainer - INFO - Epoch 14/59 (2.6s) - Train Loss: 0.6025, Train Dice: 0.3825, Val Loss: 0.7235, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:43 - src.training.trainer - INFO - Epoch 15/59 (2.6s) - Train Loss: 0.6015, Train Dice: 0.3886, Val Loss: 0.7845, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:45 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_15.pth
2025-07-22 20:21:47 - src.training.trainer - INFO - Epoch 16/59 (2.7s) - Train Loss: 0.5976, Train Dice: 0.4305, Val Loss: 0.7900, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:50 - src.training.trainer - INFO - Epoch 17/59 (2.6s) - Train Loss: 0.5936, Train Dice: 0.4665, Val Loss: 0.7614, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:52 - src.training.trainer - INFO - Epoch 18/59 (2.6s) - Train Loss: 0.5874, Train Dice: 0.4861, Val Loss: 0.7611, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:21:54 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:21:54 - src.training.trainer - INFO - New best model! Dice: 0.0000
2025-07-22 20:21:57 - src.training.trainer - INFO - Epoch 19/59 (2.7s) - Train Loss: 0.5870, Train Dice: 0.4535, Val Loss: 0.7980, Val Dice: 0.0313, Val IoU: 0.0166
2025-07-22 20:21:59 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:21:59 - src.training.trainer - INFO - New best model! Dice: 0.0313
2025-07-22 20:22:01 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.5831, Train Dice: 0.4568, Val Loss: 0.7930, Val Dice: 0.0667, Val IoU: 0.0355
2025-07-22 20:22:03 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:22:03 - src.training.trainer - INFO - New best model! Dice: 0.0667
2025-07-22 20:22:05 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_20.pth
2025-07-22 20:22:08 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.5801, Train Dice: 0.4461, Val Loss: 0.7509, Val Dice: 0.0967, Val IoU: 0.0521
2025-07-22 20:22:09 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:22:09 - src.training.trainer - INFO - New best model! Dice: 0.0967
2025-07-22 20:22:12 - src.training.trainer - INFO - Epoch 22/59 (2.5s) - Train Loss: 0.5759, Train Dice: 0.4560, Val Loss: 0.6853, Val Dice: 0.2148, Val IoU: 0.1255
2025-07-22 20:22:14 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:22:14 - src.training.trainer - INFO - New best model! Dice: 0.2148
2025-07-22 20:22:16 - src.training.trainer - INFO - Epoch 23/59 (2.6s) - Train Loss: 0.5743, Train Dice: 0.4415, Val Loss: 0.6309, Val Dice: 0.3096, Val IoU: 0.1925
2025-07-22 20:22:18 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:22:18 - src.training.trainer - INFO - New best model! Dice: 0.3096
2025-07-22 20:22:21 - src.training.trainer - INFO - Epoch 24/59 (2.6s) - Train Loss: 0.5739, Train Dice: 0.4343, Val Loss: 0.5927, Val Dice: 0.4543, Val IoU: 0.3248
2025-07-22 20:22:23 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:22:23 - src.training.trainer - INFO - New best model! Dice: 0.4543
2025-07-22 20:22:25 - src.training.trainer - INFO - Epoch 25/59 (2.6s) - Train Loss: 0.5688, Train Dice: 0.4795, Val Loss: 0.6018, Val Dice: 0.4461, Val IoU: 0.3096
2025-07-22 20:22:27 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_25.pth
2025-07-22 20:22:30 - src.training.trainer - INFO - Epoch 26/59 (2.6s) - Train Loss: 0.5620, Train Dice: 0.4665, Val Loss: 0.6184, Val Dice: 0.3624, Val IoU: 0.2311
2025-07-22 20:22:32 - src.training.trainer - INFO - Epoch 27/59 (2.6s) - Train Loss: 0.5592, Train Dice: 0.4616, Val Loss: 0.6905, Val Dice: 0.2039, Val IoU: 0.1164
2025-07-22 20:22:35 - src.training.trainer - INFO - Epoch 28/59 (2.6s) - Train Loss: 0.5589, Train Dice: 0.5307, Val Loss: 0.7490, Val Dice: 0.1725, Val IoU: 0.0971
2025-07-22 20:22:37 - src.training.trainer - INFO - Epoch 29/59 (2.6s) - Train Loss: 0.5528, Train Dice: 0.4876, Val Loss: 0.8167, Val Dice: 0.1547, Val IoU: 0.0868
2025-07-22 20:22:40 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.5511, Train Dice: 0.5146, Val Loss: 0.7787, Val Dice: 0.1655, Val IoU: 0.0927
2025-07-22 20:22:42 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_30.pth
2025-07-22 20:22:44 - src.training.trainer - INFO - Epoch 31/59 (2.6s) - Train Loss: 0.5424, Train Dice: 0.5510, Val Loss: 0.7268, Val Dice: 0.1893, Val IoU: 0.1075
2025-07-22 20:22:47 - src.training.trainer - INFO - Epoch 32/59 (2.6s) - Train Loss: 0.5456, Train Dice: 0.5485, Val Loss: 0.7092, Val Dice: 0.2126, Val IoU: 0.1226
2025-07-22 20:23:00 - src.training.trainer - INFO - Epoch 33/59 (12.9s) - Train Loss: 0.5404, Train Dice: 0.5468, Val Loss: 0.7159, Val Dice: 0.2088, Val IoU: 0.1200
2025-07-22 20:23:02 - src.training.trainer - INFO - Epoch 34/59 (2.6s) - Train Loss: 0.5441, Train Dice: 0.5108, Val Loss: 0.6440, Val Dice: 0.2797, Val IoU: 0.1674
2025-07-22 20:23:05 - src.training.trainer - INFO - Epoch 35/59 (2.6s) - Train Loss: 0.5436, Train Dice: 0.5508, Val Loss: 0.6083, Val Dice: 0.3212, Val IoU: 0.1984
2025-07-22 20:23:07 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_35.pth
2025-07-22 20:23:09 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.5371, Train Dice: 0.5539, Val Loss: 0.5718, Val Dice: 0.4233, Val IoU: 0.2915
2025-07-22 20:23:12 - src.training.trainer - INFO - Epoch 37/59 (2.5s) - Train Loss: 0.5384, Train Dice: 0.5591, Val Loss: 0.5531, Val Dice: 0.5177, Val IoU: 0.3890
2025-07-22 20:23:14 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:23:14 - src.training.trainer - INFO - New best model! Dice: 0.5177
2025-07-22 20:23:16 - src.training.trainer - INFO - Epoch 38/59 (2.6s) - Train Loss: 0.5379, Train Dice: 0.5590, Val Loss: 0.5454, Val Dice: 0.5675, Val IoU: 0.4307
2025-07-22 20:23:18 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:23:18 - src.training.trainer - INFO - New best model! Dice: 0.5675
2025-07-22 20:23:21 - src.training.trainer - INFO - Epoch 39/59 (2.6s) - Train Loss: 0.5394, Train Dice: 0.5599, Val Loss: 0.5426, Val Dice: 0.5714, Val IoU: 0.4299
2025-07-22 20:23:23 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/best_model.pth
2025-07-22 20:23:23 - src.training.trainer - INFO - New best model! Dice: 0.5714
2025-07-22 20:23:25 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.5402, Train Dice: 0.5375, Val Loss: 0.5426, Val Dice: 0.5635, Val IoU: 0.4203
2025-07-22 20:23:27 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_40.pth
2025-07-22 20:23:30 - src.training.trainer - INFO - Epoch 41/59 (2.7s) - Train Loss: 0.5381, Train Dice: 0.5798, Val Loss: 0.5487, Val Dice: 0.5114, Val IoU: 0.3715
2025-07-22 20:23:32 - src.training.trainer - INFO - Epoch 42/59 (2.6s) - Train Loss: 0.5373, Train Dice: 0.5353, Val Loss: 0.5545, Val Dice: 0.4704, Val IoU: 0.3334
2025-07-22 20:23:35 - src.training.trainer - INFO - Epoch 43/59 (2.6s) - Train Loss: 0.5326, Train Dice: 0.5513, Val Loss: 0.5461, Val Dice: 0.5247, Val IoU: 0.3773
2025-07-22 20:23:38 - src.training.trainer - INFO - Epoch 44/59 (2.6s) - Train Loss: 0.5332, Train Dice: 0.5768, Val Loss: 0.5436, Val Dice: 0.5357, Val IoU: 0.3856
2025-07-22 20:23:40 - src.training.trainer - INFO - Epoch 45/59 (2.6s) - Train Loss: 0.5361, Train Dice: 0.5576, Val Loss: 0.5419, Val Dice: 0.5392, Val IoU: 0.3898
2025-07-22 20:23:42 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_45.pth
2025-07-22 20:23:45 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.5300, Train Dice: 0.5998, Val Loss: 0.5418, Val Dice: 0.5304, Val IoU: 0.3835
2025-07-22 20:23:47 - src.training.trainer - INFO - Epoch 47/59 (2.7s) - Train Loss: 0.5314, Train Dice: 0.5791, Val Loss: 0.5413, Val Dice: 0.5304, Val IoU: 0.3833
2025-07-22 20:23:50 - src.training.trainer - INFO - Epoch 48/59 (2.6s) - Train Loss: 0.5345, Train Dice: 0.5622, Val Loss: 0.5386, Val Dice: 0.5458, Val IoU: 0.3974
2025-07-22 20:23:53 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.5360, Train Dice: 0.5183, Val Loss: 0.5363, Val Dice: 0.5588, Val IoU: 0.4108
2025-07-22 20:23:55 - src.training.trainer - INFO - Epoch 50/59 (2.5s) - Train Loss: 0.5318, Train Dice: 0.6037, Val Loss: 0.5367, Val Dice: 0.5587, Val IoU: 0.4117
2025-07-22 20:23:57 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_50.pth
2025-07-22 20:24:00 - src.training.trainer - INFO - Epoch 51/59 (2.6s) - Train Loss: 0.5303, Train Dice: 0.5937, Val Loss: 0.5371, Val Dice: 0.5578, Val IoU: 0.4124
2025-07-22 20:24:02 - src.training.trainer - INFO - Epoch 52/59 (2.6s) - Train Loss: 0.5286, Train Dice: 0.5926, Val Loss: 0.5378, Val Dice: 0.5530, Val IoU: 0.4080
2025-07-22 20:24:05 - src.training.trainer - INFO - Epoch 53/59 (2.6s) - Train Loss: 0.5325, Train Dice: 0.5599, Val Loss: 0.5389, Val Dice: 0.5457, Val IoU: 0.4004
2025-07-22 20:24:07 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.5289, Train Dice: 0.5895, Val Loss: 0.5393, Val Dice: 0.5409, Val IoU: 0.3959
2025-07-22 20:24:10 - src.training.trainer - INFO - Epoch 55/59 (2.6s) - Train Loss: 0.5314, Train Dice: 0.5570, Val Loss: 0.5394, Val Dice: 0.5388, Val IoU: 0.3940
2025-07-22 20:24:12 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/checkpoint_epoch_55.pth
2025-07-22 20:24:14 - src.training.trainer - INFO - Epoch 56/59 (2.6s) - Train Loss: 0.5280, Train Dice: 0.6108, Val Loss: 0.5387, Val Dice: 0.5419, Val IoU: 0.3971
2025-07-22 20:24:17 - src.training.trainer - INFO - Epoch 57/59 (2.6s) - Train Loss: 0.5259, Train Dice: 0.5863, Val Loss: 0.5375, Val Dice: 0.5499, Val IoU: 0.4055
2025-07-22 20:24:20 - src.training.trainer - INFO - Epoch 58/59 (2.6s) - Train Loss: 0.5288, Train Dice: 0.5756, Val Loss: 0.5364, Val Dice: 0.5526, Val IoU: 0.4085
2025-07-22 20:24:22 - src.training.trainer - INFO - Epoch 59/59 (2.5s) - Train Loss: 0.5342, Train Dice: 0.5549, Val Loss: 0.5357, Val Dice: 0.5548, Val IoU: 0.4107
2025-07-22 20:24:24 - src.training.trainer - INFO - Saved checkpoint to experiments/augmentation/final_model.pth
2025-07-22 20:24:27 - src.visualization.visualize - INFO - Saved training history to experiments/augmentation/training_history.png
2025-07-22 20:24:27 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:24:29 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:24:29 - src.evaluation.metrics - INFO -   Dice: 59.66%
2025-07-22 20:24:29 - src.evaluation.metrics - INFO -   IoU: 47.34%
2025-07-22 20:24:29 - src.evaluation.metrics - INFO -   Pixel Accuracy: 97.63%
2025-07-22 20:24:29 - src.visualization.visualize - INFO - Saved visualization to experiments/augmentation/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:24:30 - src.visualization.visualize - INFO - Saved visualization to experiments/augmentation/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:24:30 - src.visualization.visualize - INFO - Saved visualization to experiments/augmentation/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:24:31 - src.visualization.visualize - INFO - Saved visualization to experiments/augmentation/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:24:31 - src.visualization.visualize - INFO - Saved visualization to experiments/augmentation/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:24:31 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:24:31 - src.training.experiment - INFO - Test Dice: 59.66%
2025-07-22 20:24:31 - src.training.experiment - INFO - Test IoU: 47.34%
2025-07-22 20:24:31 - src.training.experiment - INFO - Test Pixel Accuracy: 97.63%
2025-07-22 20:24:31 - root - INFO - 
============================================================
2025-07-22 20:24:31 - root - INFO - Running experiment: optimizer_sgd
2025-07-22 20:24:31 - root - INFO - ============================================================

2025-07-22 20:24:31 - src.training.experiment - INFO - Starting experiment: optimizer_sgd
2025-07-22 20:24:31 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:24:31 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:24:31 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:24:31 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:24:31 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:24:31 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:24:31 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:24:31 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:24:34 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:24:34 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:24:37 - src.training.trainer - INFO - Epoch 0/59 (2.5s) - Train Loss: 0.8422, Train Dice: 0.0366, Val Loss: 0.8405, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:38 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_0.pth
2025-07-22 20:24:41 - src.training.trainer - INFO - Epoch 1/59 (2.6s) - Train Loss: 0.8395, Train Dice: 0.0357, Val Loss: 0.8424, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:43 - src.training.trainer - INFO - Epoch 2/59 (2.6s) - Train Loss: 0.8337, Train Dice: 0.0384, Val Loss: 0.8431, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:46 - src.training.trainer - INFO - Epoch 3/59 (2.6s) - Train Loss: 0.8256, Train Dice: 0.0427, Val Loss: 0.8425, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:48 - src.training.trainer - INFO - Epoch 4/59 (2.6s) - Train Loss: 0.8171, Train Dice: 0.0477, Val Loss: 0.8407, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:51 - src.training.trainer - INFO - Epoch 5/59 (2.6s) - Train Loss: 0.8087, Train Dice: 0.0567, Val Loss: 0.8375, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:52 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_5.pth
2025-07-22 20:24:55 - src.training.trainer - INFO - Epoch 6/59 (2.6s) - Train Loss: 0.7995, Train Dice: 0.0687, Val Loss: 0.8331, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:24:57 - src.training.trainer - INFO - Epoch 7/59 (2.6s) - Train Loss: 0.7910, Train Dice: 0.0843, Val Loss: 0.8290, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:00 - src.training.trainer - INFO - Epoch 8/59 (2.6s) - Train Loss: 0.7868, Train Dice: 0.0881, Val Loss: 0.8244, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:03 - src.training.trainer - INFO - Epoch 9/59 (2.6s) - Train Loss: 0.7822, Train Dice: 0.0967, Val Loss: 0.8200, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:05 - src.training.trainer - INFO - Epoch 10/59 (2.6s) - Train Loss: 0.7770, Train Dice: 0.1083, Val Loss: 0.8158, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:06 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_10.pth
2025-07-22 20:25:09 - src.training.trainer - INFO - Epoch 11/59 (2.6s) - Train Loss: 0.7724, Train Dice: 0.1148, Val Loss: 0.8118, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:11 - src.training.trainer - INFO - Epoch 12/59 (2.6s) - Train Loss: 0.7674, Train Dice: 0.1256, Val Loss: 0.8087, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:14 - src.training.trainer - INFO - Epoch 13/59 (2.6s) - Train Loss: 0.7632, Train Dice: 0.1347, Val Loss: 0.8077, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:17 - src.training.trainer - INFO - Epoch 14/59 (2.5s) - Train Loss: 0.7607, Train Dice: 0.1402, Val Loss: 0.8073, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:19 - src.training.trainer - INFO - Epoch 15/59 (2.5s) - Train Loss: 0.7583, Train Dice: 0.1448, Val Loss: 0.8068, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:20 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_15.pth
2025-07-22 20:25:23 - src.training.trainer - INFO - Epoch 16/59 (2.6s) - Train Loss: 0.7567, Train Dice: 0.1437, Val Loss: 0.8056, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:24 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/best_model.pth
2025-07-22 20:25:24 - src.training.trainer - INFO - New best model! Dice: 0.0000
2025-07-22 20:25:27 - src.training.trainer - INFO - Epoch 17/59 (2.6s) - Train Loss: 0.7540, Train Dice: 0.1474, Val Loss: 0.8037, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:28 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/best_model.pth
2025-07-22 20:25:28 - src.training.trainer - INFO - New best model! Dice: 0.0000
2025-07-22 20:25:31 - src.training.trainer - INFO - Epoch 18/59 (2.5s) - Train Loss: 0.7517, Train Dice: 0.1581, Val Loss: 0.8009, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:33 - src.training.trainer - INFO - Epoch 19/59 (2.6s) - Train Loss: 0.7497, Train Dice: 0.1599, Val Loss: 0.7974, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:35 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/best_model.pth
2025-07-22 20:25:35 - src.training.trainer - INFO - New best model! Dice: 0.0000
2025-07-22 20:25:37 - src.training.trainer - INFO - Epoch 20/59 (2.5s) - Train Loss: 0.7472, Train Dice: 0.1694, Val Loss: 0.7930, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:39 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_20.pth
2025-07-22 20:25:41 - src.training.trainer - INFO - Epoch 21/59 (2.6s) - Train Loss: 0.7444, Train Dice: 0.1729, Val Loss: 0.7878, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:42 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/best_model.pth
2025-07-22 20:25:42 - src.training.trainer - INFO - New best model! Dice: 0.0000
2025-07-22 20:25:45 - src.training.trainer - INFO - Epoch 22/59 (2.6s) - Train Loss: 0.7429, Train Dice: 0.1754, Val Loss: 0.7821, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:48 - src.training.trainer - INFO - Epoch 23/59 (2.6s) - Train Loss: 0.7397, Train Dice: 0.1841, Val Loss: 0.7760, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:50 - src.training.trainer - INFO - Epoch 24/59 (2.5s) - Train Loss: 0.7381, Train Dice: 0.1853, Val Loss: 0.7696, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:53 - src.training.trainer - INFO - Epoch 25/59 (2.6s) - Train Loss: 0.7356, Train Dice: 0.1904, Val Loss: 0.7639, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:54 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_25.pth
2025-07-22 20:25:57 - src.training.trainer - INFO - Epoch 26/59 (2.6s) - Train Loss: 0.7336, Train Dice: 0.1953, Val Loss: 0.7584, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:25:59 - src.training.trainer - INFO - Epoch 27/59 (2.6s) - Train Loss: 0.7324, Train Dice: 0.1915, Val Loss: 0.7538, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:02 - src.training.trainer - INFO - Epoch 28/59 (2.6s) - Train Loss: 0.7302, Train Dice: 0.2041, Val Loss: 0.7502, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:04 - src.training.trainer - INFO - Epoch 29/59 (2.6s) - Train Loss: 0.7289, Train Dice: 0.2002, Val Loss: 0.7468, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:07 - src.training.trainer - INFO - Epoch 30/59 (2.5s) - Train Loss: 0.7280, Train Dice: 0.1983, Val Loss: 0.7434, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:08 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_30.pth
2025-07-22 20:26:11 - src.training.trainer - INFO - Epoch 31/59 (2.7s) - Train Loss: 0.7265, Train Dice: 0.2090, Val Loss: 0.7404, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:13 - src.training.trainer - INFO - Epoch 32/59 (2.6s) - Train Loss: 0.7263, Train Dice: 0.2014, Val Loss: 0.7375, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:27 - src.training.trainer - INFO - Epoch 33/59 (14.1s) - Train Loss: 0.7247, Train Dice: 0.2140, Val Loss: 0.7346, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:30 - src.training.trainer - INFO - Epoch 34/59 (2.6s) - Train Loss: 0.7236, Train Dice: 0.2055, Val Loss: 0.7325, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:33 - src.training.trainer - INFO - Epoch 35/59 (2.6s) - Train Loss: 0.7221, Train Dice: 0.2158, Val Loss: 0.7305, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:34 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_35.pth
2025-07-22 20:26:36 - src.training.trainer - INFO - Epoch 36/59 (2.6s) - Train Loss: 0.7224, Train Dice: 0.2120, Val Loss: 0.7288, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:39 - src.training.trainer - INFO - Epoch 37/59 (2.6s) - Train Loss: 0.7218, Train Dice: 0.2211, Val Loss: 0.7271, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:42 - src.training.trainer - INFO - Epoch 38/59 (2.6s) - Train Loss: 0.7212, Train Dice: 0.2169, Val Loss: 0.7257, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:44 - src.training.trainer - INFO - Epoch 39/59 (2.6s) - Train Loss: 0.7210, Train Dice: 0.2169, Val Loss: 0.7243, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:47 - src.training.trainer - INFO - Epoch 40/59 (2.5s) - Train Loss: 0.7203, Train Dice: 0.2202, Val Loss: 0.7233, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:48 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_40.pth
2025-07-22 20:26:50 - src.training.trainer - INFO - Epoch 41/59 (2.6s) - Train Loss: 0.7209, Train Dice: 0.2066, Val Loss: 0.7225, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:53 - src.training.trainer - INFO - Epoch 42/59 (2.6s) - Train Loss: 0.7203, Train Dice: 0.2181, Val Loss: 0.7217, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:56 - src.training.trainer - INFO - Epoch 43/59 (2.6s) - Train Loss: 0.7197, Train Dice: 0.2179, Val Loss: 0.7212, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:26:58 - src.training.trainer - INFO - Epoch 44/59 (2.6s) - Train Loss: 0.7192, Train Dice: 0.2149, Val Loss: 0.7205, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:01 - src.training.trainer - INFO - Epoch 45/59 (2.6s) - Train Loss: 0.7195, Train Dice: 0.2197, Val Loss: 0.7200, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:02 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_45.pth
2025-07-22 20:27:05 - src.training.trainer - INFO - Epoch 46/59 (2.6s) - Train Loss: 0.7197, Train Dice: 0.2235, Val Loss: 0.7196, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:07 - src.training.trainer - INFO - Epoch 47/59 (2.6s) - Train Loss: 0.7193, Train Dice: 0.2172, Val Loss: 0.7192, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:10 - src.training.trainer - INFO - Epoch 48/59 (2.6s) - Train Loss: 0.7193, Train Dice: 0.2160, Val Loss: 0.7189, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:13 - src.training.trainer - INFO - Epoch 49/59 (3.0s) - Train Loss: 0.7188, Train Dice: 0.2232, Val Loss: 0.7186, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:15 - src.training.trainer - INFO - Epoch 50/59 (2.6s) - Train Loss: 0.7183, Train Dice: 0.2264, Val Loss: 0.7184, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:16 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_50.pth
2025-07-22 20:27:19 - src.training.trainer - INFO - Epoch 51/59 (2.7s) - Train Loss: 0.7182, Train Dice: 0.2230, Val Loss: 0.7182, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:22 - src.training.trainer - INFO - Epoch 52/59 (2.6s) - Train Loss: 0.7185, Train Dice: 0.2247, Val Loss: 0.7180, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:24 - src.training.trainer - INFO - Epoch 53/59 (2.6s) - Train Loss: 0.7179, Train Dice: 0.2235, Val Loss: 0.7179, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:27 - src.training.trainer - INFO - Epoch 54/59 (2.6s) - Train Loss: 0.7187, Train Dice: 0.2215, Val Loss: 0.7179, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:29 - src.training.trainer - INFO - Epoch 55/59 (2.5s) - Train Loss: 0.7184, Train Dice: 0.2216, Val Loss: 0.7177, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:31 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/checkpoint_epoch_55.pth
2025-07-22 20:27:33 - src.training.trainer - INFO - Epoch 56/59 (2.6s) - Train Loss: 0.7176, Train Dice: 0.2233, Val Loss: 0.7177, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:36 - src.training.trainer - INFO - Epoch 57/59 (2.6s) - Train Loss: 0.7181, Train Dice: 0.2217, Val Loss: 0.7177, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:38 - src.training.trainer - INFO - Epoch 58/59 (2.6s) - Train Loss: 0.7183, Train Dice: 0.2168, Val Loss: 0.7176, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:41 - src.training.trainer - INFO - Epoch 59/59 (2.6s) - Train Loss: 0.7178, Train Dice: 0.2155, Val Loss: 0.7175, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:42 - src.training.trainer - INFO - Saved checkpoint to experiments/optimizer_sgd/final_model.pth
2025-07-22 20:27:46 - src.visualization.visualize - INFO - Saved training history to experiments/optimizer_sgd/training_history.png
2025-07-22 20:27:46 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:27:48 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:27:48 - src.evaluation.metrics - INFO -   Dice: 0.00%
2025-07-22 20:27:48 - src.evaluation.metrics - INFO -   IoU: 0.00%
2025-07-22 20:27:48 - src.evaluation.metrics - INFO -   Pixel Accuracy: 95.95%
2025-07-22 20:27:49 - src.visualization.visualize - INFO - Saved visualization to experiments/optimizer_sgd/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:27:49 - src.visualization.visualize - INFO - Saved visualization to experiments/optimizer_sgd/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:27:50 - src.visualization.visualize - INFO - Saved visualization to experiments/optimizer_sgd/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:27:50 - src.visualization.visualize - INFO - Saved visualization to experiments/optimizer_sgd/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:27:50 - src.visualization.visualize - INFO - Saved visualization to experiments/optimizer_sgd/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:27:50 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:27:50 - src.training.experiment - INFO - Test Dice: 0.00%
2025-07-22 20:27:50 - src.training.experiment - INFO - Test IoU: 0.00%
2025-07-22 20:27:50 - src.training.experiment - INFO - Test Pixel Accuracy: 95.95%
2025-07-22 20:27:50 - root - INFO - 
============================================================
2025-07-22 20:27:50 - root - INFO - Running experiment: multichannel
2025-07-22 20:27:50 - root - INFO - ============================================================

2025-07-22 20:27:50 - src.training.experiment - INFO - Starting experiment: multichannel
2025-07-22 20:27:50 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:27:50 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:27:51 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:27:51 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:27:51 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:27:51 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:27:51 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:27:51 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:27:54 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:27:54 - src.training.trainer - INFO - Model has 17,262,401 parameters
2025-07-22 20:27:54 - src.training.experiment - ERROR - Experiment failed: Given groups=1, weight of size [64, 2, 3, 3], expected input[16, 256, 2, 256] to have 2 channels, but got 256 channels instead
Traceback (most recent call last):
  File "/home/coder/knee-segment/src/training/experiment.py", line 245, in run_experiment
    trained_model, history = train_model(
  File "/home/coder/knee-segment/src/training/trainer.py", line 530, in train_model
    history = trainer.train(
  File "/home/coder/knee-segment/src/training/trainer.py", line 343, in train
    train_metrics = self.train_epoch(train_loader, epoch)
  File "/home/coder/knee-segment/src/training/trainer.py", line 205, in train_epoch
    outputs = self.model(images)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1844, in _call_impl
    return inner()
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1790, in inner
    result = forward_call(*args, **kwargs)
  File "/home/coder/knee-segment/src/models/unet.py", line 221, in forward
    x1 = self.inc(x)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/coder/knee-segment/src/models/unet.py", line 56, in forward
    return self.double_conv(x)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/container.py", line 250, in forward
    input = module(input)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 554, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/root/anaconda3/envs/bach/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 549, in _conv_forward
    return F.conv2d(
RuntimeError: Given groups=1, weight of size [64, 2, 3, 3], expected input[16, 256, 2, 256] to have 2 channels, but got 256 channels instead
2025-07-22 20:27:54 - root - ERROR - Experiment multichannel failed: Given groups=1, weight of size [64, 2, 3, 3], expected input[16, 256, 2, 256] to have 2 channels, but got 256 channels instead
2025-07-22 20:27:54 - root - INFO - 
============================================================
2025-07-22 20:27:54 - root - INFO - Running experiment: combined_clahe_crop_aug
2025-07-22 20:27:54 - root - INFO - ============================================================

2025-07-22 20:27:54 - src.training.experiment - INFO - Starting experiment: combined_clahe_crop_aug
2025-07-22 20:27:54 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:27:54 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:27:54 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:27:54 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:27:54 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:27:54 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:27:54 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:27:54 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:27:56 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:27:56 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:27:57 - src.training.trainer - INFO - Epoch 0/59 (1.0s) - Train Loss: 0.7664, Train Dice: 0.2144, Val Loss: 0.7726, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:27:59 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_0.pth
2025-07-22 20:28:00 - src.training.trainer - INFO - Epoch 1/59 (1.1s) - Train Loss: 0.7147, Train Dice: 0.3272, Val Loss: 0.7760, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:28:01 - src.training.trainer - INFO - Epoch 2/59 (1.0s) - Train Loss: 0.6815, Train Dice: 0.3416, Val Loss: 0.7905, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:28:02 - src.training.trainer - INFO - Epoch 3/59 (1.0s) - Train Loss: 0.6505, Train Dice: 0.3436, Val Loss: 0.8952, Val Dice: 0.1211, Val IoU: 0.0680
2025-07-22 20:28:04 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:04 - src.training.trainer - INFO - New best model! Dice: 0.1211
2025-07-22 20:28:05 - src.training.trainer - INFO - Epoch 4/59 (1.1s) - Train Loss: 0.6258, Train Dice: 0.3659, Val Loss: 0.8859, Val Dice: 0.1140, Val IoU: 0.0641
2025-07-22 20:28:06 - src.training.trainer - INFO - Epoch 5/59 (1.0s) - Train Loss: 0.5917, Train Dice: 0.4635, Val Loss: 0.9824, Val Dice: 0.1264, Val IoU: 0.0705
2025-07-22 20:28:08 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:08 - src.training.trainer - INFO - New best model! Dice: 0.1264
2025-07-22 20:28:10 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_5.pth
2025-07-22 20:28:11 - src.training.trainer - INFO - Epoch 6/59 (1.1s) - Train Loss: 0.5658, Train Dice: 0.4347, Val Loss: 1.0881, Val Dice: 0.1166, Val IoU: 0.0648
2025-07-22 20:28:12 - src.training.trainer - INFO - Epoch 7/59 (1.0s) - Train Loss: 0.5547, Train Dice: 0.4251, Val Loss: 1.5540, Val Dice: 0.1611, Val IoU: 0.0912
2025-07-22 20:28:14 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:14 - src.training.trainer - INFO - New best model! Dice: 0.1611
2025-07-22 20:28:15 - src.training.trainer - INFO - Epoch 8/59 (1.0s) - Train Loss: 0.5432, Train Dice: 0.4773, Val Loss: 1.5099, Val Dice: 0.1712, Val IoU: 0.0979
2025-07-22 20:28:16 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:16 - src.training.trainer - INFO - New best model! Dice: 0.1712
2025-07-22 20:28:17 - src.training.trainer - INFO - Epoch 9/59 (1.0s) - Train Loss: 0.5469, Train Dice: 0.4267, Val Loss: 4.1797, Val Dice: 0.1709, Val IoU: 0.0980
2025-07-22 20:28:18 - src.training.trainer - INFO - Epoch 10/59 (1.0s) - Train Loss: 0.5134, Train Dice: 0.4672, Val Loss: 3.7497, Val Dice: 0.1667, Val IoU: 0.0950
2025-07-22 20:28:20 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_10.pth
2025-07-22 20:28:21 - src.training.trainer - INFO - Epoch 11/59 (1.1s) - Train Loss: 0.4953, Train Dice: 0.5173, Val Loss: 1.8109, Val Dice: 0.1772, Val IoU: 0.1022
2025-07-22 20:28:23 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:23 - src.training.trainer - INFO - New best model! Dice: 0.1772
2025-07-22 20:28:24 - src.training.trainer - INFO - Epoch 12/59 (1.0s) - Train Loss: 0.4795, Train Dice: 0.5352, Val Loss: 1.6697, Val Dice: 0.1862, Val IoU: 0.1092
2025-07-22 20:28:26 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:26 - src.training.trainer - INFO - New best model! Dice: 0.1862
2025-07-22 20:28:27 - src.training.trainer - INFO - Epoch 13/59 (1.0s) - Train Loss: 0.4800, Train Dice: 0.4928, Val Loss: 1.8618, Val Dice: 0.1799, Val IoU: 0.1050
2025-07-22 20:28:28 - src.training.trainer - INFO - Epoch 14/59 (1.0s) - Train Loss: 0.4661, Train Dice: 0.5419, Val Loss: 1.9783, Val Dice: 0.1635, Val IoU: 0.0948
2025-07-22 20:28:29 - src.training.trainer - INFO - Epoch 15/59 (1.0s) - Train Loss: 0.4789, Train Dice: 0.4538, Val Loss: 1.4288, Val Dice: 0.2241, Val IoU: 0.1355
2025-07-22 20:28:31 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:31 - src.training.trainer - INFO - New best model! Dice: 0.2241
2025-07-22 20:28:33 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_15.pth
2025-07-22 20:28:34 - src.training.trainer - INFO - Epoch 16/59 (1.1s) - Train Loss: 0.4738, Train Dice: 0.5433, Val Loss: 1.1470, Val Dice: 0.3030, Val IoU: 0.1989
2025-07-22 20:28:36 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:36 - src.training.trainer - INFO - New best model! Dice: 0.3030
2025-07-22 20:28:37 - src.training.trainer - INFO - Epoch 17/59 (1.0s) - Train Loss: 0.4531, Train Dice: 0.5461, Val Loss: 1.1355, Val Dice: 0.3024, Val IoU: 0.1974
2025-07-22 20:28:38 - src.training.trainer - INFO - Epoch 18/59 (1.0s) - Train Loss: 0.4702, Train Dice: 0.4758, Val Loss: 1.3834, Val Dice: 0.2969, Val IoU: 0.1992
2025-07-22 20:28:39 - src.training.trainer - INFO - Epoch 19/59 (1.0s) - Train Loss: 0.4476, Train Dice: 0.5093, Val Loss: 0.8325, Val Dice: 0.2887, Val IoU: 0.1969
2025-07-22 20:28:40 - src.training.trainer - INFO - Epoch 20/59 (1.0s) - Train Loss: 0.4509, Train Dice: 0.4662, Val Loss: 1.1211, Val Dice: 0.2741, Val IoU: 0.1836
2025-07-22 20:28:42 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_20.pth
2025-07-22 20:28:43 - src.training.trainer - INFO - Epoch 21/59 (1.1s) - Train Loss: 0.4309, Train Dice: 0.5383, Val Loss: 0.9920, Val Dice: 0.2844, Val IoU: 0.1864
2025-07-22 20:28:44 - src.training.trainer - INFO - Epoch 22/59 (1.0s) - Train Loss: 0.4335, Train Dice: 0.5318, Val Loss: 0.9430, Val Dice: 0.3214, Val IoU: 0.2062
2025-07-22 20:28:46 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:46 - src.training.trainer - INFO - New best model! Dice: 0.3214
2025-07-22 20:28:47 - src.training.trainer - INFO - Epoch 23/59 (1.0s) - Train Loss: 0.4278, Train Dice: 0.5276, Val Loss: 0.8973, Val Dice: 0.3140, Val IoU: 0.2051
2025-07-22 20:28:48 - src.training.trainer - INFO - Epoch 24/59 (1.0s) - Train Loss: 0.4134, Train Dice: 0.5597, Val Loss: 0.7199, Val Dice: 0.3595, Val IoU: 0.2454
2025-07-22 20:28:50 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:50 - src.training.trainer - INFO - New best model! Dice: 0.3595
2025-07-22 20:28:51 - src.training.trainer - INFO - Epoch 25/59 (1.0s) - Train Loss: 0.4103, Train Dice: 0.5693, Val Loss: 0.6130, Val Dice: 0.4413, Val IoU: 0.3217
2025-07-22 20:28:53 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/best_model.pth
2025-07-22 20:28:53 - src.training.trainer - INFO - New best model! Dice: 0.4413
2025-07-22 20:28:54 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_25.pth
2025-07-22 20:28:56 - src.training.trainer - INFO - Epoch 26/59 (1.1s) - Train Loss: 0.3977, Train Dice: 0.6200, Val Loss: 0.6874, Val Dice: 0.4123, Val IoU: 0.2912
2025-07-22 20:28:57 - src.training.trainer - INFO - Epoch 27/59 (1.0s) - Train Loss: 0.3934, Train Dice: 0.5792, Val Loss: 0.7746, Val Dice: 0.3610, Val IoU: 0.2404
2025-07-22 20:28:58 - src.training.trainer - INFO - Epoch 28/59 (1.0s) - Train Loss: 0.4081, Train Dice: 0.5912, Val Loss: 0.6195, Val Dice: 0.3573, Val IoU: 0.2590
2025-07-22 20:28:59 - src.training.trainer - INFO - Epoch 29/59 (1.0s) - Train Loss: 0.3990, Train Dice: 0.5540, Val Loss: 0.5027, Val Dice: 0.3006, Val IoU: 0.2186
2025-07-22 20:29:00 - src.training.trainer - INFO - Epoch 30/59 (1.0s) - Train Loss: 0.3946, Train Dice: 0.5438, Val Loss: 0.5467, Val Dice: 0.1021, Val IoU: 0.0787
2025-07-22 20:29:01 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_30.pth
2025-07-22 20:29:02 - src.training.trainer - INFO - Epoch 31/59 (1.0s) - Train Loss: 0.3764, Train Dice: 0.6435, Val Loss: 0.4795, Val Dice: 0.3797, Val IoU: 0.2751
2025-07-22 20:29:03 - src.training.trainer - INFO - Epoch 32/59 (1.0s) - Train Loss: 0.3614, Train Dice: 0.6684, Val Loss: 0.5450, Val Dice: 0.3742, Val IoU: 0.2693
2025-07-22 20:29:22 - src.training.trainer - INFO - Epoch 33/59 (19.0s) - Train Loss: 0.3597, Train Dice: 0.6593, Val Loss: 0.5522, Val Dice: 0.3477, Val IoU: 0.2459
2025-07-22 20:29:23 - src.training.trainer - INFO - Epoch 34/59 (1.0s) - Train Loss: 0.3552, Train Dice: 0.6790, Val Loss: 0.5222, Val Dice: 0.3775, Val IoU: 0.2783
2025-07-22 20:29:24 - src.training.trainer - INFO - Epoch 35/59 (1.0s) - Train Loss: 0.3522, Train Dice: 0.6441, Val Loss: 0.5016, Val Dice: 0.3519, Val IoU: 0.2646
2025-07-22 20:29:26 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_35.pth
2025-07-22 20:29:27 - src.training.trainer - INFO - Epoch 36/59 (1.1s) - Train Loss: 0.3403, Train Dice: 0.6623, Val Loss: 0.4911, Val Dice: 0.3334, Val IoU: 0.2533
2025-07-22 20:29:28 - src.training.trainer - INFO - Epoch 37/59 (1.1s) - Train Loss: 0.3485, Train Dice: 0.6440, Val Loss: 0.4921, Val Dice: 0.3420, Val IoU: 0.2646
2025-07-22 20:29:29 - src.training.trainer - INFO - Epoch 38/59 (1.0s) - Train Loss: 0.3458, Train Dice: 0.6287, Val Loss: 0.5098, Val Dice: 0.3475, Val IoU: 0.2680
2025-07-22 20:29:30 - src.training.trainer - INFO - Epoch 39/59 (1.0s) - Train Loss: 0.3318, Train Dice: 0.7034, Val Loss: 0.5249, Val Dice: 0.3665, Val IoU: 0.2732
2025-07-22 20:29:32 - src.training.trainer - INFO - Epoch 40/59 (1.0s) - Train Loss: 0.3410, Train Dice: 0.6483, Val Loss: 0.5227, Val Dice: 0.3694, Val IoU: 0.2733
2025-07-22 20:29:33 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_40.pth
2025-07-22 20:29:34 - src.training.trainer - INFO - Epoch 41/59 (1.1s) - Train Loss: 0.3363, Train Dice: 0.6349, Val Loss: 0.5135, Val Dice: 0.3680, Val IoU: 0.2764
2025-07-22 20:29:35 - src.training.trainer - INFO - Epoch 42/59 (1.0s) - Train Loss: 0.3233, Train Dice: 0.6753, Val Loss: 0.5100, Val Dice: 0.3821, Val IoU: 0.2875
2025-07-22 20:29:36 - src.training.trainer - INFO - Epoch 43/59 (1.0s) - Train Loss: 0.3287, Train Dice: 0.6972, Val Loss: 0.5090, Val Dice: 0.3880, Val IoU: 0.2932
2025-07-22 20:29:37 - src.training.trainer - INFO - Epoch 44/59 (1.0s) - Train Loss: 0.3250, Train Dice: 0.6726, Val Loss: 0.5038, Val Dice: 0.3884, Val IoU: 0.2943
2025-07-22 20:29:39 - src.training.trainer - INFO - Epoch 45/59 (1.0s) - Train Loss: 0.3488, Train Dice: 0.6359, Val Loss: 0.4971, Val Dice: 0.3822, Val IoU: 0.2908
2025-07-22 20:29:40 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_45.pth
2025-07-22 20:29:41 - src.training.trainer - INFO - Epoch 46/59 (1.1s) - Train Loss: 0.3155, Train Dice: 0.7232, Val Loss: 0.4912, Val Dice: 0.3623, Val IoU: 0.2796
2025-07-22 20:29:42 - src.training.trainer - INFO - Epoch 47/59 (1.0s) - Train Loss: 0.3269, Train Dice: 0.7023, Val Loss: 0.4892, Val Dice: 0.3486, Val IoU: 0.2697
2025-07-22 20:29:43 - src.training.trainer - INFO - Epoch 48/59 (1.0s) - Train Loss: 0.3169, Train Dice: 0.7192, Val Loss: 0.4881, Val Dice: 0.3425, Val IoU: 0.2631
2025-07-22 20:29:45 - src.training.trainer - INFO - Epoch 49/59 (1.4s) - Train Loss: 0.3368, Train Dice: 0.6758, Val Loss: 0.4907, Val Dice: 0.3389, Val IoU: 0.2586
2025-07-22 20:29:46 - src.training.trainer - INFO - Epoch 50/59 (1.0s) - Train Loss: 0.3185, Train Dice: 0.7298, Val Loss: 0.4939, Val Dice: 0.3442, Val IoU: 0.2624
2025-07-22 20:29:48 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_50.pth
2025-07-22 20:29:49 - src.training.trainer - INFO - Epoch 51/59 (1.1s) - Train Loss: 0.3293, Train Dice: 0.6631, Val Loss: 0.4971, Val Dice: 0.3515, Val IoU: 0.2677
2025-07-22 20:29:50 - src.training.trainer - INFO - Epoch 52/59 (1.0s) - Train Loss: 0.3214, Train Dice: 0.7015, Val Loss: 0.5013, Val Dice: 0.3522, Val IoU: 0.2675
2025-07-22 20:29:51 - src.training.trainer - INFO - Epoch 53/59 (1.0s) - Train Loss: 0.3249, Train Dice: 0.6640, Val Loss: 0.5055, Val Dice: 0.3517, Val IoU: 0.2660
2025-07-22 20:29:52 - src.training.trainer - INFO - Epoch 54/59 (1.0s) - Train Loss: 0.3155, Train Dice: 0.7131, Val Loss: 0.5090, Val Dice: 0.3483, Val IoU: 0.2627
2025-07-22 20:29:53 - src.training.trainer - INFO - Epoch 55/59 (1.0s) - Train Loss: 0.3239, Train Dice: 0.6903, Val Loss: 0.5106, Val Dice: 0.3455, Val IoU: 0.2591
2025-07-22 20:29:55 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/checkpoint_epoch_55.pth
2025-07-22 20:29:56 - src.training.trainer - INFO - Epoch 56/59 (1.1s) - Train Loss: 0.3138, Train Dice: 0.7199, Val Loss: 0.5113, Val Dice: 0.3423, Val IoU: 0.2559
2025-07-22 20:29:57 - src.training.trainer - INFO - Epoch 57/59 (1.0s) - Train Loss: 0.3258, Train Dice: 0.6725, Val Loss: 0.5109, Val Dice: 0.3362, Val IoU: 0.2511
2025-07-22 20:29:58 - src.training.trainer - INFO - Epoch 58/59 (1.0s) - Train Loss: 0.3193, Train Dice: 0.7058, Val Loss: 0.5112, Val Dice: 0.3335, Val IoU: 0.2485
2025-07-22 20:29:59 - src.training.trainer - INFO - Epoch 59/59 (1.0s) - Train Loss: 0.3268, Train Dice: 0.6742, Val Loss: 0.5115, Val Dice: 0.3353, Val IoU: 0.2493
2025-07-22 20:30:01 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_clahe_crop_aug/final_model.pth
2025-07-22 20:30:04 - src.visualization.visualize - INFO - Saved training history to experiments/combined_clahe_crop_aug/training_history.png
2025-07-22 20:30:04 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:30:04 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:30:04 - src.evaluation.metrics - INFO -   Dice: 43.35%
2025-07-22 20:30:04 - src.evaluation.metrics - INFO -   IoU: 33.73%
2025-07-22 20:30:04 - src.evaluation.metrics - INFO -   Pixel Accuracy: 88.32%
2025-07-22 20:30:04 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_clahe_crop_aug/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:30:05 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_clahe_crop_aug/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:30:05 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_clahe_crop_aug/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:30:05 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_clahe_crop_aug/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:30:06 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_clahe_crop_aug/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:30:06 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:30:06 - src.training.experiment - INFO - Test Dice: 43.35%
2025-07-22 20:30:06 - src.training.experiment - INFO - Test IoU: 33.73%
2025-07-22 20:30:06 - src.training.experiment - INFO - Test Pixel Accuracy: 88.32%
2025-07-22 20:30:06 - root - INFO - 
============================================================
2025-07-22 20:30:06 - root - INFO - Running experiment: combined_snake_aug
2025-07-22 20:30:06 - root - INFO - ============================================================

2025-07-22 20:30:06 - src.training.experiment - INFO - Starting experiment: combined_snake_aug
2025-07-22 20:30:06 - src.training.experiment - INFO - Device: cuda
2025-07-22 20:30:06 - src.training.experiment - INFO - Snake ROI detected - reducing DataLoader workers to avoid tensor sharing issues
2025-07-22 20:30:06 - src.data.dataset - INFO - Found 49 valid image-mask pairs
2025-07-22 20:30:06 - src.data.dataloader - INFO - Dataset composition: 49 positive, 0 negative masks
2025-07-22 20:30:06 - src.data.dataloader - WARNING - Insufficient samples for stratification. Switching to random split.
2025-07-22 20:30:06 - src.data.dataloader - INFO - Split sizes - Train: 29, Val: 10, Test: 10
2025-07-22 20:30:06 - src.data.dataset - INFO - Found 29 valid image-mask pairs
2025-07-22 20:30:06 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:30:06 - src.data.dataset - INFO - Found 10 valid image-mask pairs
2025-07-22 20:30:09 - src.training.trainer - INFO - Starting training for 60 epochs
2025-07-22 20:30:09 - src.training.trainer - INFO - Model has 17,261,825 parameters
2025-07-22 20:30:23 - src.training.trainer - INFO - Epoch 0/59 (14.3s) - Train Loss: 0.7453, Train Dice: 0.0658, Val Loss: 0.7800, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:30:25 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_0.pth
2025-07-22 20:30:37 - src.training.trainer - INFO - Epoch 1/59 (12.0s) - Train Loss: 0.6936, Train Dice: 0.1987, Val Loss: 0.7838, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:30:49 - src.training.trainer - INFO - Epoch 2/59 (12.0s) - Train Loss: 0.6479, Train Dice: 0.2470, Val Loss: 0.7906, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:31:05 - src.training.trainer - INFO - Epoch 3/59 (16.6s) - Train Loss: 0.6369, Train Dice: 0.1142, Val Loss: 0.7664, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:31:18 - src.training.trainer - INFO - Epoch 4/59 (13.0s) - Train Loss: 0.6166, Train Dice: 0.0266, Val Loss: 0.8101, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:31:31 - src.training.trainer - INFO - Epoch 5/59 (12.3s) - Train Loss: 0.6059, Train Dice: 0.0403, Val Loss: 0.8003, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:31:33 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_5.pth
2025-07-22 20:31:50 - src.training.trainer - INFO - Epoch 6/59 (17.1s) - Train Loss: 0.5973, Train Dice: 0.1608, Val Loss: 10.3368, Val Dice: 0.0811, Val IoU: 0.0432
2025-07-22 20:31:51 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:31:51 - src.training.trainer - INFO - New best model! Dice: 0.0811
2025-07-22 20:32:06 - src.training.trainer - INFO - Epoch 7/59 (14.9s) - Train Loss: 0.5886, Train Dice: 0.2235, Val Loss: 28.0499, Val Dice: 0.0807, Val IoU: 0.0430
2025-07-22 20:32:18 - src.training.trainer - INFO - Epoch 8/59 (11.3s) - Train Loss: 0.5748, Train Dice: 0.3095, Val Loss: 70.9252, Val Dice: 0.0801, Val IoU: 0.0427
2025-07-22 20:32:31 - src.training.trainer - INFO - Epoch 9/59 (12.9s) - Train Loss: 0.5608, Train Dice: 0.3242, Val Loss: 40.1924, Val Dice: 0.0804, Val IoU: 0.0428
2025-07-22 20:32:43 - src.training.trainer - INFO - Epoch 10/59 (12.4s) - Train Loss: 0.5439, Train Dice: 0.3841, Val Loss: 92.7723, Val Dice: 0.0801, Val IoU: 0.0427
2025-07-22 20:32:45 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_10.pth
2025-07-22 20:32:56 - src.training.trainer - INFO - Epoch 11/59 (11.0s) - Train Loss: 0.5326, Train Dice: 0.4308, Val Loss: 108.8507, Val Dice: 0.0801, Val IoU: 0.0427
2025-07-22 20:33:07 - src.training.trainer - INFO - Epoch 12/59 (11.4s) - Train Loss: 0.5251, Train Dice: 0.3985, Val Loss: 13.3581, Val Dice: 0.0818, Val IoU: 0.0437
2025-07-22 20:33:09 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:33:09 - src.training.trainer - INFO - New best model! Dice: 0.0818
2025-07-22 20:33:23 - src.training.trainer - INFO - Epoch 13/59 (14.3s) - Train Loss: 0.5245, Train Dice: 0.3871, Val Loss: 0.8796, Val Dice: 0.0000, Val IoU: 0.0000
2025-07-22 20:33:35 - src.training.trainer - INFO - Epoch 14/59 (11.4s) - Train Loss: 0.5234, Train Dice: 0.3906, Val Loss: 6.8389, Val Dice: 0.0936, Val IoU: 0.0502
2025-07-22 20:33:37 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:33:37 - src.training.trainer - INFO - New best model! Dice: 0.0936
2025-07-22 20:33:52 - src.training.trainer - INFO - Epoch 15/59 (15.0s) - Train Loss: 0.5035, Train Dice: 0.3938, Val Loss: 8.4103, Val Dice: 0.0866, Val IoU: 0.0463
2025-07-22 20:33:53 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_15.pth
2025-07-22 20:34:08 - src.training.trainer - INFO - Epoch 16/59 (14.7s) - Train Loss: 0.4855, Train Dice: 0.4422, Val Loss: 8.6892, Val Dice: 0.0907, Val IoU: 0.0486
2025-07-22 20:34:22 - src.training.trainer - INFO - Epoch 17/59 (13.4s) - Train Loss: 0.4829, Train Dice: 0.4393, Val Loss: 3.8099, Val Dice: 0.0958, Val IoU: 0.0515
2025-07-22 20:34:24 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:34:24 - src.training.trainer - INFO - New best model! Dice: 0.0958
2025-07-22 20:34:35 - src.training.trainer - INFO - Epoch 18/59 (11.0s) - Train Loss: 0.4946, Train Dice: 0.4074, Val Loss: 5.3217, Val Dice: 0.0952, Val IoU: 0.0513
2025-07-22 20:34:48 - src.training.trainer - INFO - Epoch 19/59 (13.4s) - Train Loss: 0.4696, Train Dice: 0.4557, Val Loss: 2.8583, Val Dice: 0.1128, Val IoU: 0.0617
2025-07-22 20:34:50 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:34:50 - src.training.trainer - INFO - New best model! Dice: 0.1128
2025-07-22 20:35:02 - src.training.trainer - INFO - Epoch 20/59 (12.1s) - Train Loss: 0.4609, Train Dice: 0.4611, Val Loss: 4.2356, Val Dice: 0.1120, Val IoU: 0.0611
2025-07-22 20:35:04 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_20.pth
2025-07-22 20:35:15 - src.training.trainer - INFO - Epoch 21/59 (10.9s) - Train Loss: 0.4646, Train Dice: 0.4891, Val Loss: 2.7569, Val Dice: 0.1282, Val IoU: 0.0715
2025-07-22 20:35:16 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:35:16 - src.training.trainer - INFO - New best model! Dice: 0.1282
2025-07-22 20:35:30 - src.training.trainer - INFO - Epoch 22/59 (13.9s) - Train Loss: 0.4465, Train Dice: 0.4933, Val Loss: 1.6862, Val Dice: 0.1550, Val IoU: 0.0896
2025-07-22 20:35:32 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:35:32 - src.training.trainer - INFO - New best model! Dice: 0.1550
2025-07-22 20:35:46 - src.training.trainer - INFO - Epoch 23/59 (13.4s) - Train Loss: 0.4496, Train Dice: 0.4786, Val Loss: 1.1528, Val Dice: 0.1618, Val IoU: 0.0924
2025-07-22 20:35:48 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:35:48 - src.training.trainer - INFO - New best model! Dice: 0.1618
2025-07-22 20:36:01 - src.training.trainer - INFO - Epoch 24/59 (13.5s) - Train Loss: 0.4307, Train Dice: 0.5199, Val Loss: 1.1716, Val Dice: 0.2107, Val IoU: 0.1288
2025-07-22 20:36:03 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:36:03 - src.training.trainer - INFO - New best model! Dice: 0.2107
2025-07-22 20:36:17 - src.training.trainer - INFO - Epoch 25/59 (14.5s) - Train Loss: 0.4327, Train Dice: 0.5081, Val Loss: 1.3397, Val Dice: 0.2251, Val IoU: 0.1379
2025-07-22 20:36:19 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:36:19 - src.training.trainer - INFO - New best model! Dice: 0.2251
2025-07-22 20:36:21 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_25.pth
2025-07-22 20:36:32 - src.training.trainer - INFO - Epoch 26/59 (11.2s) - Train Loss: 0.4299, Train Dice: 0.5152, Val Loss: 0.7397, Val Dice: 0.3083, Val IoU: 0.2051
2025-07-22 20:36:34 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:36:34 - src.training.trainer - INFO - New best model! Dice: 0.3083
2025-07-22 20:36:48 - src.training.trainer - INFO - Epoch 27/59 (13.5s) - Train Loss: 0.4278, Train Dice: 0.5094, Val Loss: 0.7812, Val Dice: 0.2839, Val IoU: 0.1885
2025-07-22 20:37:00 - src.training.trainer - INFO - Epoch 28/59 (12.4s) - Train Loss: 0.4287, Train Dice: 0.4663, Val Loss: 0.4882, Val Dice: 0.4374, Val IoU: 0.3032
2025-07-22 20:37:02 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:37:02 - src.training.trainer - INFO - New best model! Dice: 0.4374
2025-07-22 20:37:16 - src.training.trainer - INFO - Epoch 29/59 (14.2s) - Train Loss: 0.4055, Train Dice: 0.5434, Val Loss: 0.4961, Val Dice: 0.3076, Val IoU: 0.2542
2025-07-22 20:37:28 - src.training.trainer - INFO - Epoch 30/59 (12.1s) - Train Loss: 0.4207, Train Dice: 0.4882, Val Loss: 0.4682, Val Dice: 0.3239, Val IoU: 0.2754
2025-07-22 20:37:30 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_30.pth
2025-07-22 20:37:42 - src.training.trainer - INFO - Epoch 31/59 (11.8s) - Train Loss: 0.4167, Train Dice: 0.4869, Val Loss: 0.4027, Val Dice: 0.5438, Val IoU: 0.3901
2025-07-22 20:37:44 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:37:44 - src.training.trainer - INFO - New best model! Dice: 0.5438
2025-07-22 20:37:55 - src.training.trainer - INFO - Epoch 32/59 (11.3s) - Train Loss: 0.3987, Train Dice: 0.5198, Val Loss: 0.4876, Val Dice: 0.4193, Val IoU: 0.2893
2025-07-22 20:38:17 - src.training.trainer - INFO - Epoch 33/59 (21.8s) - Train Loss: 0.3906, Train Dice: 0.5474, Val Loss: 0.5224, Val Dice: 0.3788, Val IoU: 0.2495
2025-07-22 20:38:31 - src.training.trainer - INFO - Epoch 34/59 (13.9s) - Train Loss: 0.3824, Train Dice: 0.5686, Val Loss: 0.4085, Val Dice: 0.5529, Val IoU: 0.4125
2025-07-22 20:38:33 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:38:33 - src.training.trainer - INFO - New best model! Dice: 0.5529
2025-07-22 20:38:44 - src.training.trainer - INFO - Epoch 35/59 (11.2s) - Train Loss: 0.3827, Train Dice: 0.5474, Val Loss: 0.4163, Val Dice: 0.5087, Val IoU: 0.3705
2025-07-22 20:38:46 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_35.pth
2025-07-22 20:39:01 - src.training.trainer - INFO - Epoch 36/59 (14.9s) - Train Loss: 0.3760, Train Dice: 0.5483, Val Loss: 0.4375, Val Dice: 0.4949, Val IoU: 0.3534
2025-07-22 20:39:17 - src.training.trainer - INFO - Epoch 37/59 (16.5s) - Train Loss: 0.3794, Train Dice: 0.5137, Val Loss: 0.4516, Val Dice: 0.4517, Val IoU: 0.3109
2025-07-22 20:39:28 - src.training.trainer - INFO - Epoch 38/59 (11.3s) - Train Loss: 0.3693, Train Dice: 0.5428, Val Loss: 0.5125, Val Dice: 0.3816, Val IoU: 0.2505
2025-07-22 20:39:40 - src.training.trainer - INFO - Epoch 39/59 (11.3s) - Train Loss: 0.3745, Train Dice: 0.5564, Val Loss: 0.5645, Val Dice: 0.2680, Val IoU: 0.1632
2025-07-22 20:39:53 - src.training.trainer - INFO - Epoch 40/59 (13.6s) - Train Loss: 0.3740, Train Dice: 0.5299, Val Loss: 0.4097, Val Dice: 0.5173, Val IoU: 0.3740
2025-07-22 20:39:55 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_40.pth
2025-07-22 20:40:07 - src.training.trainer - INFO - Epoch 41/59 (11.6s) - Train Loss: 0.3576, Train Dice: 0.5629, Val Loss: 0.3916, Val Dice: 0.5285, Val IoU: 0.3820
2025-07-22 20:40:20 - src.training.trainer - INFO - Epoch 42/59 (12.8s) - Train Loss: 0.3455, Train Dice: 0.5905, Val Loss: 0.3788, Val Dice: 0.5301, Val IoU: 0.3821
2025-07-22 20:40:31 - src.training.trainer - INFO - Epoch 43/59 (11.3s) - Train Loss: 0.3547, Train Dice: 0.5421, Val Loss: 0.3723, Val Dice: 0.5367, Val IoU: 0.3859
2025-07-22 20:40:44 - src.training.trainer - INFO - Epoch 44/59 (13.0s) - Train Loss: 0.3300, Train Dice: 0.6165, Val Loss: 0.3705, Val Dice: 0.5418, Val IoU: 0.3904
2025-07-22 20:40:55 - src.training.trainer - INFO - Epoch 45/59 (11.1s) - Train Loss: 0.3335, Train Dice: 0.6080, Val Loss: 0.3632, Val Dice: 0.5558, Val IoU: 0.4031
2025-07-22 20:40:57 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:40:57 - src.training.trainer - INFO - New best model! Dice: 0.5558
2025-07-22 20:40:59 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_45.pth
2025-07-22 20:41:09 - src.training.trainer - INFO - Epoch 46/59 (10.4s) - Train Loss: 0.3150, Train Dice: 0.6268, Val Loss: 0.3541, Val Dice: 0.5778, Val IoU: 0.4262
2025-07-22 20:41:11 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:41:11 - src.training.trainer - INFO - New best model! Dice: 0.5778
2025-07-22 20:41:22 - src.training.trainer - INFO - Epoch 47/59 (11.2s) - Train Loss: 0.3248, Train Dice: 0.6038, Val Loss: 0.3644, Val Dice: 0.5623, Val IoU: 0.4222
2025-07-22 20:41:36 - src.training.trainer - INFO - Epoch 48/59 (13.9s) - Train Loss: 0.3416, Train Dice: 0.5612, Val Loss: 0.3661, Val Dice: 0.5431, Val IoU: 0.4067
2025-07-22 20:41:48 - src.training.trainer - INFO - Epoch 49/59 (12.5s) - Train Loss: 0.3220, Train Dice: 0.6264, Val Loss: 0.3514, Val Dice: 0.5651, Val IoU: 0.4250
2025-07-22 20:42:01 - src.training.trainer - INFO - Epoch 50/59 (12.9s) - Train Loss: 0.3165, Train Dice: 0.6192, Val Loss: 0.3285, Val Dice: 0.5990, Val IoU: 0.4567
2025-07-22 20:42:03 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/best_model.pth
2025-07-22 20:42:03 - src.training.trainer - INFO - New best model! Dice: 0.5990
2025-07-22 20:42:05 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_50.pth
2025-07-22 20:42:16 - src.training.trainer - INFO - Epoch 51/59 (10.8s) - Train Loss: 0.3382, Train Dice: 0.5671, Val Loss: 0.3423, Val Dice: 0.5649, Val IoU: 0.4250
2025-07-22 20:42:29 - src.training.trainer - INFO - Epoch 52/59 (13.5s) - Train Loss: 0.3187, Train Dice: 0.6170, Val Loss: 0.4513, Val Dice: 0.3695, Val IoU: 0.2475
2025-07-22 20:42:40 - src.training.trainer - INFO - Epoch 53/59 (10.8s) - Train Loss: 0.3310, Train Dice: 0.5817, Val Loss: 0.7346, Val Dice: 0.1403, Val IoU: 0.0794
2025-07-22 20:42:52 - src.training.trainer - INFO - Epoch 54/59 (11.8s) - Train Loss: 0.3381, Train Dice: 0.5634, Val Loss: 0.5726, Val Dice: 0.2265, Val IoU: 0.1365
2025-07-22 20:43:07 - src.training.trainer - INFO - Epoch 55/59 (14.6s) - Train Loss: 0.3163, Train Dice: 0.6087, Val Loss: 0.3792, Val Dice: 0.4796, Val IoU: 0.3339
2025-07-22 20:43:08 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/checkpoint_epoch_55.pth
2025-07-22 20:43:20 - src.training.trainer - INFO - Epoch 56/59 (11.7s) - Train Loss: 0.3271, Train Dice: 0.5770, Val Loss: 0.3498, Val Dice: 0.5361, Val IoU: 0.3866
2025-07-22 20:43:32 - src.training.trainer - INFO - Epoch 57/59 (12.2s) - Train Loss: 0.2881, Train Dice: 0.6608, Val Loss: 0.3437, Val Dice: 0.5509, Val IoU: 0.4009
2025-07-22 20:43:43 - src.training.trainer - INFO - Epoch 58/59 (11.0s) - Train Loss: 0.3279, Train Dice: 0.5683, Val Loss: 0.3363, Val Dice: 0.5830, Val IoU: 0.4283
2025-07-22 20:43:59 - src.training.trainer - INFO - Epoch 59/59 (15.5s) - Train Loss: 0.3095, Train Dice: 0.6177, Val Loss: 0.3358, Val Dice: 0.5880, Val IoU: 0.4351
2025-07-22 20:44:00 - src.training.trainer - INFO - Saved checkpoint to experiments/combined_snake_aug/final_model.pth
2025-07-22 20:44:04 - src.visualization.visualize - INFO - Saved training history to experiments/combined_snake_aug/training_history.png
2025-07-22 20:44:04 - src.training.experiment - INFO - Evaluating on test set...
2025-07-22 20:44:08 - src.evaluation.metrics - INFO - Evaluation Results:
2025-07-22 20:44:08 - src.evaluation.metrics - INFO -   Dice: 59.22%
2025-07-22 20:44:08 - src.evaluation.metrics - INFO -   IoU: 44.87%
2025-07-22 20:44:08 - src.evaluation.metrics - INFO -   Pixel Accuracy: 95.36%
2025-07-22 20:44:09 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_snake_aug/predictions/test_1_72bb5205-f020-11ed-b527-0a580a5f736a_27.png
2025-07-22 20:44:09 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_snake_aug/predictions/test_2_e6803d85-0be0-11ef-91e0-0a580a5f582c_11.png
2025-07-22 20:44:10 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_snake_aug/predictions/test_3_e6803d85-0be0-11ef-91e0-0a580a5f582c_21.png
2025-07-22 20:44:11 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_snake_aug/predictions/test_4_e6803d70-0be0-11ef-91e0-0a580a5f582c_16.png
2025-07-22 20:44:11 - src.visualization.visualize - INFO - Saved visualization to experiments/combined_snake_aug/predictions/test_5_abb59951-0a0c-11ee-a934-0a580a5f7c11_11.png
2025-07-22 20:44:11 - src.training.experiment - INFO - Experiment completed successfully!
2025-07-22 20:44:11 - src.training.experiment - INFO - Test Dice: 59.22%
2025-07-22 20:44:11 - src.training.experiment - INFO - Test IoU: 44.87%
2025-07-22 20:44:11 - src.training.experiment - INFO - Test Pixel Accuracy: 95.36%
